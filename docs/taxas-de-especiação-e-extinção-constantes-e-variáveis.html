<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 29 Taxas de especiação e extinção constantes e variáveis | Manual de Ecologia Evolutiva, Biometria e Biogeografia</title>
<meta name="author" content="Renan Maestri">
<meta name="description" content="29.1 Diversificação constante Primeiro, vamos carregar alguns dados e calcular uma diversificação líquida simples, esperada sobr um modelo pure-birth (Magallon and Sanderson 2001). require(ape) #&gt;...">
<meta name="generator" content="bookdown 0.36 with bs4_book()">
<meta property="og:title" content="Capítulo 29 Taxas de especiação e extinção constantes e variáveis | Manual de Ecologia Evolutiva, Biometria e Biogeografia">
<meta property="og:type" content="book">
<meta property="og:url" content="https://renanmaestri.github.io/eebb/taxas-de-especiação-e-extinção-constantes-e-variáveis.html">
<meta property="og:image" content="https://renanmaestri.github.io/eebb/images/Slogan_oficial_sologo.jpg">
<meta property="og:description" content="29.1 Diversificação constante Primeiro, vamos carregar alguns dados e calcular uma diversificação líquida simples, esperada sobr um modelo pure-birth (Magallon and Sanderson 2001). require(ape) #&gt;...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 29 Taxas de especiação e extinção constantes e variáveis | Manual de Ecologia Evolutiva, Biometria e Biogeografia">
<meta name="twitter:description" content="29.1 Diversificação constante Primeiro, vamos carregar alguns dados e calcular uma diversificação líquida simples, esperada sobr um modelo pure-birth (Magallon and Sanderson 2001). require(ape) #&gt;...">
<meta name="twitter:image" content="https://renanmaestri.github.io/eebb/images/Slogan_oficial_sologo.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Manual de Ecologia Evolutiva, Biometria e Biogeografia</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefácio</a></li>
<li class="book-part">PARTE I - Conceitos básicos</li>
<li><a class="" href="conceitos-b%C3%A1sicos.html"><span class="header-section-number">1</span> Conceitos básicos</a></li>
<li class="book-part">PARTE II - Introdução ao R</li>
<li><a class="" href="cap2.html"><span class="header-section-number">2</span> Uma breve introdução ao R</a></li>
<li class="book-part">PARTE III - Morfometria Geométrica</li>
<li><a class="" href="cap3.html"><span class="header-section-number">3</span> Morfometria Geométrica</a></li>
<li><a class="" href="digitaliza%C3%A7%C3%A3o-de-landmarks.html"><span class="header-section-number">4</span> Digitalização de landmarks</a></li>
<li><a class="" href="an%C3%A1lise-de-procrustes.html"><span class="header-section-number">5</span> Análise de Procrustes</a></li>
<li><a class="" href="visualiza%C3%A7%C3%A3o-da-forma.html"><span class="header-section-number">6</span> Visualização da forma</a></li>
<li><a class="" href="assimetria-e-quantifica%C3%A7%C3%A3o-de-erro.html"><span class="header-section-number">7</span> Assimetria e quantificação de erro</a></li>
<li><a class="" href="semilandmarks.html"><span class="header-section-number">8</span> Semilandmarks</a></li>
<li><a class="" href="tamanho-do-centr%C3%B3ide.html"><span class="header-section-number">9</span> Tamanho do Centróide</a></li>
<li><a class="" href="m%C3%A9todos-de-ordena%C3%A7%C3%A3o.html"><span class="header-section-number">10</span> Métodos de ordenação</a></li>
<li><a class="" href="partial-least-squares.html"><span class="header-section-number">11</span> Partial Least Squares</a></li>
<li><a class="" href="modelos-lineares-para-discrimina%C3%A7%C3%A3o-de-grupos.html"><span class="header-section-number">12</span> Modelos lineares para discriminação de grupos</a></li>
<li><a class="" href="alometria.html"><span class="header-section-number">13</span> Alometria</a></li>
<li><a class="" href="an%C3%A1lise-de-trajet%C3%B3ria.html"><span class="header-section-number">14</span> Análise de Trajetória</a></li>
<li><a class="" href="integra%C3%A7%C3%A3o-morfol%C3%B3gica-e-modularidade.html"><span class="header-section-number">15</span> Integração morfológica e modularidade</a></li>
<li><a class="" href="disparidade-e-varia%C3%A7%C3%A3o-morfol%C3%B3gica.html"><span class="header-section-number">16</span> Disparidade e variação morfológica</a></li>
<li><a class="" href="morfometria-geom%C3%A9trica-e-filogenias.html"><span class="header-section-number">17</span> Morfometria geométrica e filogenias</a></li>
<li class="book-part">PARTE IV - Macroevolução</li>
<li><a class="" href="macroevolu%C3%A7%C3%A3o.html"><span class="header-section-number">18</span> Macroevolução</a></li>
<li><a class="" href="lendo-e-manipulando-%C3%A1rvores-filogen%C3%A9ticas-no-r.html"><span class="header-section-number">19</span> Lendo e manipulando árvores filogenéticas no R</a></li>
<li><a class="" href="sinal-filogen%C3%A9tico.html"><span class="header-section-number">20</span> Sinal filogenético</a></li>
<li><a class="" href="modelos-para-evolu%C3%A7%C3%A3o-de-fen%C3%B3tipos-cont%C3%ADnuos.html"><span class="header-section-number">21</span> Modelos para evolução de fenótipos contínuos</a></li>
<li><a class="" href="modelos-para-evolu%C3%A7%C3%A3o-de-fen%C3%B3tipos-discretos.html"><span class="header-section-number">22</span> Modelos para evolução de fenótipos discretos</a></li>
<li><a class="" href="regress%C3%A3o-filogen%C3%A9tica.html"><span class="header-section-number">23</span> Regressão filogenética</a></li>
<li><a class="" href="correla%C3%A7%C3%A3o-de-fen%C3%B3tipos-discretos.html"><span class="header-section-number">24</span> Correlação de fenótipos discretos</a></li>
<li><a class="" href="evolu%C3%A7%C3%A3o-multi-taxa-e-multi-regime.html"><span class="header-section-number">25</span> Evolução multi-taxa e multi-regime</a></li>
<li><a class="" href="m%C3%A9todos-filogen%C3%A9ticos-multivariados.html"><span class="header-section-number">26</span> Métodos filogenéticos multivariados</a></li>
<li><a class="" href="disparidade-fenot%C3%ADpica-ao-longo-do-tempo.html"><span class="header-section-number">27</span> Disparidade fenotípica ao longo do tempo</a></li>
<li><a class="" href="diversifica%C3%A7%C3%A3o-de-linhagens.html"><span class="header-section-number">28</span> Diversificação de linhagens</a></li>
<li><a class="active" href="taxas-de-especia%C3%A7%C3%A3o-e-extin%C3%A7%C3%A3o-constantes-e-vari%C3%A1veis.html"><span class="header-section-number">29</span> Taxas de especiação e extinção constantes e variáveis</a></li>
<li><a class="" href="diversifica%C3%A7%C3%A3o-dependente-de-estado.html"><span class="header-section-number">30</span> Diversificação dependente de estado</a></li>
<li><a class="" href="diversifica%C3%A7%C3%A3o-baseada-em-terminais-tip-speciation.html"><span class="header-section-number">31</span> Diversificação baseada em terminais (tip-speciation)</a></li>
<li><a class="" href="co-diversifica%C3%A7%C3%A3o.html"><span class="header-section-number">32</span> Co-diversificação</a></li>
<li class="book-part">PARTE IV - Biogeografia e Macroecologia</li>
<li><a class="" href="biogeografia-e-macroecologia.html"><span class="header-section-number">33</span> Biogeografia e Macroecologia</a></li>
<li class="book-part">Conclusão</li>
<li><a class="" href="considera%C3%A7%C3%B5es-finais.html"><span class="header-section-number">34</span> Considerações finais</a></li>
<li><a class="" href="refer%C3%AAncias.html">Referências</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/renanmaestri/eebb">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="taxas-de-especiação-e-extinção-constantes-e-variáveis" class="section level1" number="29">
<h1>
<span class="header-section-number">Capítulo 29</span> Taxas de especiação e extinção constantes e variáveis<a class="anchor" aria-label="anchor" href="#taxas-de-especia%C3%A7%C3%A3o-e-extin%C3%A7%C3%A3o-constantes-e-vari%C3%A1veis"><i class="fas fa-link"></i></a>
</h1>
<div id="diversificação-constante" class="section level2" number="29.1">
<h2>
<span class="header-section-number">29.1</span> Diversificação constante<a class="anchor" aria-label="anchor" href="#diversifica%C3%A7%C3%A3o-constante"><i class="fas fa-link"></i></a>
</h2>
<p>Primeiro, vamos carregar alguns dados e calcular uma diversificação
líquida simples, esperada sobr um modelo <em>pure-birth</em> <span class="citation">(Magallon and Sanderson 2001)</span>.</p>
<div class="sourceCode" id="cb264"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/">ape</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Le chargement a nécessité le package : ape</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/liamrevell/phytools">phytools</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Le chargement a nécessité le package : phytools</span></span>
<span><span class="co">#&gt; Le chargement a nécessité le package : maps</span></span>
<span><span class="co"># Filogenia</span></span>
<span><span class="va">tree</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html">read.tree</a></span><span class="op">(</span><span class="st">"dadospcm/primate-tree.txt"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/phytools/man/plotTree.html">plotTree</a></span><span class="op">(</span><span class="va">tree</span>,fsize<span class="op">=</span><span class="fl">0.4</span>,ftype<span class="op">=</span><span class="st">"i"</span>,type<span class="op">=</span><span class="st">"fan"</span>,lwd<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04.11-pcmdiv_files/figure-html/unnamed-chunk-1-1.png" width="672"></div>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Número de espécies</span></span>
<span><span class="va">n_sp</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">tree</span><span class="op">$</span><span class="va">tip.label</span><span class="op">)</span></span>
<span><span class="co"># Stem age</span></span>
<span><span class="va">stem_age</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/phytools/man/nodeHeights.html">nodeHeights</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Diversificação (Magallon &amp; Sanderson 2001)</span></span>
<span><span class="va">r1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">n_sp</span><span class="op">)</span><span class="op">/</span><span class="va">stem_age</span></span>
<span><span class="co"># Com essa diversificação obtemos o número de espécies visto na árvore</span></span>
<span><span class="va">r1</span><span class="op">*</span><span class="va">stem_age</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">n_sp</span><span class="op">)</span></span></code></pre></div>
<p>Agora, vamos estimar extinção constante com um modelo <em>birth-death</em>. No pacote <em>ape</em>, a função birthdeath estima taxas de extinção e especiação em uma filogenia (método de <span class="citation">Nee, May, and Harvey (1994)</span>). As estimativas são confiáveis se as premissas do modelo forem reais (especiação e extinção constantes no tempo). O método também assume uma filogenia completa. <em>b</em> é a taxa de especiação e <em>d</em> é a taxa de extinção.</p>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#nee&lt;-birthdeath(tree)</span></span></code></pre></div>
<p>A árvore contem algumas politomias. Vamos resolver as politomias e
tentar novamente.</p>
<div class="sourceCode" id="cb267"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/multi2di.html">multi2di</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/is.binary.tree.html">is.binary</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span></span>
<span><span class="va">nee</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/birthdeath.html">birthdeath</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span></span>
<span><span class="va">nee</span></span></code></pre></div>
<p>Por motivos computacionais, a função birthdeath estima os parâmetros
derivados b-d e d/b (a diferença entre especiação e extinção (<em>net
diversification</em>) e a razão entre extinção e especiação (<em>relative
extinction rate</em>), respectivamente). Para encontrar b e d podemos usar a função bd do pacote <em>phytools</em>:</p>
<div class="sourceCode" id="cb268"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/phytools/man/bd.html">bd</a></span><span class="op">(</span><span class="va">nee</span><span class="op">)</span></span></code></pre></div>
<p>As unidades dos valores dependem da unidade do comprimento dos ramos (ln para número de espécies).Só é possível comparar árvores diferentes quando o comprimento dos ramos está na mesma unidade.</p>
<p>Pacote <em>diversitree</em>. O pacote diversitree possui múltiplas funções para realizar vários tipos de análises de diversificação com filogenias. Uma das vantagens do diversitree é que ele permite levar em consideração a incompletude no número de espécies amostradas. Na nossa filogenia dos primatas, existem 226 espécies amostradas de um total de aprox. 300 (o número variava de 190 até 350 da última vez que conferi; vamos considerar 300 para exemplo). Isso é cerca de 75% de espécies presentes. O diversitree também permite ajustar modelos pure-birth (Yule) e birth-death (BD) e compará-los.</p>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://www.zoology.ubc.ca/prog/diversitree/">diversitree</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Le chargement a nécessité le package : diversitree</span></span>
<span><span class="co"># Yule (pure-birth -- somente especiação)</span></span>
<span><span class="va">modelo.pb</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/diversitree/man/make.bd.html">make.yule</a></span><span class="op">(</span><span class="va">tree</span>,sampling.f <span class="op">=</span> <span class="fl">226</span><span class="op">/</span><span class="fl">300</span><span class="op">)</span></span>
<span><span class="va">param.pb</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/diversitree/man/find.mle.html">find.mle</a></span><span class="op">(</span><span class="va">modelo.pb</span>,x.init<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span> <span class="co"># Estimar os valores dos parâmetros por ML # x.init é um valor arbitrário para iniciar o otimização</span></span>
<span><span class="va">param.pb</span></span></code></pre></div>
<p>lambda = taxa de especiação; mu = taxa de extinção.</p>
<div class="sourceCode" id="cb270"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Modelo birth-death (especiação + extinção)</span></span>
<span><span class="va">modelo.bd</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/diversitree/man/make.bd.html">make.bd</a></span><span class="op">(</span><span class="va">tree</span>,sampling.f <span class="op">=</span> <span class="fl">226</span><span class="op">/</span><span class="fl">300</span><span class="op">)</span></span>
<span><span class="va">param.bd</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/diversitree/man/find.mle.html">find.mle</a></span><span class="op">(</span><span class="va">modelo.bd</span>,x.init<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">param.bd</span></span></code></pre></div>
<p>Comparar modelos.</p>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">param.bd</span>,pure.birth<span class="op">=</span><span class="va">param.pb</span><span class="op">)</span></span></code></pre></div>
<p>O modelo que incluí extinção (birth-death) aumentou significativamente o seu ajuste em comparação com o modelo <em>pure-birth</em>. Esse é essencialmente um sinal de que a extinção é importante (o parâmetro adicional <em>d</em> se justifica).</p>
<p>MCMC.O pacote <em>diversitree</em> também permite rodar analises bayesianas
para estimar os parâmetros de diversificação usando a distribuição
posterior probabilidades.</p>
<div class="sourceCode" id="cb272"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bd.amostras</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/diversitree/man/mcmc.html">mcmc</a></span><span class="op">(</span><span class="va">modelo.bd</span>, <span class="va">param.bd</span><span class="op">$</span><span class="va">par</span>, nsteps <span class="op">=</span> <span class="fl">1e+05</span>, lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span> upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">Inf</span>,<span class="cn">Inf</span><span class="op">)</span>, w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>, fail.value <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span> print.every <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span><span class="co"># visualizar distribuição</span></span>
<span><span class="va">postSamples</span><span class="op">&lt;-</span><span class="va">bd.amostras</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"lambda"</span>, <span class="st">"mu"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/diversitree/man/profiles.plot.html">profiles.plot</a></span><span class="op">(</span><span class="va">postSamples</span>,col.line<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>,las<span class="op">=</span><span class="fl">1</span>,legend <span class="op">=</span><span class="st">"topright"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04.11-pcmdiv_files/figure-html/unnamed-chunk-8-1.png" width="672"></div>
</div>
<div id="diversificação-variando-no-tempo-time-dependent" class="section level2" number="29.2">
<h2>
<span class="header-section-number">29.2</span> Diversificação variando no tempo (<em>time-dependent</em>)<a class="anchor" aria-label="anchor" href="#diversifica%C3%A7%C3%A3o-variando-no-tempo-time-dependent"><i class="fas fa-link"></i></a>
</h2>
<p>Carregar dados.</p>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/">ape</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/liamrevell/phytools">phytools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">geiger</span><span class="op">)</span></span>
<span><span class="co">#&gt; Le chargement a nécessité le package : geiger</span></span>
<span><span class="co"># Arvore marsupiais</span></span>
<span><span class="va">tree</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/read.tree.html">read.tree</a></span><span class="op">(</span><span class="st">"dadospcm/marsupial-tree.tre"</span><span class="op">)</span></span>
<span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">tree</span>,cex<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/axisPhylo.html">axisPhylo</a></span><span class="op">(</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
<div class="inline-figure"><img src="04.11-pcmdiv_files/figure-html/unnamed-chunk-9-1.png" width="672"></div>
<p>O <em>RPANDA</em> <span class="citation">(Morlon et al. 2016)</span> é um pacote que permite ajustar modelos com
taxas de especiação e/ou extinção variáveis, e comparar os modelos
usando verossimilhança.</p>
<div class="sourceCode" id="cb274"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hmorlon/PANDA">RPANDA</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Le chargement a nécessité le package : RPANDA</span></span>
<span><span class="co">#&gt; Le chargement a nécessité le package : picante</span></span>
<span><span class="co">#&gt; Le chargement a nécessité le package : vegan</span></span>
<span><span class="co">#&gt; Le chargement a nécessité le package : permute</span></span>
<span><span class="co">#&gt; Le chargement a nécessité le package : lattice</span></span>
<span><span class="co">#&gt; This is vegan 2.6-4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attachement du package : 'vegan'</span></span>
<span><span class="co">#&gt; L'objet suivant est masqué depuis 'package:phytools':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     scores</span></span>
<span><span class="co">#&gt; Le chargement a nécessité le package : nlme</span></span></code></pre></div>
<p>Nós vamos ajustar modelos com combinações de lambda e mu constantes e variáveis. Os modelos podem ser consultados no help do <em>RPANDA</em>.</p>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lambda.cst</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>,<span class="va">y</span><span class="op">)</span><span class="op">{</span><span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">}</span> <span class="co"># lambda constante</span></span>
<span><span class="va">lambda.var</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>,<span class="va">y</span><span class="op">)</span><span class="op">{</span><span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">t</span><span class="op">)</span><span class="op">}</span> <span class="co"># lambda com variação exponencial (em função do tempo t)</span></span>
<span><span class="va">mu.cst</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>,<span class="va">y</span><span class="op">)</span><span class="op">{</span><span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">}</span></span>
<span><span class="va">mu.var</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>,<span class="va">y</span><span class="op">)</span><span class="op">{</span><span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">t</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
<p>Ajustando os modelos para a árvore completa.</p>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># birth-death especiação e extinção constante</span></span>
<span><span class="va">bcdc</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/RPANDA/man/fit_bd.html">fit_bd</a></span><span class="op">(</span><span class="va">tree</span>,tot_time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/branching.times.html">branching.times</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span><span class="op">)</span>,f.lamb<span class="op">=</span><span class="va">lambda.cst</span>,f.mu<span class="op">=</span><span class="va">mu.cst</span>,lamb_par<span class="op">=</span><span class="fl">0.01</span>,mu_par<span class="op">=</span><span class="fl">0.001</span>,cst.lamb<span class="op">=</span><span class="cn">TRUE</span>,cst.mu<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">bcdc</span><span class="op">$</span><span class="va">model</span><span class="op">&lt;-</span><span class="st">"birth-death taxa de especiação e extinção constantes"</span></span>
<span><span class="va">bcdc</span></span>
<span><span class="co"># birth-death especiação exponencial e extinção constante</span></span>
<span><span class="va">bvdc</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/RPANDA/man/fit_bd.html">fit_bd</a></span><span class="op">(</span><span class="va">tree</span>,tot_time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/branching.times.html">branching.times</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span><span class="op">)</span>,f.lamb<span class="op">=</span><span class="va">lambda.var</span>,f.mu<span class="op">=</span><span class="va">mu.cst</span>,lamb_par<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.01</span><span class="op">)</span>,mu_par<span class="op">=</span><span class="fl">0.001</span>,expo.lamb<span class="op">=</span><span class="cn">TRUE</span>,cst.mu<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">bvdc</span><span class="op">$</span><span class="va">model</span><span class="op">&lt;-</span><span class="st">"birth-death taxa de especiação exponencial e extinção constante"</span></span>
<span><span class="co"># birth-death especiação constante e extinção exponencial</span></span>
<span><span class="va">bcdv</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/RPANDA/man/fit_bd.html">fit_bd</a></span><span class="op">(</span><span class="va">tree</span>,tot_time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/branching.times.html">branching.times</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span><span class="op">)</span>,f.lamb<span class="op">=</span><span class="va">lambda.cst</span>,f.mu<span class="op">=</span><span class="va">mu.var</span>,lamb_par<span class="op">=</span><span class="fl">0.01</span>,mu_par<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.005</span>,<span class="fl">0.001</span><span class="op">)</span>,cst.lamb<span class="op">=</span><span class="cn">TRUE</span>,expo.mu<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">bcdv</span><span class="op">$</span><span class="va">model</span><span class="op">&lt;-</span><span class="st">"birth-death taxa de especiação constante e extinção exponencial"</span></span>
<span><span class="co"># birth-death especiação e extinção exponencial</span></span>
<span><span class="va">bvdv</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/RPANDA/man/fit_bd.html">fit_bd</a></span><span class="op">(</span><span class="va">tree</span>,tot_time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/branching.times.html">branching.times</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span><span class="op">)</span>,f.lamb<span class="op">=</span><span class="va">lambda.var</span>,f.mu<span class="op">=</span><span class="va">mu.var</span>,lamb_par<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.01</span><span class="op">)</span>,mu_par<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.005</span>,<span class="fl">0.001</span><span class="op">)</span>,expo.lamb<span class="op">=</span><span class="cn">TRUE</span>,expo.mu<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">bvdv</span><span class="op">$</span><span class="va">model</span><span class="op">&lt;-</span><span class="st">"birth-death taxa de especiação e extinção exponencial"</span></span></code></pre></div>
<p>Comparando os modelos.</p>
<div class="sourceCode" id="cb277"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aic.scores</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">bcdc</span><span class="op">$</span><span class="va">aicc</span>,<span class="va">bvdc</span><span class="op">$</span><span class="va">aicc</span>,<span class="va">bcdv</span><span class="op">$</span><span class="va">aicc</span>,<span class="va">bvdv</span><span class="op">$</span><span class="va">aicc</span><span class="op">)</span>,</span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bcdc"</span>,<span class="st">"bvdc"</span>,<span class="st">"bcdv"</span>,<span class="st">"bvdv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">aic.scores</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/phytools/man/aic.w.html">aic.w</a></span><span class="op">(</span><span class="va">aic.scores</span><span class="op">)</span></span></code></pre></div>
<p>Resultados um pouco ambíguos, mas sugerem que taxas constantes são
improváveis.</p>
<p>É possível ajustar os modelos para toda a árvore, como acima, ou definir
partes da árvore a priori (clados) e testar diferenças nas taxas entre
clados. Se não temos uma hipótese a priori de quais clados tem
diversificação mais rápida, podemos identificar mudanças rápidas olhando
pra árvore, ou usando métodos como o MEDUSA ou o BAMM para detectar
mudanças na diversificação em hipóteses a priori.</p>
</div>
<div id="diversificação-variando-entre-clados-clade-dependent" class="section level2" number="29.3">
<h2>
<span class="header-section-number">29.3</span> Diversificação variando entre clados (<em>clade-dependent</em>)<a class="anchor" aria-label="anchor" href="#diversifica%C3%A7%C3%A3o-variando-entre-clados-clade-dependent"><i class="fas fa-link"></i></a>
</h2>
<p>O exemplo implementa o MEDUSA <span class="citation">(Alfaro et al. 2009)</span>.</p>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mar</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/geiger/man/medusa.html">medusa</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span></span>
<span><span class="va">mar</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mar</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04.11-pcmdiv_files/figure-html/unnamed-chunk-14-1.png" width="672"></div>
<p>Pelo menos dois grandes ‘shifts’ de diversificação podem ser percebidos.
Um no clado dos Macropodidae (cangurus e afins - nó 301) e outro no
clado dos Dasyuromorpha (marsupiais carnívoros - nó 355). r= net
diversification rate. Agora podemos hipotetizar, como exemplo, que o
clado dos cangurus e aliados (Macropodidae) parece ter se diversificado
mais rapidamente.</p>
<div class="sourceCode" id="cb279"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">mar</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/nodelabels.html">nodelabels</a></span><span class="op">(</span><span class="op">)</span><span class="op">}</span></span></code></pre></div>
<div class="inline-figure"><img src="04.11-pcmdiv_files/figure-html/unnamed-chunk-15-1.png" width="672"></div>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">macropodidae.tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/drop.tip.html">extract.clade</a></span><span class="op">(</span><span class="va">tree</span>, <span class="fl">301</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">macropodidae.tree</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04.11-pcmdiv_files/figure-html/unnamed-chunk-15-2.png" width="672"></div>
<div class="sourceCode" id="cb281"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">resto.tree</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/drop.tip.html">drop.tip</a></span><span class="op">(</span><span class="va">tree</span>,<span class="va">macropodidae.tree</span><span class="op">$</span><span class="va">tip.label</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">resto.tree</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04.11-pcmdiv_files/figure-html/unnamed-chunk-15-3.png" width="672"></div>
</div>
<div id="diversificação-variando-no-tempo-e-entre-clados" class="section level2" number="29.4">
<h2>
<span class="header-section-number">29.4</span> Diversificação variando no tempo e entre clados<a class="anchor" aria-label="anchor" href="#diversifica%C3%A7%C3%A3o-variando-no-tempo-e-entre-clados"><i class="fas fa-link"></i></a>
</h2>
<p>Vamos usar RPANDA para ajustar modelos com taxas variáveis entre clados.
Para facilitar, vamos unir os modelos em uma função.</p>
<div class="sourceCode" id="cb282"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit.multi.rpanda</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">tree</span><span class="op">)</span><span class="op">{</span></span>
<span> <span class="va">bcdc</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/RPANDA/man/fit_bd.html">fit_bd</a></span><span class="op">(</span><span class="va">tree</span>,tot_time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/branching.times.html">branching.times</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span><span class="op">)</span>,f.lamb<span class="op">=</span><span class="va">lambda.cst</span>,f.mu<span class="op">=</span><span class="va">mu.cst</span>,lamb_par<span class="op">=</span><span class="fl">0.01</span>,mu_par<span class="op">=</span><span class="fl">0.001</span>,cst.lamb<span class="op">=</span><span class="cn">TRUE</span>,cst.mu<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span> <span class="va">bvdc</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/RPANDA/man/fit_bd.html">fit_bd</a></span><span class="op">(</span><span class="va">tree</span>,tot_time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/branching.times.html">branching.times</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span><span class="op">)</span>,f.lamb<span class="op">=</span><span class="va">lambda.var</span>,f.mu<span class="op">=</span><span class="va">mu.cst</span>,lamb_par<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.01</span><span class="op">)</span>,mu_par<span class="op">=</span><span class="fl">0.001</span>,expo.lamb<span class="op">=</span><span class="cn">TRUE</span>,cst.mu<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span> <span class="va">bcdv</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/RPANDA/man/fit_bd.html">fit_bd</a></span><span class="op">(</span><span class="va">tree</span>,tot_time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/branching.times.html">branching.times</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span><span class="op">)</span>,f.lamb<span class="op">=</span><span class="va">lambda.cst</span>,f.mu<span class="op">=</span><span class="va">mu.var</span>,lamb_par<span class="op">=</span><span class="fl">0.01</span>,mu_par<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.005</span>,<span class="fl">0.001</span><span class="op">)</span>,cst.lamb<span class="op">=</span><span class="cn">TRUE</span>,expo.mu<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span> <span class="va">bvdv</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/RPANDA/man/fit_bd.html">fit_bd</a></span><span class="op">(</span><span class="va">tree</span>,tot_time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/branching.times.html">branching.times</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span><span class="op">)</span>,f.lamb<span class="op">=</span><span class="va">lambda.var</span>,f.mu<span class="op">=</span><span class="va">mu.var</span>,lamb_par<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.01</span><span class="op">)</span>,mu_par<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.005</span>,<span class="fl">0.001</span><span class="op">)</span>,expo.lamb<span class="op">=</span><span class="cn">TRUE</span>,expo.mu<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"bcdc"</span><span class="op">=</span><span class="va">bcdc</span>,<span class="st">"bvdc"</span><span class="op">=</span><span class="va">bvdc</span>,<span class="st">"bcdv"</span><span class="op">=</span><span class="va">bcdv</span>,<span class="st">"bvdv"</span><span class="op">=</span><span class="va">bvdv</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="op">}</span></span>
<span><span class="va">macropodidae_panda</span><span class="op">&lt;-</span><span class="fu">fit.multi.rpanda</span><span class="op">(</span><span class="va">macropodidae.tree</span><span class="op">)</span></span>
<span><span class="va">resto_panda</span><span class="op">&lt;-</span><span class="fu">fit.multi.rpanda</span><span class="op">(</span><span class="va">resto.tree</span><span class="op">)</span></span></code></pre></div>
<p>Comparando modelos.</p>
<div class="sourceCode" id="cb283"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extraindo aicc</span></span>
<span><span class="va">macro_aic</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span> <span class="co">#vetor vazio</span></span>
<span><span class="va">resto_aic</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">numeric</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">macro_aic</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bcdc"</span>, <span class="st">"bvdc"</span>, <span class="st">"bcdv"</span>, <span class="st">"bvdv"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">resto_aic</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">macro_aic</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span>
<span> <span class="va">macro_aic</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">macropodidae_panda</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">aicc</span></span>
<span> <span class="va">resto_aic</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">resto_panda</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">aicc</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/phytools/man/aic.w.html">aic.w</a></span><span class="op">(</span><span class="va">macro_aic</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/phytools/man/aic.w.html">aic.w</a></span><span class="op">(</span><span class="va">resto_aic</span><span class="op">)</span></span></code></pre></div>
<p>Novamente os resultados são um pouco inconclusivos. Parece haver maior suporte para modelos com taxas variáveis do que constantes. Para o clado Macropodidae uma variação exponencial nas taxas de especiação parece bem provável, enquanto que para o resto da árvore, uma variação em ambas as taxas (especiação e extinção) é mais provável.</p>
<p>Podemos plotar as taxas de especiação, extinção, e diversificação (b-d) ao longo do tempo para os modelos mais prováveis de cada clado.</p>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/RPANDA/man/plot_fit_bd.html">plot_fit_bd</a></span><span class="op">(</span><span class="va">macropodidae_panda</span><span class="op">$</span><span class="va">bvdc</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/branching.times.html">branching.times</a></span><span class="op">(</span><span class="va">macropodidae.tree</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/RPANDA/man/plot_fit_bd.html">plot_fit_bd</a></span><span class="op">(</span><span class="va">resto_panda</span><span class="op">$</span><span class="va">bvdv</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/branching.times.html">branching.times</a></span><span class="op">(</span><span class="va">resto.tree</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">macropodidae.tree</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">resto.tree</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="exercício---diversificação-dependente-de-variável-ambiental" class="section level2" number="29.5">
<h2>
<span class="header-section-number">29.5</span> Exercício - Diversificação dependente de variável ambiental<a class="anchor" aria-label="anchor" href="#exerc%C3%ADcio---diversifica%C3%A7%C3%A3o-dependente-de-vari%C3%A1vel-ambiental"><i class="fas fa-link"></i></a>
</h2>
<p>RPANDA pode ser usado para ajustar modelos de diversificação dependente de variável ambiental (fit_env). Como variável adicional, esse modelo requer uma estimativa da variação em uma variável ambiental de interesse ao longo do tempo. Zachos et al (2008) fornecem uma estimativa de variação de temperatura ao longo do Cenozóico baseada em isótopos de oxigênio.</p>
<p>Baseado nos dados:
Árvore para roedores sigmodontíneos:
sigmodontinae-tree.tre
Dados de temperatura, duas colunas com tempo e
temperatura:
Cenozoic_Temp.txt</p>
<p>Ajuste um modelo com variação nas taxas de especiação dependentes da
temperatura, sem dependência temporal e sem extinção:</p>
<p>lambda.env&lt;-function(t,x,y){y[1]<em>exp(y[2]</em>x)}
e
mu.zero&lt;-function(t,x,y){0}</p>
<p>Com os parâmetros iniciais:</p>
<p>lamb_par_init&lt;-c(0.10,0.01)</p>
<p>mu_par_init&lt;-c()</p>
<p>O modelo deve ser ajustado com a função fit_env do pacote RPANDA. Faça um gráfico dos resultados com plot_fit_env e interprete os resultados.</p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="diversifica%C3%A7%C3%A3o-de-linhagens.html"><span class="header-section-number">28</span> Diversificação de linhagens</a></div>
<div class="next"><a href="diversifica%C3%A7%C3%A3o-dependente-de-estado.html"><span class="header-section-number">30</span> Diversificação dependente de estado</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#taxas-de-especia%C3%A7%C3%A3o-e-extin%C3%A7%C3%A3o-constantes-e-vari%C3%A1veis"><span class="header-section-number">29</span> Taxas de especiação e extinção constantes e variáveis</a></li>
<li><a class="nav-link" href="#diversifica%C3%A7%C3%A3o-constante"><span class="header-section-number">29.1</span> Diversificação constante</a></li>
<li><a class="nav-link" href="#diversifica%C3%A7%C3%A3o-variando-no-tempo-time-dependent"><span class="header-section-number">29.2</span> Diversificação variando no tempo (time-dependent)</a></li>
<li><a class="nav-link" href="#diversifica%C3%A7%C3%A3o-variando-entre-clados-clade-dependent"><span class="header-section-number">29.3</span> Diversificação variando entre clados (clade-dependent)</a></li>
<li><a class="nav-link" href="#diversifica%C3%A7%C3%A3o-variando-no-tempo-e-entre-clados"><span class="header-section-number">29.4</span> Diversificação variando no tempo e entre clados</a></li>
<li><a class="nav-link" href="#exerc%C3%ADcio---diversifica%C3%A7%C3%A3o-dependente-de-vari%C3%A1vel-ambiental"><span class="header-section-number">29.5</span> Exercício - Diversificação dependente de variável ambiental</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/renanmaestri/eebb/blob/master/04.11-pcmdiv.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/renanmaestri/eebb/edit/master/04.11-pcmdiv.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Manual de Ecologia Evolutiva, Biometria e Biogeografia</strong>" was written by Renan Maestri. It was last built on 2023-11-14.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
