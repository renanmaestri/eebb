<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 11 Modelos lineares para discriminação de grupos | Manual de Ecologia Evolutiva, Biometria e Biogeografia</title>
<meta name="author" content="Renan Maestri">
<meta name="description" content="Uma classe ampla de modelos preditivos está abarcada pelo nome de Modelos Lineares Generalizados, incluindo regressão múltipla e análises de variância/covariância. Uma vasta gama de modelos pode...">
<meta name="generator" content="bookdown 0.35 with bs4_book()">
<meta property="og:title" content="Capítulo 11 Modelos lineares para discriminação de grupos | Manual de Ecologia Evolutiva, Biometria e Biogeografia">
<meta property="og:type" content="book">
<meta property="og:url" content="https://renanmaestri.github.io/eebb/modelos-lineares-para-discriminação-de-grupos.html">
<meta property="og:image" content="https://renanmaestri.github.io/eebb/images/Slogan_oficial_sologo.jpg">
<meta property="og:description" content="Uma classe ampla de modelos preditivos está abarcada pelo nome de Modelos Lineares Generalizados, incluindo regressão múltipla e análises de variância/covariância. Uma vasta gama de modelos pode...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 11 Modelos lineares para discriminação de grupos | Manual de Ecologia Evolutiva, Biometria e Biogeografia">
<meta name="twitter:description" content="Uma classe ampla de modelos preditivos está abarcada pelo nome de Modelos Lineares Generalizados, incluindo regressão múltipla e análises de variância/covariância. Uma vasta gama de modelos pode...">
<meta name="twitter:image" content="https://renanmaestri.github.io/eebb/images/Slogan_oficial_sologo.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.1/transition.js"></script><script src="libs/bs3compat-0.5.1/tabs.js"></script><script src="libs/bs3compat-0.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Manual de Ecologia Evolutiva, Biometria e Biogeografia</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefácio</a></li>
<li class="book-part">Conceitos básicos</li>
<li><a class="" href="conceitos-b%C3%A1sicos.html"><span class="header-section-number">1</span> Conceitos básicos</a></li>
<li class="book-part">Introdução ao R</li>
<li><a class="" href="uma-breve-introdu%C3%A7%C3%A3o-ao-r.html"><span class="header-section-number">2</span> Uma breve introdução ao R</a></li>
<li class="book-part">Morfometria Geométrica</li>
<li><a class="" href="morfometria-geom%C3%A9trica.html"><span class="header-section-number">3</span> Morfometria Geométrica</a></li>
<li><a class="" href="digitaliza%C3%A7%C3%A3o-de-landmarks.html"><span class="header-section-number">4</span> Digitalização de landmarks</a></li>
<li><a class="" href="an%C3%A1lise-de-procrustes.html"><span class="header-section-number">5</span> Análise de Procrustes</a></li>
<li><a class="" href="visualiza%C3%A7%C3%A3o-da-forma.html"><span class="header-section-number">6</span> Visualização da forma</a></li>
<li><a class="" href="assimetria-e-quantifica%C3%A7%C3%A3o-de-erro.html"><span class="header-section-number">7</span> Assimetria e quantificação de erro</a></li>
<li><a class="" href="tamanho-do-centr%C3%B3ide.html"><span class="header-section-number">8</span> Tamanho do Centróide</a></li>
<li><a class="" href="m%C3%A9todos-de-ordena%C3%A7%C3%A3o.html"><span class="header-section-number">9</span> Métodos de ordenação</a></li>
<li><a class="" href="partial-least-squares.html"><span class="header-section-number">10</span> Partial Least Squares</a></li>
<li><a class="active" href="modelos-lineares-para-discrimina%C3%A7%C3%A3o-de-grupos.html"><span class="header-section-number">11</span> Modelos lineares para discriminação de grupos</a></li>
<li><a class="" href="alometria.html"><span class="header-section-number">12</span> Alometria</a></li>
<li><a class="" href="an%C3%A1lise-de-trajet%C3%B3ria.html"><span class="header-section-number">13</span> Análise de Trajetória</a></li>
<li><a class="" href="integra%C3%A7%C3%A3o-morfol%C3%B3gica-e-modularidade.html"><span class="header-section-number">14</span> Integração morfológica e modularidade</a></li>
<li><a class="" href="disparidade-e-varia%C3%A7%C3%A3o-morfol%C3%B3gica.html"><span class="header-section-number">15</span> Disparidade e variação morfológica</a></li>
<li><a class="" href="morfometria-geom%C3%A9trica-e-filogenias.html"><span class="header-section-number">16</span> Morfometria geométrica e filogenias</a></li>
<li class="book-part">Macroevolução</li>
<li><a class="" href="macroevolu%C3%A7%C3%A3o.html"><span class="header-section-number">17</span> Macroevolução</a></li>
<li class="book-part">Biogeografia e Macroecologia</li>
<li><a class="" href="biogeografia-e-macroecologia.html"><span class="header-section-number">18</span> Biogeografia e Macroecologia</a></li>
<li class="book-part">Conclusão</li>
<li><a class="" href="considera%C3%A7%C3%B5es-finais.html"><span class="header-section-number">19</span> Considerações finais</a></li>
<li><a class="" href="refer%C3%AAncias.html">Referências</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/renanmaestri/eebb">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="modelos-lineares-para-discriminação-de-grupos" class="section level1" number="11">
<h1>
<span class="header-section-number">Capítulo 11</span> Modelos lineares para discriminação de grupos<a class="anchor" aria-label="anchor" href="#modelos-lineares-para-discrimina%C3%A7%C3%A3o-de-grupos"><i class="fas fa-link"></i></a>
</h1>
<p>Uma classe ampla de modelos preditivos está abarcada pelo nome de Modelos Lineares Generalizados, incluindo regressão múltipla e análises de variância/covariância. Uma vasta gama de modelos pode ser ajustada com a função ‘procD.lm’ e outras do pacote <em>geomorph</em>, que usa distância de Procrustes entre espécimes para calcular tamanhos de efeito e randomização para calcular valores de <em>P</em> (de modo equivalente à MANOVA não paramétrica – Goodall 1991, Anderson 2001); assim, o número de variáveis de forma, normalmente muito alto em dados de MG, não é uma restrição ao ajuste de modelos (Collyer et al. 2015).
Podemos usar esses modelos baseados em distância para responder diversas questões quando a variável resposta é composta por variáveis de forma. Aqui, vamos aplicá-los no contexto de discriminação de grupos, quando a variável preditora é categórica.</p>
<div id="manova" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> MANOVA<a class="anchor" aria-label="anchor" href="#manova"><i class="fas fa-link"></i></a>
</h2>
<p>Vamos testar se existem diferenças de forma entre espécies de tuco-tucos.</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/geomorphR/geomorph">geomorph</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Carregando pacotes exigidos: geomorph</span></span>
<span><span class="co">#&gt; Carregando pacotes exigidos: RRPP</span></span>
<span><span class="co">#&gt; Carregando pacotes exigidos: rgl</span></span>
<span><span class="co">#&gt; Carregando pacotes exigidos: Matrix</span></span>
<span><span class="co"># Carregar dados</span></span>
<span><span class="va">tps</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/readland.tps.html">readland.tps</a></span><span class="op">(</span><span class="st">"dadosmg/Lista tuco dig 2.tps"</span>,specID <span class="op">=</span> <span class="st">"ID"</span>, readcurves <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">tps</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Gerar matriz com pares de landmarks simétricos</span></span>
<span><span class="va">pairs.matrix</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">10</span>,<span class="fl">11</span>,<span class="fl">12</span>,<span class="fl">13</span>,<span class="fl">14</span>,<span class="fl">15</span>,<span class="fl">16</span>,<span class="fl">17</span>,<span class="fl">18</span>,<span class="fl">19</span>,<span class="fl">20</span>,<span class="fl">21</span>,<span class="fl">23</span>,<span class="fl">24</span>,<span class="fl">25</span>,<span class="fl">26</span>,<span class="fl">27</span>,<span class="fl">28</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">12</span>,ncol<span class="op">=</span><span class="fl">2</span>,byrow<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="co"># Vetor indivíduos</span></span>
<span><span class="va">ind</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">tps</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># GPA - Simetria bilateral </span></span>
<span><span class="va">b.s</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/bilat.symmetry.html">bilat.symmetry</a></span><span class="op">(</span><span class="va">tps</span>,ind<span class="op">=</span><span class="va">ind</span>,object.sym<span class="op">=</span><span class="cn">TRUE</span>,land.pairs<span class="op">=</span><span class="va">pairs.matrix</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Matriz de forma</span></span>
<span><span class="va">shape.sym</span><span class="op">&lt;-</span><span class="va">b.s</span><span class="op">$</span><span class="va">symm.shape</span></span>
<span></span>
<span><span class="co"># Carregar classificadores a partir de lista externa</span></span>
<span><span class="va">plan</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"dadosmg/Planilha Ctenomys.txt"</span>,h<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">plan</span></span>
<span><span class="va">species</span><span class="op">&lt;-</span><span class="va">plan</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">species</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span></span>
<span><span class="va">sex</span><span class="op">&lt;-</span><span class="va">plan</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">sex</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">sex</span><span class="op">)</span></span>
<span><span class="va">sp.sex</span><span class="op">&lt;-</span><span class="va">plan</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">sp.sex</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">sp.sex</span><span class="op">)</span></span></code></pre></div>
<p>MANOVA.</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MANOVA (Multivariate Analysis of Variance)</span></span>
<span><span class="va">manova</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/procD.lm.html">procD.lm</a></span><span class="op">(</span><span class="va">shape.sym</span><span class="op">~</span><span class="va">species</span>, iter<span class="op">=</span><span class="fl">999</span>, RRPP<span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">manova</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Analysis of Variance, using Residual Randomization</span></span>
<span><span class="co">#&gt; Permutation procedure: Randomization of null model residuals </span></span>
<span><span class="co">#&gt; Number of permutations: 1000 </span></span>
<span><span class="co">#&gt; Estimation method: Ordinary Least Squares </span></span>
<span><span class="co">#&gt; Sums of Squares and Cross-products: Type I </span></span>
<span><span class="co">#&gt; Effect sizes (Z) based on F distributions</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           Df       SS        MS     Rsq      F      Z</span></span>
<span><span class="co">#&gt; species    2 0.019283 0.0096414 0.46942 11.944 4.7202</span></span>
<span><span class="co">#&gt; Residuals 27 0.021795 0.0008072 0.53058              </span></span>
<span><span class="co">#&gt; Total     29 0.041078                                </span></span>
<span><span class="co">#&gt;           Pr(&gt;F)   </span></span>
<span><span class="co">#&gt; species    0.001 **</span></span>
<span><span class="co">#&gt; Residuals          </span></span>
<span><span class="co">#&gt; Total              </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call: procD.lm(f1 = shape.sym ~ species, iter = 999, RRPP = TRUE)</span></span>
<span></span>
<span><span class="va">manova.sex</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/procD.lm.html">procD.lm</a></span><span class="op">(</span><span class="va">shape.sym</span><span class="op">~</span><span class="va">sex</span>, iter<span class="op">=</span><span class="fl">999</span>, RRPP<span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">manova.sex</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Analysis of Variance, using Residual Randomization</span></span>
<span><span class="co">#&gt; Permutation procedure: Randomization of null model residuals </span></span>
<span><span class="co">#&gt; Number of permutations: 1000 </span></span>
<span><span class="co">#&gt; Estimation method: Ordinary Least Squares </span></span>
<span><span class="co">#&gt; Sums of Squares and Cross-products: Type I </span></span>
<span><span class="co">#&gt; Effect sizes (Z) based on F distributions</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           Df       SS        MS     Rsq      F      Z</span></span>
<span><span class="co">#&gt; sex        1 0.002892 0.0028915 0.07039 2.1202 1.4855</span></span>
<span><span class="co">#&gt; Residuals 28 0.038187 0.0013638 0.92961              </span></span>
<span><span class="co">#&gt; Total     29 0.041078                                </span></span>
<span><span class="co">#&gt;           Pr(&gt;F)  </span></span>
<span><span class="co">#&gt; sex        0.077 .</span></span>
<span><span class="co">#&gt; Residuals         </span></span>
<span><span class="co">#&gt; Total             </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call: procD.lm(f1 = shape.sym ~ sex, iter = 999, RRPP = TRUE)</span></span>
<span></span>
<span><span class="va">manova.completa</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/procD.lm.html">procD.lm</a></span><span class="op">(</span><span class="va">shape.sym</span><span class="op">~</span><span class="va">species</span><span class="op">*</span><span class="va">sex</span>, iter<span class="op">=</span><span class="fl">999</span>, RRPP<span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">manova.completa</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Analysis of Variance, using Residual Randomization</span></span>
<span><span class="co">#&gt; Permutation procedure: Randomization of null model residuals </span></span>
<span><span class="co">#&gt; Number of permutations: 1000 </span></span>
<span><span class="co">#&gt; Estimation method: Ordinary Least Squares </span></span>
<span><span class="co">#&gt; Sums of Squares and Cross-products: Type I </span></span>
<span><span class="co">#&gt; Effect sizes (Z) based on F distributions</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             Df       SS        MS     Rsq       F      Z</span></span>
<span><span class="co">#&gt; species      2 0.019283 0.0096414 0.46942 13.9065 4.9897</span></span>
<span><span class="co">#&gt; sex          1 0.002892 0.0028915 0.07039  4.1707 3.5268</span></span>
<span><span class="co">#&gt; species:sex  2 0.002264 0.0011322 0.05512  1.6331 1.7627</span></span>
<span><span class="co">#&gt; Residuals   24 0.016639 0.0006933 0.40506               </span></span>
<span><span class="co">#&gt; Total       29 0.041078                                 </span></span>
<span><span class="co">#&gt;             Pr(&gt;F)   </span></span>
<span><span class="co">#&gt; species      0.001 **</span></span>
<span><span class="co">#&gt; sex          0.001 **</span></span>
<span><span class="co">#&gt; species:sex  0.036 * </span></span>
<span><span class="co">#&gt; Residuals            </span></span>
<span><span class="co">#&gt; Total                </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call: procD.lm(f1 = shape.sym ~ species * sex, iter = 999, RRPP = TRUE)</span></span>
<span></span>
<span><span class="co"># MANOVA Wilks's lambda</span></span>
<span><span class="va">PCA</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/gm.prcomp.html">gm.prcomp</a></span><span class="op">(</span><span class="va">shape.sym</span><span class="op">)</span></span>
<span><span class="va">manova.w</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/manova.html">manova</a></span><span class="op">(</span><span class="va">PCA</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">26</span><span class="op">]</span><span class="op">~</span><span class="va">species</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">manova.w</span>,test<span class="op">=</span><span class="st">"Wilks"</span><span class="op">)</span></span>
<span><span class="co">#&gt;           Df      Wilks approx F num Df den Df  Pr(&gt;F)  </span></span>
<span><span class="co">#&gt; species    2 7.9746e-05    8.537     52      4 0.02414 *</span></span>
<span><span class="co">#&gt; Residuals 27                                            </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span></span>
<span><span class="va">manova.w.sex</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/manova.html">manova</a></span><span class="op">(</span><span class="va">PCA</span><span class="op">$</span><span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">26</span><span class="op">]</span><span class="op">~</span><span class="va">sex</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">manova.w.sex</span>,test<span class="op">=</span><span class="st">"Wilks"</span><span class="op">)</span></span>
<span><span class="co">#&gt;           Df    Wilks approx F num Df den Df  Pr(&gt;F)  </span></span>
<span><span class="co">#&gt; sex        1 0.021083   5.3575     26      3 0.09549 .</span></span>
<span><span class="co">#&gt; Residuals 28                                          </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>Além da resposta geral, é interessante obter comparações par a par.</p>
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pairwise comparisons</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mlcollyer/RRPP">RRPP</a></span><span class="op">)</span></span>
<span><span class="va">manova.pairwise</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/RRPP/man/pairwise.html">pairwise</a></span><span class="op">(</span><span class="va">manova</span>,groups<span class="op">=</span><span class="va">species</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">manova.pairwise</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Pairwise comparisons</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Groups: C.flamarioni C.minutus C.torquatus </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; RRPP: 1000 permutations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; LS means:</span></span>
<span><span class="co">#&gt; Vectors hidden (use show.vectors = TRUE to view)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Pairwise distances between means, plus statistics</span></span>
<span><span class="co">#&gt;                                   d  UCL (95%)        Z</span></span>
<span><span class="co">#&gt; C.flamarioni:C.minutus   0.03831876 0.02502431 3.065210</span></span>
<span><span class="co">#&gt; C.flamarioni:C.torquatus 0.05438892 0.02542406 4.093932</span></span>
<span><span class="co">#&gt; C.minutus:C.torquatus    0.03685612 0.02512571 2.914480</span></span>
<span><span class="co">#&gt;                          Pr &gt; d</span></span>
<span><span class="co">#&gt; C.flamarioni:C.minutus    0.003</span></span>
<span><span class="co">#&gt; C.flamarioni:C.torquatus  0.001</span></span>
<span><span class="co">#&gt; C.minutus:C.torquatus     0.001</span></span></code></pre></div>
<p>Manova par a par “manual”.</p>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Manova par a par</span></span>
<span><span class="va">gdf.1</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/geomorph.data.frame.html">geomorph.data.frame</a></span><span class="op">(</span>coords<span class="op">=</span><span class="va">shape.sym</span><span class="op">[</span>,,<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">species</span><span class="op">==</span><span class="st">"C.flamarioni"</span><span class="op">|</span><span class="va">species</span><span class="op">==</span><span class="st">"C.minutus"</span><span class="op">)</span><span class="op">]</span>,species<span class="op">=</span><span class="va">species</span><span class="op">[</span><span class="va">species</span><span class="op">==</span><span class="st">"C.flamarioni"</span> <span class="op">|</span> <span class="va">species</span><span class="op">==</span><span class="st">"C.minutus"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">manova.par1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/procD.lm.html">procD.lm</a></span><span class="op">(</span><span class="va">coords</span><span class="op">~</span><span class="va">species</span>, iter<span class="op">=</span><span class="fl">999</span>, data <span class="op">=</span> <span class="va">gdf.1</span><span class="op">)</span></span>
<span><span class="va">manova.par1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">manova.par1</span><span class="op">)</span></span>
<span><span class="va">gdf.2</span><span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/geomorph.data.frame.html">geomorph.data.frame</a></span><span class="op">(</span>coords<span class="op">=</span><span class="va">shape.sym</span><span class="op">[</span>,,<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">species</span><span class="op">==</span><span class="st">"C.flamarioni"</span><span class="op">|</span><span class="va">species</span><span class="op">==</span><span class="st">"C.torquatus"</span><span class="op">)</span><span class="op">]</span>,species<span class="op">=</span><span class="va">species</span><span class="op">[</span><span class="va">species</span><span class="op">==</span><span class="st">"C.flamarioni"</span> <span class="op">|</span> <span class="va">species</span><span class="op">==</span><span class="st">"C.torquatus"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">manova.par2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/procD.lm.html">procD.lm</a></span><span class="op">(</span><span class="va">coords</span><span class="op">~</span><span class="va">species</span>, iter<span class="op">=</span><span class="fl">999</span>, data <span class="op">=</span> <span class="va">gdf.2</span><span class="op">)</span></span>
<span><span class="va">manova.par2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">manova.par2</span><span class="op">)</span></span>
<span><span class="va">gdf.3</span><span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/geomorph.data.frame.html">geomorph.data.frame</a></span><span class="op">(</span>coords<span class="op">=</span><span class="va">shape.sym</span><span class="op">[</span>,,<span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">species</span><span class="op">==</span><span class="st">"C.minutus"</span><span class="op">|</span><span class="va">species</span><span class="op">==</span><span class="st">"C.torquatus"</span><span class="op">)</span><span class="op">]</span>,species<span class="op">=</span><span class="va">species</span><span class="op">[</span><span class="va">species</span><span class="op">==</span><span class="st">"C.minutus"</span> <span class="op">|</span> <span class="va">species</span><span class="op">==</span><span class="st">"C.torquatus"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">manova.par3</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/geomorph/man/procD.lm.html">procD.lm</a></span><span class="op">(</span><span class="va">coords</span><span class="op">~</span><span class="va">species</span>, iter<span class="op">=</span><span class="fl">999</span>, data <span class="op">=</span> <span class="va">gdf.3</span><span class="op">)</span></span>
<span><span class="va">manova.par3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">manova.par3</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="fenograma" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> Fenograma<a class="anchor" aria-label="anchor" href="#fenograma"><i class="fas fa-link"></i></a>
</h2>
<p>Dependendo da pergunta de estudo, fenogramas podem ser úteis para visualizar os padrões de diferenciação de forma em um formato de árvore de distâncias morfológicas.
Aqui, vamos criar um fenograma com distâncias de Procrustes e agrupamento de Neighbot-Joining.</p>
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">manova.pairwise</span><span class="op">)</span></span>
<span><span class="va">obj</span><span class="op">$</span><span class="va">pairwise.tables</span><span class="op">$</span><span class="va">D</span></span>
<span><span class="va">means.dist</span><span class="op">&lt;-</span><span class="va">obj</span><span class="op">$</span><span class="va">pairwise.tables</span><span class="op">$</span><span class="va">D</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="http://ape-package.ird.fr/">ape</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Carregando pacotes exigidos: ape</span></span>
<span><span class="va">fen</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/nj.html">nj</a></span><span class="op">(</span><span class="va">means.dist</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fen</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03.8-mgaov_files/figure-html/unnamed-chunk-5-1.png" width="672"></div>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">fen</span>,type<span class="op">=</span><span class="st">"unrooted"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="03.8-mgaov_files/figure-html/unnamed-chunk-5-2.png" width="672"></div>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="partial-least-squares.html"><span class="header-section-number">10</span> Partial Least Squares</a></div>
<div class="next"><a href="alometria.html"><span class="header-section-number">12</span> Alometria</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#modelos-lineares-para-discrimina%C3%A7%C3%A3o-de-grupos"><span class="header-section-number">11</span> Modelos lineares para discriminação de grupos</a></li>
<li><a class="nav-link" href="#manova"><span class="header-section-number">11.1</span> MANOVA</a></li>
<li><a class="nav-link" href="#fenograma"><span class="header-section-number">11.2</span> Fenograma</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/renanmaestri/eebb/blob/master/03.8-mgaov.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/renanmaestri/eebb/edit/master/03.8-mgaov.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Manual de Ecologia Evolutiva, Biometria e Biogeografia</strong>" was written by Renan Maestri. It was last built on 2023-09-27.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
