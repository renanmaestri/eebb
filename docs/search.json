[{"path":"index.html","id":"prefácio","chapter":"Prefácio","heading":"Prefácio","text":"Esse manual tem o objetivo de servir de apoio às disciplinas que leciono na UFRGS. O manual contém material de apoio das disciplinas de Introdução à Ecologia, Ecologia para Biotecnologia, Ecologia (evolutiva) e Ecologia II (macroecologia e biogeografia), Ecologia e Evolução Morfológica, Fundamentos de Morfometria Geométrica, Macroecologia, Macroevolução e Métodos Filogenéticos Comparativos e Oficina de Ecologia Evolutiva. Ministro essas disciplinas na Universidade Federal Rio Grande Sul (UFRGS) desde 2018, algumas para graduação e algumas para pós-graduação, para diferentes cursos de graduação e Programas de Pós-Graduação Instituto de Biociências da UFRGS. Algumas dessas disciplinas são ou foram desenvolvidas em colaboração com os professores Gonçalo Ferraz e Heinrich Hasenack (Ecologia ), Leandro Duarte e Luciane Crossetti (Ecologia II), Rodrigo Fornel (Fundamentos de Morfometria Geométrica) e Leandro Duarte (Oficina de Ecologia Evolutiva), quem agradeço pela parceria. O livro contém uma parte material visto nessas disciplinas, com foco nas atividades práticas.O intuito de disponibilizar esse manual de Ecologia Evolutiva, Biometria e Biogeografia é que ele sirva de material de apoio às disciplinas que ministro. Tentei organizá-lo de modo unificado, para que ele seja útil simultaneamente às diferentes disciplinas e níveis de ensino.Todos os exercícios práticos usam o programa R (R-base?). Há um capítulo que introduz o R.Agradeço aos alunos com quem tive o prazer de interagir e que incentivam ser um professor um pouco melhor cada dia, espero que esse manual seja útil vocês durante e após disciplinas. Tenho uma dívida impagável com pessoas que fazem parte e que passaram pelo Laboratório de Ecomorfologia e Macroevolução pela troca de experiências e ensinamentos que culminaram na elaboração deste manual.Se você tiver qualquer comentário ou contribuição ao livro, por favor escreva (renanmaestri@gmail.com).","code":""},{"path":"conceitos-básicos.html","id":"conceitos-básicos","chapter":"Capítulo 1 Conceitos básicos","heading":"Capítulo 1 Conceitos básicos","text":"Em construção.","code":""},{"path":"conceitos-básicos.html","id":"processos-evolutivos","chapter":"Capítulo 1 Conceitos básicos","heading":"1.1 Processos evolutivos","text":"Em construção.","code":""},{"path":"conceitos-básicos.html","id":"seleção-natural","chapter":"Capítulo 1 Conceitos básicos","heading":"1.2 Seleção natural","text":"Em construção.","code":""},{"path":"conceitos-básicos.html","id":"seleção-direcional","chapter":"Capítulo 1 Conceitos básicos","heading":"1.2.1 Seleção direcional","text":"Em construção.","code":""},{"path":"conceitos-básicos.html","id":"seleção-disruptiva","chapter":"Capítulo 1 Conceitos básicos","heading":"1.2.2 Seleção disruptiva","text":"Em construção.","code":""},{"path":"conceitos-básicos.html","id":"seleção-estabilizadora","chapter":"Capítulo 1 Conceitos básicos","heading":"1.2.3 Seleção estabilizadora","text":"Em construção.","code":""},{"path":"conceitos-básicos.html","id":"deriva-genética","chapter":"Capítulo 1 Conceitos básicos","heading":"1.3 Deriva genética","text":"Em construção.","code":""},{"path":"conceitos-básicos.html","id":"simulação-de-deriva-e-seleção","chapter":"Capítulo 1 Conceitos básicos","heading":"1.3.1 Simulação de deriva e seleção","text":"Em construção.","code":""},{"path":"conceitos-básicos.html","id":"ecologia-evolutiva-do-desenvolvimento","chapter":"Capítulo 1 Conceitos básicos","heading":"1.4 Ecologia evolutiva do desenvolvimento","text":"Em construção.","code":""},{"path":"conceitos-básicos.html","id":"interações-genótipo-fenótipo-ambiente","chapter":"Capítulo 1 Conceitos básicos","heading":"1.4.1 Interações genótipo-fenótipo-ambiente","text":"Em construção.","code":""},{"path":"conceitos-básicos.html","id":"plasticidade-fenotípica","chapter":"Capítulo 1 Conceitos básicos","heading":"1.4.2 Plasticidade fenotípica","text":"Em construção.","code":""},{"path":"conceitos-básicos.html","id":"epigenética","chapter":"Capítulo 1 Conceitos básicos","heading":"1.4.3 Epigenética","text":"Em construção.","code":""},{"path":"cap2.html","id":"cap2","chapter":"Capítulo 2 Uma breve introdução ao R","heading":"Capítulo 2 Uma breve introdução ao R","text":"O R pode ser instalado partir website: https://www.r-project.org/ Nós vamos usar também o RStudio: https://www.rstudio.com/O R é um ambiente para análise computacional e produção de gráficos baseado em linguagem de programação.\nHoje, o R é o programa predominante em ecologia e evolução, em larga medida porque é e adaptável para várias necessidades, e existe uma comunidade grande de indivíduos dispostos fornecer ajuda.\ncontexto da biometria e de análises filogenéticas comparativas, o R tem sido área primária de desenvolvimento de novos métodos.Aqui, você vai encontrar um breve tutorial sobre o R para conseguir realizar atividades práticas da disciplina.\nentanto, há material muito mais completo disponível.\nExistem vários bons livros e cursos gratuitos de R e de estatística disponibilizados na web.\nTire proveito deles!\nPor exemplo: - Curso de Programação em R, prof. Bruno Vilela - Livro Análises Ecológicas R - Curso de Estatística para Pesquisa Científica, prof. Thiago Rangel","code":""},{"path":"cap2.html","id":"definindo-um-diretório-de-trabalho","chapter":"Capítulo 2 Uma breve introdução ao R","heading":"2.1 Definindo um diretório de trabalho","text":"É conveniente criar uma pasta única com todos os arquivos das aulas práticas.\nNós vamos informar ao R para carregar os dados partir desta pasta.\nIsso pode ser feito RStudio com o menu: Session>Set Working Directory>Choose Directory.\nOu com o código setwd().","code":""},{"path":"cap2.html","id":"roteiros-scripts","chapter":"Capítulo 2 Uma breve introdução ao R","heading":"2.2 Roteiros (scripts)","text":"Um script é um bloco de texto que pode ser editado em qualquer editor de texto comum (ex: bloco de notas), ou com o editor de texto próprio R ou RStudio.\nVocê vai escrever os códigos dentro script, e depois enviar para o console R - selecione linha ou parte código ser enviada ao console R e pressione ‘Run’ ou use crtl+r ou ctrl+Enter.\nAo salvar o script você mantém um registro código utilizado.\nSe você quiser adicionar comentários ao código basta adicionar o sinal # na frente comentário.\nUma ótima alternativa ao script comum é utilizar o R Markdown, onde é possível diferenciar facilmente códigos e textos explicativos.","code":""},{"path":"cap2.html","id":"funcionamento-básico-do-r","chapter":"Capítulo 2 Uma breve introdução ao R","heading":"2.3 Funcionamento básico do R","text":"Objetos e funções são os principais componentes R.\nObjetos são variáveis como dados ou resultados.\nEles podem estar formatados de diferentes maneiras, formando estruturas diferentes.\nPor exemplo, vetores, matrizes, ‘dataframes’, listas, etc. são todos exemplos de estruturas de objetos.\nFunções são tipos especiais de objetos que usam um ou mais argumentos para fazer alguma coisa dentro R.Objetos são como proteínas e funções são como enzimas.\nOs aminoácidos são números ou letras.Compilados de funções são organizados dentro de pacotes criados por diversos autores.O R funciona através de comandos, que são normalmente acompanhados de funções ou operações (+,-,*,etc).\nUm comando retorna um objeto na tela, ou armazena o objeto na memória quando um nome é atribuído com o operador <- ou =.Cuidado, os objetos distinguem letras maiúsculas de minúsculas.","code":"\n2+5\n#> [1] 7\nx<-2+5\nx\n#> [1] 7\nx<-1\nX<-10\nx\n#> [1] 1\nX\n#> [1] 10"},{"path":"cap2.html","id":"tipos-de-objeto-no-r","chapter":"Capítulo 2 Uma breve introdução ao R","heading":"2.4 Tipos de objeto no R","text":"O R classifica objetos em tipos/classes dependendo de sua estrutura.\nVamos encontrar frequentemente alguns tipos de objetos mais comuns, como vector, factor, matrix, data.frame, array e list.Os objetos podem conter nomes internos, o que é bastante útil com dados biológicos já que eles podem fornecer rótulos para os dados, ex: espécies ou localidades.função ls() lista todos os objetos criados na seção.\nVocê também pode conferir os objetos na aba Environment, ao lado.Todas funções R possuem uma página de ajuda descrevendo função.\najuda pode ser acessada com ?\nseguido nome da função.Um dos aspectos importantes negligenciados por iniciantes R são páginas de ajuda!\nSempre confira ajuda da função que está tentando aplicar usando o operador ?\nantes nome da função.\nPor exemplo, ?m\nean.\nPreste atenção aos argumentos que função usa, e quais tipos/estrutura de objetos são aceitos como argumentos.\nEstude página de ajuda e entenda como ela funciona.Algumas operações são úteis para reproduzir códigos/funções várias vezes.\nO loop repete uma determinada operação por um número fixo de vezes.\nPor exemplo, para repetir mesma operação em todas filogenias de um conjunto de dados.","code":"\n# Vetores:\nx<-c(1,2,3,4,5)\nx<-1:5\nx\n#> [1] 1 2 3 4 5\nclass(x)\n#> [1] \"integer\"\nlength(x)\n#> [1] 5\n# A função which é útil para selecionar alguns dados de um vetor\nwhich(x>3)\n#> [1] 4 5\nwhich(x>=3)\n#> [1] 3 4 5\n# Fatores possuem níveis\nf<-c(\"Sp1\",\"Sp1\",\"Sp2\",\"Sp3\",\"Sp3\")\nf\n#> [1] \"Sp1\" \"Sp1\" \"Sp2\" \"Sp3\" \"Sp3\"\nf<-factor(f)\nf\n#> [1] Sp1 Sp1 Sp2 Sp3 Sp3\n#> Levels: Sp1 Sp2 Sp3\ntable(f)\n#> f\n#> Sp1 Sp2 Sp3 \n#>   2   1   2\nclass(f)\n#> [1] \"factor\"\nnames(x)=f\nx\n#> Sp1 Sp1 Sp2 Sp3 Sp3 \n#>   1   2   3   4   5\n# Matrizes\nm<-matrix(1:9,3,3) # dados, n-linhas, n-colunas\nm\n#>      [,1] [,2] [,3]\n#> [1,]    1    4    7\n#> [2,]    2    5    8\n#> [3,]    3    6    9\nclass(m)\n#> [1] \"matrix\" \"array\"\nm[,2] # a segunda coluna\n#> [1] 4 5 6\nm[3,] # a terceira linha\n#> [1] 3 6 9\n# Data frames suportam vários tipos de dados distintos\nd<-data.frame(f,x)\nd\n#>     f x\n#> 1 Sp1 1\n#> 2 Sp1 2\n#> 3 Sp2 3\n#> 4 Sp3 4\n#> 5 Sp3 5\nclass(d)\n#> [1] \"data.frame\"\n# Lista é uma estrutura geral que pode carregar vários tipos de dados, incluindo, por ex. árvores filogenéticas\nl<-list(f,x,m,d)\nl\n#> [[1]]\n#> [1] Sp1 Sp1 Sp2 Sp3 Sp3\n#> Levels: Sp1 Sp2 Sp3\n#> \n#> [[2]]\n#> Sp1 Sp1 Sp2 Sp3 Sp3 \n#>   1   2   3   4   5 \n#> \n#> [[3]]\n#>      [,1] [,2] [,3]\n#> [1,]    1    4    7\n#> [2,]    2    5    8\n#> [3,]    3    6    9\n#> \n#> [[4]]\n#>     f x\n#> 1 Sp1 1\n#> 2 Sp1 2\n#> 3 Sp2 3\n#> 4 Sp3 4\n#> 5 Sp3 5\nl[[4]] # quarto elemento da lista\n#>     f x\n#> 1 Sp1 1\n#> 2 Sp1 2\n#> 3 Sp2 3\n#> 4 Sp3 4\n#> 5 Sp3 5\nls()\n?mean\n#> démarrage du serveur d'aide httpd ... fini\n?matrix\n# For loop para calcular a média de atributos, ex: colunas de uma matriz\nX<-matrix(1:16,4,4)\nX\n#>      [,1] [,2] [,3] [,4]\n#> [1,]    1    5    9   13\n#> [2,]    2    6   10   14\n#> [3,]    3    7   11   15\n#> [4,]    4    8   12   16\n# vetor vazio para salvar os resultados\nmedias<-vector(mode=\"numeric\",length(ncol(X)))\nmedias\n#> [1] 0\n# loop\nfor(i in 1:ncol(X)){ \n medias[i]<-mean(X[,i])\n}\n# resultado\nmedias\n#> [1]  2.5  6.5 10.5 14.5"},{"path":"cap2.html","id":"pacotes-no-r","chapter":"Capítulo 2 Uma breve introdução ao R","heading":"2.5 Pacotes no R","text":"Os pacotes contêm compilados de funções que realizam tarefas sobre um determinado tema.\nEsses pacotes, criados por autores diversos, estão disponíveis para serem baixados e carregados R.\nOs pacotes são baixados uma única vez computador, porém, precisam ser carregados console R toda vez que se iniciar o R.","code":""},{"path":"cap2.html","id":"pacotes-para-morfometria-geométrica","chapter":"Capítulo 2 Uma breve introdução ao R","heading":"2.6 Pacotes para morfometria geométrica","text":"Um dos pacotes mais completos para morfometria geométrica é o geomorph.\nVamos instalar esse pacote e carregar R.\nOs pacotes podem ser instalados através de uma linha de comando ou clicando botão Install da aba Packages.O geomorph é constantemente atualizado.\nPor isso, é recomendável checar frequentemente por atualizações nas funções.\nCom o comando ??\nseguido nome pacote (??geomorph) é possível acessar um resumo pacote e de todas suas funções.","code":"\ninstall.packages(\"geomorph\")\nlibrary(geomorph)"},{"path":"cap2.html","id":"objetos-importantes-para-morfometria-geométrica","chapter":"Capítulo 2 Uma breve introdução ao R","heading":"2.7 Objetos importantes para morfometria geométrica","text":"Via de regra, dados obtidos via morfometria geométrica vão estar em um de 2 formatos R: como 3D array ou como matrix.\nformato array, análogo ao formato .tps, cada indivíduo aparece de maneira individualizada e sequencial dentro objeto; para cada indivíduo linhas correspondem aos landmarks e colunas às coordenadas x e y (e z se dados em 3D) de cada landmark.\nformato matrix todos os indivíduos aparecem de uma única vez na matriz; linhas correspondem aos indivíduos e colunas correspondem às coordenadas dos landmarks de maneira sequencial: coluna 1 corresponde ao landmark x1 de cada indivíduo (coordenada x landmark 1), coluna 2 = y1, coluna 3 = x2, coluna 4 = y2, coluna 5 = x3 etc.","code":"\n# Matrix \nm<-matrix(1:12,3,4) # dados, n-linhas, n-colunas \nm # 3 indivíduos, 2 landmarks com coordenadas x,y \n#>      [,1] [,2] [,3] [,4]\n#> [1,]    1    4    7   10\n#> [2,]    2    5    8   11\n#> [3,]    3    6    9   12\n# Array \nn<-array(m,c(4,2,3)) #dados, dimensões(p,k,n) (p=pontos,k=dimensões,n=amostra) \nn # 3 indivíduos, 2 landmarks com coordenadas x,y \n#> , , 1\n#> \n#>      [,1] [,2]\n#> [1,]    1    5\n#> [2,]    2    6\n#> [3,]    3    7\n#> [4,]    4    8\n#> \n#> , , 2\n#> \n#>      [,1] [,2]\n#> [1,]    9    1\n#> [2,]   10    2\n#> [3,]   11    3\n#> [4,]   12    4\n#> \n#> , , 3\n#> \n#>      [,1] [,2]\n#> [1,]    5    9\n#> [2,]    6   10\n#> [3,]    7   11\n#> [4,]    8   12\nn[,,1] # indivíduo número 1\n#>      [,1] [,2]\n#> [1,]    1    5\n#> [2,]    2    6\n#> [3,]    3    7\n#> [4,]    4    8"},{"path":"cap2.html","id":"pacotes-filogenéticos-no-r","chapter":"Capítulo 2 Uma breve introdução ao R","heading":"2.8 Pacotes filogenéticos no R","text":"Existem muitos pacote lidando com métodos filogenéticos R.\nAlguns que serão usados para manipular e representar graficamente árvores filogenéticas serão instalados abaixo.\nO pacote ape é o pacote central mais importante, já que propõe classe phylo, que é utilizada pela grande maioria dos demais pacotes.","code":"\n# Instalando pacotes: \ninstall.packages(\"ape\") \ninstall.packages(\"phytools\") \ninstall.packages(\"geiger\")"},{"path":"cap2.html","id":"o-objeto-phylo","chapter":"Capítulo 2 Uma breve introdução ao R","heading":"2.9 O objeto phylo","text":"Árvores filogenéticas são lidas R como um objeto list de classe phylo.Podemos representar árvore graficamente, bem como estudar sua estrutura.","code":"\n# Carregar ape \nrequire(ape) \n#> Le chargement a nécessité le package : ape\n# Construindo uma árvore newick via texto \ntexto<-\"(((((((vaca, cavalo),baleia),(morcego,(camundongo,humano))),(pardal,tartaruga)),celacanto),nemo),tubarão);\"\n# Função read.tree lê o arquivo contendo a árvore \narvore<-read.tree(text=texto)\n# Representando a árvore graficamente \nplot(arvore,edge.width=2) \n\n# Estrutura da árvore \narvore \n#> \n#> Phylogenetic tree with 11 tips and 10 internal nodes.\n#> \n#> Tip labels:\n#>   vaca, cavalo, baleia, morcego, camundongo, humano, ...\n#> \n#> Rooted; no branch lengths.\nstr(arvore) \n#> List of 3\n#>  $ edge     : int [1:20, 1:2] 12 13 14 15 16 17 18 18 17 16 ...\n#>  $ Nnode    : int 10\n#>  $ tip.label: chr [1:11] \"vaca\" \"cavalo\" \"baleia\" \"morcego\" ...\n#>  - attr(*, \"class\")= chr \"phylo\"\n#>  - attr(*, \"order\")= chr \"cladewise\"\n\n# Decompondo a árvore \nclass(arvore) \n#> [1] \"phylo\"\nplot(arvore) \ntiplabels() \nnodelabels() \n\n# ramos \narvore$edge # matriz contendo os índices do nó inicial e final para cada ramo \n#>       [,1] [,2]\n#>  [1,]   12   13\n#>  [2,]   13   14\n#>  [3,]   14   15\n#>  [4,]   15   16\n#>  [5,]   16   17\n#>  [6,]   17   18\n#>  [7,]   18    1\n#>  [8,]   18    2\n#>  [9,]   17    3\n#> [10,]   16   19\n#> [11,]   19    4\n#> [12,]   19   20\n#> [13,]   20    5\n#> [14,]   20    6\n#> [15,]   15   21\n#> [16,]   21    7\n#> [17,]   21    8\n#> [18,]   14    9\n#> [19,]   13   10\n#> [20,]   12   11\n# O número de linhas em tree$edge é igual o número de ramos; cada ramo começa e termina com um par de índices (nó-nó ou nó-terminal) \n\n# terminais \narvore$tip.label \n#>  [1] \"vaca\"       \"cavalo\"     \"baleia\"     \"morcego\"   \n#>  [5] \"camundongo\" \"humano\"     \"pardal\"     \"tartaruga\" \n#>  [9] \"celacanto\"  \"nemo\"       \"tubarão\"\n\n# nós \narvore$Nnode \n#> [1] 10\n\n# Um objeto \"phylo\" também pode conter o comprimento dos ramos: edge.length"},{"path":"cap2.html","id":"é-errando-que-se-aprende","chapter":"Capítulo 2 Uma breve introdução ao R","heading":"2.10 É eRrando que se aprende","text":"curva de aprendizado R é bastante íngreme início.\nQuando mensagens de erro começarem aparecer, é importante não se desesperar.\nTente ler e interpretar mensagens de erro.\nVolte ao código e o leia com calma etapa por etapa.\nProcure por erros comuns, como um nome de objeto errado, um espaço extra, uma vírgula mal colocada, etc.\nLembre-se que não estás aprendendo “mexer num programa”, estás aprendendo uma língua nova.","code":""},{"path":"cap3.html","id":"cap3","chapter":"Capítulo 3 Morfometria Geométrica","heading":"Capítulo 3 Morfometria Geométrica","text":"“Organismos são entidades integradas, e não coleções de objetos discretos” (gould1979?).visão “atomista” dos organismos, que trata medidas lineares únicas como merecedoras de atenção particular, está errada ponto de vista da genética e desenvolvimento. evolução morfológica é inerentemente multivarida. Por isso, precisamos usar ferramentas multivariadas para entender os processos biológicos que produzem morfologias distintas. morfometria fornece maneiras quantitativas de comparar forma dos organismos, obtidas partir uso de ferramentas matemáticas sobre matrizes de variáveis contínuas. Assim, morfometria multivariada é melhor maneira de entender morfogênese e evolução morfológica.Contudo, morfometria tradicional não oferece uma maneira precisa para acessar geometria dos organismos, já que carece de uma definição precisa de forma e, assim, não distingue claramente forma e tamanho. Além disso, morfometria tradicional não oferece maneiras de visualizar e interpretar com facilidade diferenças morfológicas que estamos tentando entender.Ferramentas de morfometria geométrica oferecem uma descrição precisa e acurada da forma (geometria) dos organismos, podem ser combinadas com análises estatísticas rigorosas, e nos permitem visualizar diferenças de forma entre organismos com extrema facilidade, o que não é alcançado facilmente por outros métodos (zelditch2012?).Forma, em morfometria geométrica, é formamente definida como todas características geométricas de uma configuração de pontos exceto por seu tamanho, posição e orientação (kendall?; bookstein1989?; dryden1998?; monteiro1999?; klingenberg2016?). Essa formalidade é capturada matematicamente pela técnica conhecida como Análise Generalizada de Procrustes, que veremos na sequência. Assim, morfometria geométrica faz uma distinção entre tamanho e forma. Tamanho pode ser resumido em um número que captura dimensão ou escala geral de um objeto (klingenberg2016?) - veja seção manual sobre Tamanho Centróide. Forma captura diferentes proporções de um objeto: formas de dois objetos podem ser iguais se forem geométricamente idênticas, mesmo que seu tamanho seja diferente (zelditch2012?; klingenberg2016?).Os landmarks, ou marcos anatômicos, são pontos anatômicos discretos, fudamentais em morfometria, que precisam ser reconhecíveis em todos os indivíduos/objetos da amostra. definição dos landmarks é central, já que eles permitirão capturar estruturas biológicas de interesse (entre os landmarks) e comparar essas estruturas entre organismos. Daí importância de os landmarks serem homólogos entre os indivíduos estudo. Em morfometria geométrica, coordenadas cartesianas desses landmarks é que serão usadas nas análises. Há uma outra vantagem da morfometria geométrica que resulta uso dessas coordenadas cartesianas ao invés uso de medidas lineares entre landmarks. análise das variáveis de forma, obtidas por morfometria geométrica, sobre determinado número N de landmarks, contém tanta informação de forma quanto teriam todas medidas lineares entre os N pares de landmarks, e com um número muito menor de variáveis de forma, removendo redundância que existiria na matriz de medidas lineares entre os N landmarks.Além dos landmarks, também podem ser utilizados semilandmarks ou análises de contorno quando estrutura biológica muito complexa para ser inteiramente capturada por landmarks e/ou quando landmarks não puderem ser localizados com confiabilidade. Veja seção sobre semilandmarks.Para livros abrangentes sobre morfometria geométrica, veja: (monteiro1999?) e (zelditch2012?).","code":""},{"path":"digitalização-de-landmarks.html","id":"digitalização-de-landmarks","chapter":"Capítulo 4 Digitalização de landmarks","heading":"Capítulo 4 Digitalização de landmarks","text":"","code":""},{"path":"digitalização-de-landmarks.html","id":"criação-de-arquivo-.tps-com-as-imagens-bi-dimensionais","chapter":"Capítulo 4 Digitalização de landmarks","heading":"4.1 Criação de arquivo .tps com as imagens bi-dimensionais","text":"Esse roteiro é para manipulação de imagens digitais (2D) e digitalização de marcos anatômicos (landmarks) nas imagens usando softwares TPS. imagens, previamente capturadas de maneira padronizada, devem estar individualizadas, todas em uma mesma pasta computador.TPSUtil, selecione operação ‘Build tps file images’. Clique em ‘Input’ e selecione pasta (selecione qualquer imagem dentro da pasta) contendo fotos. nosso caso, pasta se chama ‘Atividade 1 – Imagens’. Clique em ‘Output’ e atribua um nome para o arquivo (use mandibula.tps). Clique em ‘Setup’. Todas imagens da pasta estarão listadas. É possível conferir os nomes dos arquivos e modificar ordem ou deletar imagens se necessário. Clique em ‘Create’ para criar o arquivo .tps com lista de imagens. Vá até o mesmo diretório (pasta) com imagens e verifique o arquivo mandibula.tps (abra com o bloco de notas).","code":""},{"path":"digitalização-de-landmarks.html","id":"digitalização-de-landmarks-no-tpsdig2","chapter":"Capítulo 4 Digitalização de landmarks","heading":"4.2 Digitalização de landmarks no TPSDig2","text":"TPSDig2, para carregar imagens clique em ‘File>Input source>File’. Selecione o arquivo .tps contendo lista de imagens, nosso caso ‘mandibula.tps’. Após clicar em ‘Abrir’, primeira foto arquivo será exibida. setas vermelhas na barra de ferramentas permitem navegar pelas fotos, que serão exibidas uma por vez. barra de ferramentas também permite ajustar o zoom das imagens, e inúmeras outras configurações de nitidez da imagem e cores/tamanho dos landmarks.Um passo importante é definir escala da imagem. Para isso, clique em ‘Options>Image tools’. Na aba ‘Measure’ defina o comprimento de referência e unidade que desejar para o comprimento. Clique em ‘Set scale’, minimize aba de ferramentas, vá até escala de referência na imagem (nosso caso, o papel milimetrado) e defina, com dois pontos (cliques), o mesmo comprimento atribuído na barra de ferramentas. Volte para aba ‘Measure’ e clique em ‘Ok’. calibração estará definida para esta imagem (o fator de escala será o valor de referência dividido pelo número de pixels necessários para obter referência). Futuros valores de tamanho centroide para esta imagem estarão na unidade definida como referência (e.g., cm, mm, etc.). O procedimento precisa ser repetido para cada imagem.Para digitalizar os landmarks, .e., atribuir uma coodenada x,y para cada um, selecione ferramenta ‘Digitize landmarks’ menu ‘Modes’ ou clicando na figura com o formato de alvo na barra de ferramentas. Atribua os landmarks clicando na imagem, na posição desejada. Os landmarks vão aparecer em sequência numérica partir 1, e em todas imagens sequência de digitalização dos landmarks (ordem) deve ser mesma (e.g., o landmark 8 estará na mesma posição anatômica em todas imagens).Após o término da digitalização clique em ‘File>Save data’ e salve os dados. É extremamente recomendável repetir o salvamento após digitalização de cada imagem; use o mesmo nome e clique em ‘Overwrite’ para que os dados atualizados sejam gravados sobre os antigos, gerando um único arquivo ao final. Vá até pasta de trabalho e visualize o arquivo abrindo-o com o bloco de notas.\nFigura 4.1: Landmarks na mandibula de um roedor sigmodontíneo.\nDescrição dos landmarks:\nL1: Borda anterior alvéolo incisivo; L2: Extremo anterior superior da borda alvéolo incisive; L3: Posição de maior inflexão diastema; L4: Borda anterior álveolo primeiro molar; L5: Interseção entre linha de molars e o processo coronóide em vista lateral; L6: Ponta processo coronóide; L7: Ponto de máxima curvatura entre o processo coronóide e o condilar; L8: Margem dorsal da borda anterior da supercífie articular processo condilar; L9: Borda ventral da superfície articular processo condilar; L10: Ponto de máxima curvatura entre o processo condilar e o angular; L11: Ponta processo angular; L12: Interseção entre o corpo da mandíbula e crista massetérica; L13: Limite ventral da sínfise mandibular.","code":""},{"path":"digitalização-de-landmarks.html","id":"digitalização-de-landmarks-em-3d","chapter":"Capítulo 4 Digitalização de landmarks","heading":"4.3 Digitalização de landmarks em 3D","text":"O software MeshLab permite digitalização de landmarks em superfícies, além de outras operações. Após abrir o software, selecione ‘File>Import Mesh’ e carregue o arquivo chamado ‘exemplo3d.ply’ de dentro da pasta ‘R Dados’.Para digitalizar landmarks na superfície clique em ‘Edit>PickPoints’ ou ícone PP. Ao clicar com o botão esquerdo mouse (pode demorar um pouco), coordenadas são capturadas. Após o término da digitalização é possível salvar um arquivo em formato xml (.pp) com coordenadas em 3D, que poderá ser aberto R para análises posteriores.","code":""},{"path":"análise-de-procrustes.html","id":"análise-de-procrustes","chapter":"Capítulo 5 Análise de Procrustes","heading":"Capítulo 5 Análise de Procrustes","text":"O passo primário fundamental em morfometria geométrica é Análise Generalizada de Procrustes (GPA - Generalized Procrustes Analysis), que remove os efeitos de rotação/orientação, translação/posição e tamanho dos objetos. O resultado é uma matriz com variáveis de forma. Outros métodos de superposição de marcos anatômicos foram propostos, para revisões, veja (monteiro1999?); (adams2004?); (zelditch2012?), mas GPA é o mais popular e mais adequado na maioria dos casos.Na GPA, os efeitos de translação/posição são removidos pois () o centróide de cada configuração é transladado para origem: coordenadas centróide de cada configuração são subtraídas da coordenada correspondente de cada landmark, gerando centralização ou superposição das configurações. Os efeitos de tamanho são removidos pois (ii) configurações são escaladas/proporcionalizadas para um tamanho de centróide único após divisão das coordenadas dos landmarks pelo seu tamanho centróide. E os efeitos de rotação/orientação são removidos pois (iii) raiz quadrada da soma das distâncias ao quadrado entre os landmarks correspondentes é minimizada usando rotação otimizada por quadrados mínimos; o processo inicia rotacionando configurações em relação à uma forma de referência, em seguida, uma nova forma de referência (média da configuração de landmarks) é calculada, e o processo se repete iterativamente até que diferenças de orientação sejam minimizadas.Em duas dimensões, dois graus de liberdade são perdidos com translação, um grau de liberdade é perdido com o escalonamento e um grau de liberdade é perdido com rotação, totalizando quatro graus de liberdade perdidos. Em três dimensões, três graus de liberdade são perdidos com translação, um grau de liberdade é perdido com o escalonamento, e três graus de liberdade são perdidos com rotação, totalizando sete graus de liberdade perdidos.","code":""},{"path":"análise-de-procrustes.html","id":"o-objeto-.tps-no-r","chapter":"Capítulo 5 Análise de Procrustes","heading":"5.1 O objeto .tps no R","text":"O arquivo .tps criado TPSDig2 pode ser lido R com função readland.tps pacote geomorph. Antes, lembre-se de colocar o arquivo .tps na pasta dadosmg e definir essa pasta como diretório de trabalho R.Podemos visualizar os dados brutos com função plotAllSpecimens.Os círculos maiores representam posição média landmark, e os círculos menores representam posição de cada landmark.Use indexação com [] para localizar certos landmarks ou indivíduos. Por exemplo.","code":"\n# Carregar geomorph \nrequire(geomorph) \n#> Le chargement a nécessité le package : geomorph\n#> Warning: le package 'geomorph' a été compilé avec la\n#> version R 4.3.2\n#> Le chargement a nécessité le package : RRPP\n#> Warning: le package 'RRPP' a été compilé avec la version R\n#> 4.3.2\n#> Le chargement a nécessité le package : rgl\n#> Le chargement a nécessité le package : Matrix\n# Importar arquivo .tps \n# lembre-se de substituir por \"nomequevocêdeu.tps\"\ntps<-readland.tps(\"dadosmg/mandibula.dig_curso.tps\",specID = \"ID\", readcurves = FALSE) \ndim(tps) \ntps\nplotAllSpecimens(tps)\n# Deletar espécimes\ntps.new<-tps[,,-7] # deleta espécime n 7\n# Deletar landmarks\ntps.new<-tps[-5,,] # deleta landmark n 5"},{"path":"análise-de-procrustes.html","id":"estimar-landmarks-faltantes","chapter":"Capítulo 5 Análise de Procrustes","heading":"5.2 Estimar landmarks faltantes","text":"função estimate.missing pacote geomorph implementa dois métodos para estimar landmarks faltantes.","code":"\ntps.missing<-readland.tps(\"dadosmg/mandibula.dig_curso_missing.tps\",specID=\"ID\",readcurves=FALSE)\ntps.missing\ntps.estimated<-estimate.missing(tps.missing, method = \"TPS\")\ntps.estimated\n\nwriteland.tps(tps.estimated, \"dadosmg/tps.estimated.tps\") # exportar arquivo tps com landmarks estimados"},{"path":"análise-de-procrustes.html","id":"análise-generalizada-de-procrustes","chapter":"Capítulo 5 Análise de Procrustes","heading":"5.3 Análise Generalizada de Procrustes","text":"Aqui, faremos análise de Procrustes (GPA) em dados sem simetria de objeto e atribuiremos nomes para os outputs de forma e tamanho centróide.Podemos visualizar distribuição dos dados de tamanho e forma. Note diferença gráfico da forma antes e depois da análise de Procrustes.","code":"gpa.object<-gpagen(tps)\n#> \n#> Performing GPA\n#> \n  |                                                        \n  |                                                  |   0%\n  |                                                        \n  |============                                      |  25%\n  |                                                        \n  |=========================                         |  50%\n  |                                                        \n  |==================================================| 100%\n#> \n#> Making projections... Finished!\ngpa.object\n#> \n#> Call:\n#> gpagen(A = tps) \n#> \n#> \n#> \n#> Generalized Procrustes Analysis\n#> with Partial Procrustes Superimposition\n#> \n#> 13 fixed landmarks\n#> 0 semilandmarks (sliders)\n#> 2-dimensional landmarks\n#> 2 GPA iterations to converge\n#> \n#> \n#> Consensus (mean) Configuration\n#> \n#>                X           Y\n#> 1  -0.3600904084 -0.03209176\n#> 2  -0.3838537500  0.08920190\n#> 3  -0.2678074781  0.01674324\n#> 4  -0.2101661423  0.05684845\n#> 5  -0.0001796958  0.03565707\n#> 6   0.1873051760  0.14767796\n#> 7   0.1660719417  0.08697077\n#> 8   0.2984433258  0.09285954\n#> 9   0.3486394512  0.01069463\n#> 10  0.2335846883 -0.07886796\n#> 11  0.2889938410 -0.17663723\n#> 12 -0.0281091968 -0.13445727\n#> 13 -0.2728317526 -0.11459935\nshape<-gpa.object$coords\nsize<-gpa.object$Csize\nhist(size)\nplotAllSpecimens(shape)"},{"path":"análise-de-procrustes.html","id":"espaço-tangente","chapter":"Capítulo 5 Análise de Procrustes","heading":"5.4 Espaço tangente","text":"correlação espaço de forma com o espaço tangente quase sempre será muito alta em dados de morfometria geométrica, justificando o uso de estatística Euclidiana.","code":"\nrequire(Morpho)\n#> Warning: le package 'Morpho' a été compilé avec la version\n#> R 4.3.2\nregdist(shape)#> $cor\n#> [1] 0.9999991\n#> \n#> $procSS\n#> [1] 0.1789463\n#> \n#> $tanSS\n#> [1] 0.1788539\n#> \n#> $rhoSS\n#> [1] 0.1791391"},{"path":"análise-de-procrustes.html","id":"formato-array-e-matrix","chapter":"Capítulo 5 Análise de Procrustes","heading":"5.5 Formato array e matrix","text":"Os dados de forma estão em formato array. Podemos nos mover facilmente entre os formatos array e matrix. Ambos carregam mesma informação, mas algumas análises/operações só aceitam um dos dois formatos.","code":""},{"path":"análise-de-procrustes.html","id":"gpa-com-simetria-de-objeto","chapter":"Capítulo 5 Análise de Procrustes","heading":"5.6 GPA com simetria de objeto","text":"Quando os dados tiverem simetria e objeto, vamos informar isso ao R com uma matriz contendo os pares de landmarks simétricos e realizar uma GPA considerando simetria.","code":"\n# Carregar dados\ntps.sim<-readland.tps(\"dadosmg/Lista tuco dig 2.tps\",specID = \"ID\", readcurves = FALSE)\ndim(tps.sim)\n# Matriz com landmarks simétricos\npairs.matrix<-matrix(c(2,3,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,28),nrow=12,ncol=2,byrow=T)\npairs.matrix\n# Construir vetor com rótulo de indivíduos (neste caso, uma marcação por indivíduo)\nind<-c(1:dim(tps.sim)[3])\n# GPA com simetria bilateral\nb.s<-bilat.symmetry(tps.sim,ind=ind,object.sym=TRUE,land.pairs=pairs.matrix)\n\nshape.sym<-b.s$symm.shape # componente simétrico da forma\nplotAllSpecimens(shape.sym)"},{"path":"análise-de-procrustes.html","id":"encontrando-outliers","chapter":"Capítulo 5 Análise de Procrustes","heading":"5.7 Encontrando outliers","text":"Podemos encontrar indivíduos muito diferentes dos demais observando sua distância em relação à forma média da amostra. Em morfometria geométrica, é comum marcação de landmarks trocados em alguns indivíduos, o que vai gerar óbvios outliers.","code":"\nplotOutliers(shape)"},{"path":"visualização-da-forma.html","id":"visualização-da-forma","chapter":"Capítulo 6 Visualização da forma","heading":"Capítulo 6 Visualização da forma","text":"Existem várias maneiras de visualizar mudanças de forma com dados de Morfometria Geométrica (ver (klingenberg2013?)). Aliás, essa é uma das vantagens da morfometria geométrica em comparação com morfometria tradicional. formas mais comuns de visualização são por grids de deformação, vetores (ou lollipops), e através da construção de links entre os landmarks e extrapolação da forma via outlines e surfaces. Em qualquer caso, é importante perceber que diferença de forma está contida apenas entre os landmarks/semilandmarks; extrapolações de forma além dos landmarks (via grids e outlines, por exemplo) podem ser úteis para visualização, mas devem ser interpretadas com bastante cautela. É também importante perceber que interpretação das mudanças de forma não deve considerar os landmarks individualmente, mas sim sua mudança relativa todos os outros landmarks.Construção de forma média da amostra para comparação.Construção de links entre os landmarks.Os links entre os landmarks também podem ser definidos interativamente com função define.links pacote geomorph.","code":"\nref<-mshape(shape)\nlinks<-matrix(c(1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,1),nrow=13,ncol=2,byrow=T)\nplotAllSpecimens(shape,mean=TRUE,links=links)"},{"path":"visualização-da-forma.html","id":"método-de-grid-de-deformação.","chapter":"Capítulo 6 Visualização da forma","heading":"6.1 Método de grid de deformação.","text":"","code":"\n# Definir cor dos landmarks e links\nGP1<-gridPar(pt.bg=\"gray\",link.col=\"gray\",link.lty=1) # cor dos landmarks e links\n# Gráfico de mudança de forma\nplotRefToTarget(ref,shape[,,8],links=links,method=\"TPS\")"},{"path":"visualização-da-forma.html","id":"método-de-vetores.","chapter":"Capítulo 6 Visualização da forma","heading":"6.2 Método de vetores.","text":"","code":"\nplotRefToTarget(ref,shape[,,8],links=links,method=\"vector\")"},{"path":"visualização-da-forma.html","id":"método-de-linhas.","chapter":"Capítulo 6 Visualização da forma","heading":"6.3 Método de linhas.","text":"Aqui, o alvo está em preto e referência(média) está em cinza.","code":"\nplotRefToTarget(ref,shape[,,8],links=links,method=\"points\",gridPars=GP1)"},{"path":"visualização-da-forma.html","id":"método-de-outlines.","chapter":"Capítulo 6 Visualização da forma","heading":"6.4 Método de outlines.","text":"Com um número suficiente de pontos, dá-se impressão de um desenho. Veja o exemplo pacote geomorph.","code":"\n# Carregando outline\noutline<-warpRefOutline(\"dadosmg/outline.mandibula.R.tps\", tps[,,11], ref)\n# Gráfico de mudança de forma\nGP1<-gridPar(pt.bg=\"gray\",tar.out.col = \"red\",tar.out.cex = 0.5)\nplotRefToTarget(ref,shape[,,8],outline=outline$outline,method=\"TPS\")\nplotRefToTarget(ref,shape[,,8],outline=outline$outline,method=\"points\",gridPars=GP1)\ndata(\"plethodon\") \nY.gpa<-gpagen(plethodon$land, print.progress = FALSE) \nref.y<-mshape(Y.gpa$coords) \nGP4<- gridPar(tar.out.col = \"red\", tar.out.cex = 0.3)\nplotRefToTarget(ref.y,Y.gpa$coords[,,39], gridPars=GP4, mag=3, outline=plethodon$outline, method=\"TPS\")"},{"path":"visualização-da-forma.html","id":"magnificação-da-forma","chapter":"Capítulo 6 Visualização da forma","heading":"6.5 Magnificação da forma","text":"Às vezes quando diferenças de forma são muito sútis, podemos aumentar diferenças para visualizar melhor. Use com cuidado.","code":"\nplotRefToTarget(ref,shape[,,8],outline=outline$outline, method=\"points\",gridPars=GP1,mag=3)"},{"path":"assimetria-e-quantificação-de-erro.html","id":"assimetria-e-quantificação-de-erro","chapter":"Capítulo 7 Assimetria e quantificação de erro","heading":"Capítulo 7 Assimetria e quantificação de erro","text":"Duas fontes de adicionais de variação, normalmente bem pequenas, podem ser quantificadas: assimetria e os erros oridundos da obtenção de dados e da medição de indivíduos. assimetria é o menor dos efeitos biológicos, e pode ser quantificada através da diferença entre os lados direito e esquerdo de estruturas com simetria bilateral, ou entre estruturas correspondentes em outras formas de simetria, como em asas de insetos ou pétalas de flores. Erros oriundos da obtenção de dados ou de medição dos espécimes (colocação de landmarks) devem também ser muito pequenos para que possam ser ignorados com confiança. Espera-se que esses erros sejam várias vezes menores que variação entre indivíduos, e mesmo que sejam bastante menores que variação vinda da assimetria flutuante.Para se aprofundar, leia: (klingenberg2002?); (klingenberg2015?).","code":""},{"path":"assimetria-e-quantificação-de-erro.html","id":"assimetria-de-objeto","chapter":"Capítulo 7 Assimetria e quantificação de erro","heading":"7.1 Assimetria de objeto","text":"Estruturas biológicas com assimetria de objeto, por exemplo, os lados direito e esquerdo crânio.","code":"\n# Carregar dados com landmarks no crânio de tuco-tucos\nrequire(geomorph)\n#> Le chargement a nécessité le package : geomorph\n#> Le chargement a nécessité le package : RRPP\n#> Le chargement a nécessité le package : rgl\n#> Le chargement a nécessité le package : Matrix\ntps.sim<-readland.tps(\"dadosmg/Lista tuco dig 2.tps\",specID = \"ID\", readcurves = FALSE)\ndim(tps.sim)\n# Matriz com landmarks simétricos\npairs.matrix<-matrix(c(2,3,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,28),nrow=12,ncol=2,byrow=T)\npairs.matrix\n# Construir vetor com rótulo de indivíduos (neste caso, uma marcação por indivíduo)\nind<-c(1:dim(tps.sim)[3])\n# GPA com simetria bilateral\nb.s<-bilat.symmetry(tps.sim,ind=ind,object.sym=TRUE,land.pairs=pairs.matrix)\n\n# Componente assimétrico da forma\nshape.asym<-b.s$asymm.shape\nplotAllSpecimens(shape.asym)"},{"path":"assimetria-e-quantificação-de-erro.html","id":"assimetria-de-correspondência","chapter":"Capítulo 7 Assimetria e quantificação de erro","heading":"7.2 Assimetria de correspondência","text":"Estruturas biológicas com simetria de correspondência, por exemplo, asas de insetos.","code":"\n# Carregar arquivo com landmarks em asas de *Drosophila*\nfly<-read.table(\"dadosmg/fly wing replicates Proc.txt\",h=T,row.names = 1)\nhead(fly)\n# Transformar coordenadas em array\nfly.tps<-arrayspecs(fly[,5:34],15,2) \nfly.tps \nplotAllSpecimens(fly.tps)\n# Vetor com os indivíduos da amostra\nfly.ind<-fly$fly \nfly.ind\n# Vetor informando quais estruturas são asas do lado direito ou do esquerdo\nfly.side<-fly$side \nfly.side\n# GPA com simetria de correspondência\nfly.b.s<-bilat.symmetry(fly.tps,ind=fly.ind,side=fly.side)\n# Componente simétrico da forma\nplotAllSpecimens(fly.b.s$symm.shape) \n# Componente assimétrico da forma\nplotAllSpecimens(fly.b.s$asymm.shape)"},{"path":"assimetria-e-quantificação-de-erro.html","id":"assimetria-direcional","chapter":"Capítulo 7 Assimetria e quantificação de erro","heading":"7.3 Assimetria direcional","text":"forma média dos lados direito e esquerdo.","code":"\nfly.b.s$DA.component"},{"path":"assimetria-e-quantificação-de-erro.html","id":"assimetria-flutuante","chapter":"Capítulo 7 Assimetria e quantificação de erro","heading":"7.4 Assimetria flutuante","text":"O desvio específico de cada espécime e índices quantificando o desvio esperado da simetria.","code":"\nfly.b.s$FA.component\nfly.b.s$signed.AI"},{"path":"assimetria-e-quantificação-de-erro.html","id":"quantificação-de-erro","chapter":"Capítulo 7 Assimetria e quantificação de erro","heading":"7.5 Quantificação de erro","text":"“Procrustes ANOVA” (Goodall 1991; Klingengerg & McIntyre 1998), usada para quantificar diversas fontes de erro em morfometria geométrica, é uma análise multivariada de variância onde fontes de erro são aninhadas uma dentro da outra. Por exemplo, podemos ter os lados direito/esquerdo de cada indivíduo, mais de uma marcação de landmarks para cada indivíduo, e mais de uma obtenção de imagem para cada indivíduo. quantificação de variação em cada nível pode ser feita e comparada. exemplo abaixo, vamos quantificar o erro de medição através de marcações de landmarks repetidas duas vezes em cada indivíduo da amostra. Queremos obter uma medida que represente confiabilidade da marcação de landmarks por um operador, obtida através da repetição da colocação de landmarks em imagens idênticas, por esse operador; em teoria, os landmarks deveriam estar extamente na mesma posição.tabela de variância informa quanta variação está contida entre réplicas de um mesmo indivíduo marcados duas vezes (ind:side:replicate).O erro de medição é pelo menos duas vezes menor que assimetria flutuante.Podemos também calcular um valor de confiança da repetibilidade","code":"\n# Carregar arquivo tps com todos os indivíduos marcados 2 vezes\ntps.rep<-readland.tps(\"dadosmg/ventral.dig_curso_rep1_2.tps\",specID = \"ID\", readcurves = FALSE) \ndim(tps.rep)\n# Matriz com os pares de landmarks simétricos\npairs.matrix.rep<-matrix(c(2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,24,22,28,23,29,19,25,20,26,21,27,30,31,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,55,56),nrow=26,ncol=2,byrow=T) \npairs.matrix.rep\n# Extração dos rótulos de indivíduos e repetições a partir do ID\ncategories<-strsplit(dimnames(tps.rep)[[3]], \"_\") # separa os nomes pelo underline\nclassifiers<-matrix(unlist(categories),ncol=5,byrow=T) # transforma em matriz\nclassifiers<-cbind(dimnames(tps.rep)[[3]],classifiers) # adiciona o ID na primeira coluna\ncolnames(classifiers)<-c(\"FileID\",\"Species\",\"Sex\",\"View\",\"Ind\",\"Rep\") # renomeia as colunas\nclassifiers<-as.data.frame(classifiers)\n# Indivíduos\nind.rep<-classifiers$Ind # indivíduos\n# Repetições\nrep.rep<-classifiers$Rep # repetições\n\n# Procrustes ANOVA - erro de medição\nb.s.error<-bilat.symmetry(tps.rep,ind=ind.rep,replicate=rep.rep,object.sym=TRUE,land.pairs=pairs.matrix.rep)\nb.s.error$shape.anova\n#>                     Df      SS        MS     Rsq       F\n#> ind                 39 0.34535 0.0088550 0.92935 30.8480\n#> side                 1 0.00466 0.0046638 0.01255 16.2470\n#> ind:side            39 0.01120 0.0002871 0.03013  2.2096\n#> ind:side:replicate  80 0.01039 0.0001299 0.02797        \n#> Total              159 0.37160                          \n#>                          Z Pr(>F)   \n#> ind                 6.8520  0.001 **\n#> side                5.2769  0.001 **\n#> ind:side           13.2872  0.001 **\n#> ind:side:replicate                  \n#> Total                               \n#> ---\n#> Signif. codes:  \n#> 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nR1<-(((b.s.error$shape.anova$MS[1]-b.s.error$shape.anova$MS[4])/2) / ((b.s.error$shape.anova$MS[4]+((b.s.error$shape.anova$MS[1]-b.s.error$shape.anova$MS[4])/2)))) \nR1\n#> [1] 0.9710822"},{"path":"assimetria-e-quantificação-de-erro.html","id":"exercício---erro-e-assimetria","chapter":"Capítulo 7 Assimetria e quantificação de erro","heading":"7.6 Exercício - Erro e Assimetria","text":"Usando os dados de asas de Drosophila já carregados (arquivo “fly wing replicates Proc.txt”) construa um modelo incluindo, além dos lados direto e esquerdo (assimetria) e da repetição das fotos entre indivíduos, também o fator imagem (3° coluna dos dados), que representa repetição da captura de fotos, .e. fotos diferentes mesmo indivíduo. Uma maneira equivalente de representar Procrustes ANOVA [bilat.symmetry(fly.tps,ind=fly.ind,side=fly.side,replicate=fly.rep] com modelos lineares em linguagem geomoph é usando procD.lm: procD.lm(fly.gpa$coords~fly.ind/fly.side+fly.side/fly.ind). Note que não é necessário usar o fator repetição explicitamente, uma vez que ele está dentro de indivíduos (compare os resíduos da primeira e da segunda função).","code":""},{"path":"semilandmarks.html","id":"semilandmarks","chapter":"Capítulo 8 Semilandmarks","heading":"Capítulo 8 Semilandmarks","text":"","code":""},{"path":"semilandmarks.html","id":"digitalização-de-semilandmarks","chapter":"Capítulo 8 Semilandmarks","heading":"8.1 Digitalização de semilandmarks","text":"TPSDig2, abra o arquivo ‘mandibula.tps’ com coordenadas dos landmarks. Para incluir semilandmarks será usada ferramenta Draw background curves, que se localiza em ‘Modes>Draw curves’ ou ícone parecido com uma caneta amarela. Cliques com o botão esquerdo mouse atribuem coordenadas para os semilandmarks, um por vez, e os conectam por uma linha azul. Para finalizar marcação dos semilandmarks na curva desejada basta clicar com o botão direito. O mesmo botão pode ser usado para clicar sobre curva e acessar o menu opções, onde é possível, por exemplo, ajustar distâncias entre os semilandmarks e deixá-las igualmente espaçadas. Ao terminar, salve o arquivo normalmente e abra em um bloco de notas. Note que coordenadas dos semilandmarks aparecem como pontos em curvas. Neste formato, o arquivo está pronto para ser carregado pelo geomorph R.\nPara abrir o arquivo em outros programas (ex: MorphoJ) é preciso primeiro fazer o deslizamento dos semilandmarks (‘sliding’) ao longo das curvas. Para isso é preciso: TPSUtil, () transformar os pontos em curva em semilandmarks verdadeiros (operação ‘Append tps Curve landmarks’), (ii) informar quais pontos correspondem semilandmarks em quais curvas (operação ‘Make sliders file’), e TPSRelw, (iii) importar o arquivo contendo todas coordenadas juntas (criado em ()) e o arquivo slider (criado em (ii)), realizar GPA com os semilandmarks e exportar o arquivo com coordenadas alinhadas; esse último arquivo pode ser aberto em qualquer programa. Note que o método para deslizamento dos semilandmarks TPSRelw pode ser modificado em ‘Options>Slide Method’.","code":""},{"path":"semilandmarks.html","id":"semilandmarks-no-r","chapter":"Capítulo 8 Semilandmarks","heading":"8.2 Semilandmarks no R","text":"Dados com semilandmarks podem ser carregados diretamente para o R com coordenadas em formato de curva.Note que os semilanmarks foram carregados como se fossem landmarks verdadeiros.\nPrecisamos informar quais deles são semilandmarks e em quais curvas vão deslizar.\nIsso pode ser feito em arquivo texto (veja o formato de curves.slide.txt), pelo programa TPSUtil, ou com uma função interativa pacote geomorph chamada define.sliders.Os semilandmarks formam coluna meio. Cada curva é colocada entre landmarks verdadeiros.","code":"\nrequire(geomorph)\n#> Le chargement a nécessité le package : geomorph\n#> Warning: le package 'geomorph' a été compilé avec la\n#> version R 4.3.2\n#> Le chargement a nécessité le package : RRPP\n#> Warning: le package 'RRPP' a été compilé avec la version R\n#> 4.3.2\n#> Le chargement a nécessité le package : rgl\n#> Le chargement a nécessité le package : Matrix\n# Carregar dados usando readcurves = TRUE\ntps.semi<-readland.tps(\"dadosmg/mandibula.dig_curso.tps\",specID = \"ID\", readcurves = TRUE)\ntps.semi\ndim(tps.semi)\n# Definir semilandmarks\ncurveslide<-read.table(\"dadosmg/curves.slide.txt\",h=T) # importa sliders definidos no TPS util \ncurveslide<-as.matrix(curveslide) \ncurveslide\n#>       before slide after\n#>  [1,]      2    14    15\n#>  [2,]     14    15    16\n#>  [3,]     15    16    17\n#>  [4,]      3    17    16\n#>  [5,]      3    18    19\n#>  [6,]     18    19    20\n#>  [7,]      4    20    19\n#>  [8,]      5    21    22\n#>  [9,]     21    22    23\n#> [10,]     22    23    24\n#> [11,]     23    24    25\n#> [12,]     24    25    26\n#> [13,]      6    26    25\n#> [14,]      6    27    28\n#> [15,]     27    28    29\n#> [16,]      7    29    28\n#> [17,]      7    30    31\n#> [18,]     30    31    32\n#> [19,]     31    32    33\n#> [20,]      8    33    32\n#> [21,]      8    34    35\n#> [22,]     34    35    36\n#> [23,]      9    36    35\n#> [24,]      9    37    38\n#> [25,]     37    38    39\n#> [26,]     38    39    40\n#> [27,]     10    40    39\n#> [28,]     10    41    42\n#> [29,]     41    42    43\n#> [30,]     42    43    44\n#> [31,]     11    44    43\n#> [32,]     11    45    46\n#> [33,]     45    46    47\n#> [34,]     47    48    49\n#> [35,]     46    47    48\n#> [36,]     48    49    50\n#> [37,]     49    50    51\n#> [38,]     50    51    52\n#> [39,]     51    52    53\n#> [40,]     52    53    54\n#> [41,]     12    54    53\n#> [42,]     12    55    56\n#> [43,]     55    56    57\n#> [44,]     56    57    58\n#> [45,]     57    58    59\n#> [46,]     58    59    60\n#> [47,]     13    60    59"},{"path":"semilandmarks.html","id":"métodos-de-deslizamento-de-semilandmarks","chapter":"Capítulo 8 Semilandmarks","heading":"8.3 Métodos de deslizamento de semilandmarks","text":"Agora podemos realizar uma análise de Procrustes deslizando os semilandmarks.\nopção/argumento “ProcD=FALSE” vai deslizar os semilandmarks minimizando energia de deformação, e opção/argumento “ProcD=TRUE” vai deslizar os semilandmarks minizando distâncias de Procrustes.Compare os dois métodos.","code":"\n# Deslizamento por Procrustes\ngpa.semi<-gpagen(tps.semi,ProcD=TRUE,curves=curveslide)\nshape.procD<-gpa.semi$coords\nplotAllSpecimens(shape.procD)\n\n# Deslizamento por Bending Energy\ngpa.semi<-gpagen(tps.semi,ProcD=FALSE,curves=curveslide)\nshape.bend<-gpa.semi$coords\nplotAllSpecimens(shape.bend)\npar(mfrow=c(1,2))\nplotAllSpecimens(shape.procD)\nplotAllSpecimens(shape.bend)\npar(mfrow=c(1,1))"},{"path":"tamanho-do-centróide.html","id":"tamanho-do-centróide","chapter":"Capítulo 9 Tamanho do Centróide","heading":"Capítulo 9 Tamanho do Centróide","text":"Em morfometria geométrica, o tamanho centróide é uma medida de tamanho global da estrutura (configuração de landmarks). Ela é obtida como raiz quadrada da soma das distâncias ao quadrado de cada landmark até o centróide da configuração de landmarks (bookstein1991?). Por definição, essa medida é matematicamente ortogonal à forma. Por ser única variável de tamanho não correlacionada com forma em condições de isometria (monteiro1999?; zelditch2012?), ela é variável de tamanho mais utilizada em morfometria geométrica.Vamos usar configurações de landmarks crânio de roedores para explorar algumas análises de variação de tamanho usando o tamanho centróide.Aqui está o tamanho centróide.É importante manter os dados organizados e ter uma tabela em formato excel ou similar com informações de cada espécime na mesma ordem em que eles aparecem na lista .tps. Organization key! Podemos carregar uma tabela assim R para explorar variação de tamanho entre classificadores biológicos dos nossos dados.Variação tamanho em função de classificadores biológicos.Um dos usos fundamentais tamanho centróide em Morfometria Geométrica é investigação de alometria, veja o subcapítulo correspondente.","code":"\nrequire(geomorph)\n#> Le chargement a nécessité le package : geomorph\n#> Le chargement a nécessité le package : RRPP\n#> Le chargement a nécessité le package : rgl\n#> Le chargement a nécessité le package : Matrix\n# Carregar dados\ntps<-readland.tps(\"dadosmg/Lista tuco dig 2.tps\",specID = \"ID\", readcurves = FALSE)\ndim(tps)\n\n# GPA  \ngpa<-gpagen(tps)\n\n# Extrair tamanho do centróide\nsize<-gpa$Csize\nsize\n\nhist(size)\nhist(log(size))\n# Carregar classificadores a partir de lista externa\nplan<-read.table(\"dadosmg/Planilha Ctenomys.txt\",h=T)\nplan\nspecies<-plan[,1]\nspecies<-as.factor(species)\nsex<-plan[,2]\nsex<-as.factor(sex)\nsp.sex<-plan[,3]\nsp.sex<-as.factor(sp.sex)\n# Variação de tamanho entre sexos\nboxplot(size~sex,ylab=\"CENTROID SIZE\")\nboxplot(log(size)~sex,ylab=\"LOG CENTROID SIZE\")\n# Teste t\nt.test(size~sex) \nt.test(log(size)~sex)\n\n# Variação de tamanho entre espécies\nboxplot(size~species,ylab=\"CENTROID SIZE\")\nboxplot(log(size)~species,ylab=\"LOG CENTROID SIZE\")\n# ANOVA (Analysis of Variance)\nanova<-aov(size~species) \nsummary(anova)\nanova<-aov(log(size)~species) \nsummary(anova)\n# Pairwise comparisons\nTukeyHSD(anova)\n\n# Variação de tamanho entre espécies e sexos\nboxplot(size~species*sex,ylab=\"CENTROID SIZE\")\nboxplot(log(size)~species*sex,ylab=\"LOG CENTROID SIZE\")\n# ANOVA com interação\nanova<-aov(size~sex*species)\nsummary(anova)\nTukeyHSD(anova)\nanova<-aov(log(size)~sex*species)\nsummary(anova)\nTukeyHSD(anova)"},{"path":"métodos-de-ordenação.html","id":"métodos-de-ordenação","chapter":"Capítulo 10 Métodos de ordenação","heading":"Capítulo 10 Métodos de ordenação","text":"Os métodos de ordenação mais usados em dados de morfometria geométrica são Análise de Componentes Principais (PCA) e Análise de Variáveis Canônicas (CVA). Ambos os métodos são exploratórios, e providenciam uma descrição dos dados, e não testes de hipóteses. entanto, CVA pode ser utilizada como uma função para discriminação de grupos, onde porcentagem de classificação correta de espécimes dentro de grupos pode ser usada como valor de suporte ao testar confiabilidade de grupos (ex: espécies).Para se aprofundar, leia: (klingen-monteiro2005?); (zelditch2012?).","code":""},{"path":"métodos-de-ordenação.html","id":"análise-de-componentes-principais","chapter":"Capítulo 10 Métodos de ordenação","heading":"10.1 Análise de Componentes Principais","text":"análise de componentes principais (Principal Component Analysis - PCA) simplifica os complexos padrões de variação e covariação de dados multivariados ao construir componentes principais independentes que resumem maior parte da variação dos dados em poucos eixos. Assim, também é possível observar diretamente combinação de dois ou três componentes principais em um gráfico.Vamos fazer uma PCA com dados de morfometria geométrica. Primeiro, vamos carregar os dados, fazer uma GPA, e carregar os classificadores.Muitas funções realizam Análise de Componentes Principais R. Para dados de morfometria geométrica (MG), é melhor usar funções de pacotes desenhados especificamente para MG, já que eles reconhecem redundância nos graus de liberdade que resultam das transformações de escala, posição e rotação feitas anteriormente na Análise Generalisada de Procrustes, e já retornam o número exato de componentes principais necessários para capturar 100% da variação da forma. Vamos usar PCA implementada pacote geomorph.Antes de observar mudanças de forma ao longo gráfico da PCA, vamos criar uma forma média de referência e definir links entre os landmarks.Podemos estilizar PCA para mostrar, por exemplo, quais indivíduos pertecem quais grupos. Além disso, é importante observar formas associadas com porções diferentes gráfico.É possível gerar elipses de confiança para os grupos em questão.mudanças de forma ao longo dos eixos da PCA podem ser visualizadas comparando-com média da amostra. Usualmente, formas extremas de cada eixo são usadas para visualização. O geomorph retorna formas extremas de maneira simplificada output da função que faz PCA.","code":"\nrequire(geomorph)\n#> Le chargement a nécessité le package : geomorph\n#> Le chargement a nécessité le package : RRPP\n#> Le chargement a nécessité le package : rgl\n#> Le chargement a nécessité le package : Matrix\n# Carregar dados\ntps<-readland.tps(\"dadosmg/Lista tuco dig 2.tps\",specID = \"ID\", readcurves = FALSE)\ndim(tps)\n\n# Gerar matriz com pares de landmarks simétricos\npairs.matrix<-matrix(c(2,3,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,28),nrow=12,ncol=2,byrow=T)\n# Vetor indivíduos\nind<-c(1:dim(tps)[3])\n\n# GPA - Simetria bilateral \nb.s<-bilat.symmetry(tps,ind=ind,object.sym=TRUE,land.pairs=pairs.matrix)\n\n# Matriz de forma\nshape.sym<-b.s$symm.shape\n\n# Carregar classificadores a partir de lista externa\nplan<-read.table(\"dadosmg/Planilha Ctenomys.txt\",h=T)\nplan\nspecies<-plan[,1]\nspecies<-as.factor(species)\nsex<-plan[,2]\nsex<-as.factor(sex)\nsp.sex<-plan[,3]\nsp.sex<-as.factor(sp.sex)\nPCA<-gm.prcomp(shape.sym)\nPCA # Porcentagem de explicação dos eixos\n#> \n#> Ordination type: Principal Component Analysis \n#> Centering by OLS mean\n#> Orthogonal projection of OLS residuals\n#> Number of observations: 30 \n#> Number of vectors 28 \n#> \n#> Importance of Components:\n#>                               Comp1        Comp2\n#> Eigenvalues            0.0005691898 0.0002349919\n#> Proportion of Variance 0.4018322761 0.1658977524\n#> Cumulative Proportion  0.4018322761 0.5677300285\n#>                               Comp3        Comp4\n#> Eigenvalues            0.0001552391 9.049344e-05\n#> Proportion of Variance 0.1095945175 6.388587e-02\n#> Cumulative Proportion  0.6773245461 7.412104e-01\n#>                               Comp5        Comp6\n#> Eigenvalues            6.732315e-05 5.547785e-05\n#> Proportion of Variance 4.752828e-02 3.916583e-02\n#> Cumulative Proportion  7.887387e-01 8.279045e-01\n#>                               Comp7        Comp8\n#> Eigenvalues            4.232582e-05 3.705712e-05\n#> Proportion of Variance 2.988086e-02 2.616131e-02\n#> Cumulative Proportion  8.577854e-01 8.839467e-01\n#>                               Comp9       Comp10\n#> Eigenvalues            3.356797e-05 2.770576e-05\n#> Proportion of Variance 2.369806e-02 1.955950e-02\n#> Cumulative Proportion  9.076448e-01 9.272043e-01\n#>                              Comp11       Comp12\n#> Eigenvalues            2.221806e-05 1.731913e-05\n#> Proportion of Variance 1.568534e-02 1.222683e-02\n#> Cumulative Proportion  9.428896e-01 9.551164e-01\n#>                              Comp13       Comp14\n#> Eigenvalues            1.405341e-05 1.156877e-05\n#> Proportion of Variance 9.921316e-03 8.167232e-03\n#> Cumulative Proportion  9.650377e-01 9.732050e-01\n#>                              Comp15       Comp16\n#> Eigenvalues            1.028007e-05 8.308937e-06\n#> Proportion of Variance 7.257446e-03 5.865880e-03\n#> Cumulative Proportion  9.804624e-01 9.863283e-01\n#>                              Comp17       Comp18\n#> Eigenvalues            7.020041e-06 3.263883e-06\n#> Proportion of Variance 4.955955e-03 2.304211e-03\n#> Cumulative Proportion  9.912842e-01 9.935885e-01\n#>                              Comp19       Comp20\n#> Eigenvalues            2.679842e-06 2.081122e-06\n#> Proportion of Variance 1.891894e-03 1.469214e-03\n#> Cumulative Proportion  9.954804e-01 9.969496e-01\n#>                              Comp21       Comp22\n#> Eigenvalues            1.577657e-06 1.186452e-06\n#> Proportion of Variance 1.113783e-03 8.376027e-04\n#> Cumulative Proportion  9.980634e-01 9.989010e-01\n#>                              Comp23       Comp24\n#> Eigenvalues            9.098790e-07 4.159837e-07\n#> Proportion of Variance 6.423494e-04 2.936730e-04\n#> Cumulative Proportion  9.995433e-01 9.998370e-01\n#>                              Comp25       Comp26\n#> Eigenvalues            1.598994e-07 6.588247e-08\n#> Proportion of Variance 1.128845e-04 4.651120e-05\n#> Cumulative Proportion  9.999499e-01 9.999964e-01\n#>                              Comp27       Comp28\n#> Eigenvalues            5.138116e-09 1.613869e-19\n#> Proportion of Variance 3.627368e-06 1.139347e-16\n#> Cumulative Proportion  1.000000e+00 1.000000e+00\n\nplot(PCA,axis1=1, axis2=2)\n# Forma média\nref<-mshape(shape.sym)\n\nlinks.tuco<-matrix(c(1,2,1,3,2,7,3,8,7,10,8,11,10,18,11,19,14,18,15,19,10,14,11,15,18,20,19,21,20,23,21,24,23,25,24,26,25,27,26,28,27,29,28,29,4,5,4,6,6,9,5,9,1,4,4,9,9,22,22,29,7,9,8,9,10,12,11,13,9,12,9,13,12,16,13,17,16,22,17,22,16,18,17,19,16,20,17,21,22,23,22,24,23,27,24,28,23,29,24,29),nrow=50,ncol=2,byrow=T)\n\n# Plotar espécimes contra a média\nGP1<-gridPar(pt.bg=\"gray\",link.col=\"gray\",link.lty=1) # cor dos landmarks e links\nplotRefToTarget(ref,shape.sym[,,8],links=links.tuco,method=\"TPS\") \nplotRefToTarget(ref,shape.sym[,,8],links=links.tuco,method=\"vector\") \nplotRefToTarget(ref,shape.sym[,,8],links=links.tuco,method=\"points\",gridPars=GP1) # alvo = em preto, referência = em cinza\n\nplotAllSpecimens(shape.sym,mean=TRUE,links=links.tuco)\n# PCA Estilizada\ncol.group<-rainbow(length(levels(species))) # criar vetor de cores para grupos\nnames(col.group)<-levels(species)\ncol.group<-col.group[match(species,names(col.group))]\nPCA<-gm.prcomp(shape.sym) # rodar a PCA\nxlab<-paste(\"Principal Component 1 \", \"(\",round(PCA$pc.summary$importance[2,1]*100,1),\"%)\",sep=\"\") # Criar label pro eixo 1\nylab<-paste(\"Principal Component 2 \", \"(\",round(PCA$pc.summary$importance[2,2]*100,1),\"%)\",sep=\"\") # Criar label pro eixo 2\n{mat<-matrix(c(4,5,0,1,1,2,1,1,3),3) # Dividir a janela do plot\nlayout(mat, widths=c(1,1,1), heights=c(1,1,0.6))\npar(mar=c(4, 4, 1, 1))\nplot(PCA$x[,1],PCA$x[,2],pch=21,cex=2,bg=col.group,xlab=xlab,ylab=ylab,asp=T)\nlegend(0.025,-0.015,legend=unique(species),pch=19,col=unique(col.group))\nplotRefToTarget(ref,PCA$shapes$shapes.comp1$min,links=links.tuco,method=\"TPS\",gridPars=GP1)\nplotRefToTarget(ref,PCA$shapes$shapes.comp1$max,links=links.tuco,method=\"TPS\",gridPars=GP1)\nplotRefToTarget(ref,PCA$shapes$shapes.comp2$max,links=links.tuco,method=\"TPS\",gridPars=GP1)\nplotRefToTarget(ref,PCA$shapes$shapes.comp2$min,links=links.tuco,method=\"TPS\",gridPars=GP1)}\npar(mfrow=c(1,1)) # janela default do gr?fico  \nrequire(vegan)\n#> Le chargement a nécessité le package : vegan\n#> Le chargement a nécessité le package : permute\n#> Le chargement a nécessité le package : lattice\n#> This is vegan 2.6-4\n{plot(PCA$x[,1],PCA$x[,2],pch=21,cex=2,bg=col.group,xlab=xlab,ylab=ylab,asp=T)\nordiellipse(PCA$x,group=species, kind=\"sd\", conf=0.95)}\n{plot(PCA$x[,1],PCA$x[,2],pch=21,cex=2,bg=col.group,xlab=xlab,ylab=ylab,asp=T)\nordihull(PCA$x,group=species)}\n# Definir cores dos landmarks e links\nGP1<-gridPar(pt.bg=\"gray\",link.col=\"gray\",link.lty=1) # cor dos landmarks e links\n# Mínimos e máximos contra a média\nplotRefToTarget(ref,PCA$shapes$shapes.comp1$min,links=links.tuco,method=\"TPS\",gridPars=GP1)\nplotRefToTarget(ref,PCA$shapes$shapes.comp1$max,links=links.tuco,method=\"TPS\",gridPars=GP1)\n# Mínimo contra máximo\nplotRefToTarget(PCA$shapes$shapes.comp1$min,PCA$shapes$shapes.comp1$max,links=links.tuco,method=\"points\",gridPars=GP1) # alvo = em preto, referência = em cinza"},{"path":"métodos-de-ordenação.html","id":"análise-de-variação-canônica","chapter":"Capítulo 10 Métodos de ordenação","heading":"10.2 Análise de Variação Canônica","text":"Assim como na PCA, Análise de Variação Canônica (Canonical Variates Analysis - CVA) também cria novas variáveis (eixos de ordenação) que são ortogonais. entanto, CVA descreve diferenças entre médias de grupos. Assim, ela pode ser usada para descrever diferenças de forma entre quaisquer grupos biológicos que tenhamos. Contudo, ao contrário da PCA, que simplesmente rotaciona coordenadas originais, CVA realiza uma transformação (rescalonamento pela variação dentro de grupos) sistema de coordenadas original, e por isso não deve ser interpretada livremente para representar variação de forma entre indivíduos. CVA mostra apenas direção em que os grupos são melhor discriminados um outro.Uma outra vantagem da CVA é que ela pode ser usada para estimar uma taxa de reclassificação correta de indivíduos dentro dos grupos hipotetizados.Visualização da forma ao longo dos eixos da CVA.Veja também os modelos linares para discriminação de grupos subcapítulo correspondente.","code":"\nrequire(Morpho)\n#> Le chargement a nécessité le package : Morpho\n#> Warning: le package 'Morpho' a été compilé avec la version\n#> R 4.3.2\n#> \n#> Attachement du package : 'Morpho'\n#> L'objet suivant est masqué depuis 'package:RRPP':\n#> \n#>     classify\ncva<-CVA(PCA$x[,1:20],groups=species,cv=TRUE) # Jackknife Cross-validation\ncva$Var\n#>      Canonical roots % Variance Cumulative %\n#> [1,]        88.21224   82.81358     82.81358\n#> [2,]        18.30681   17.18642    100.00000\n\n{plot(cva$CVscores,bg=col.group,pch=21,cex=2,xlab=paste(\"CV1  (\",paste(round(cva$Var[1,2],1),\"%)\"),sep=\"\"),ylab=paste(\"CV2  (\",paste(round(cva$Var[2,2],1),\"%)\"),sep=\"\"))\nlegend(0,-2,legend=unique(species),pch=19,col=unique(col.group))\n\n# gerar elipses de confiança\nordiellipse(cva$CVscores,group=species, kind=\"sd\", conf=0.95)} \n# ou: ordihull(cva$CVscores,group=species)\ncva<-CVA(PCA$x[,1:20],groups=species,cv=TRUE) # Jackknife Cross-validation\ncva\n#>  cross-validated classification results in frequencies\n#>               \n#>                C.flamarioni C.minutus C.torquatus\n#>   C.flamarioni            9         0           1\n#>   C.minutus               0         7           3\n#>   C.torquatus             0         0          10\n#> \n#> \n#>  cross-validated classification result in %\n#>               \n#>                C.flamarioni C.minutus C.torquatus\n#>   C.flamarioni           90         0          10\n#>   C.minutus               0        70          30\n#>   C.torquatus             0         0         100\n#> \n#> \n#>  overall classification accuracy: 86.66667 %\n#> \n#>  Kappa statistic: 0.8\ntab<-table(species,cva$class)\nlda.p<-diag(tab)/summary(species)*100\nlda.p # proporção de classificação correta para cada grupo\n#> C.flamarioni    C.minutus  C.torquatus \n#>           90           70          100\n# Mudança de forma ao longo do CV1 (positivo 15, negativo -10) e CV2\ncv1max<- 15*cva$CVvis[,1]+cva$Grandm\ncv1max <- restoreShapes(cv1max,PCA$x[,1:20],ref)\ncv1min<- -10*cva$CVvis[,1]+cva$Grandm\ncv1min <- restoreShapes(cv1min,PCA$x[,1:20],ref)\ncv2max<- 6*cva$CVvis[,2]+cva$Grandm\ncv2max <- restoreShapes(cv2max,PCA$x[,1:20],ref)\ncv2min<- -6*cva$CVvis[,2]+cva$Grandm\ncv2min <- restoreShapes(cv2min,PCA$x[,1:20],ref)\nplotRefToTarget(cv1min,cv1max,links=links.tuco,method=\"points\") \nplotRefToTarget(cv2min,cv2max,links=links.tuco,method=\"points\") "},{"path":"métodos-de-ordenação.html","id":"exercício-análise-de-componentes-principais","chapter":"Capítulo 10 Métodos de ordenação","heading":"10.3 Exercício – Análise de Componentes Principais","text":"Usando os mesmos dados deste exercício, faça uma PCA com função própria pacote geomorph, e uma PCA com função ‘prcomp’. Qual diferença entre duas PCAs? Como diferença pode ser explicada?","code":""},{"path":"partial-least-squares.html","id":"partial-least-squares","chapter":"Capítulo 11 Partial Least Squares","heading":"Capítulo 11 Partial Least Squares","text":"Partial Least Squares (PLS) é um método que explora padrões de covariação entre dois ou mais blocos de variáveis. De modo similar à PCA/CVA, PLS cria eixos ortogonais que, neste caso, explicam covariância entre blocos. Em análises de MG, um dos blocos normalmente é forma. O(s) bloco(s) adicional pode ser composto, por exemplo, por um grupo de variáveis climáticas, geográficas e/ou bióticas ou por outros descritores fenotípicos. Além disso, variáveis dentro dos blocos não precisam ser independentes uma da outra, e o número de variáveis pode exceder o número de observações. Os blocos de variáveis podem conter variáveis de diversas naturezas (contínuas, categóricas). É importante que ordem de entrada dos dados corresponda entre os dois blocos.exemplo, vamos explorar covariação entre forma crânio e forma da mandíbula de roedores sigmodontíneos.Carregar dados.Carregar classificadores partir de lista externa.Partial Least Squares - PLS.É possível visualizar mudanças de forma ao longo dos eixos da PLS de diferentes maneiras.\nUma delas é usando uma função interativa pacote geomorphA maneira mais tradicional é encontrar formas partir dos valores nos eixos da PLS.Visualização das formas mínimas e máximas dos eixos da PLS.","code":"\nrequire(geomorph)\n#> Le chargement a nécessité le package : geomorph\n#> Le chargement a nécessité le package : RRPP\n#> Le chargement a nécessité le package : rgl\n#> Le chargement a nécessité le package : Matrix\n# Carregar arquivo tps com a vista ventral do crânio\ntps.v<-readland.tps(\"dadosmg/ventral.dig_curso.pls.tps\",specID = \"ID\", readcurves = FALSE)\n# Matriz com os pares de landmarks simétricos\npairs.matrix<-\nmatrix(c(2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,24,22,28,23,29,19,25,20,26,21,27,30,31,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,55,56),nrow=26,ncol=2,byrow=T)\nind.v<-c(1:dim(tps.v)[3]) # vetor indivíduos\n# GPA - Simetria bilateral - Extrair componente simetrico da forma\nb.s<-bilat.symmetry(tps.v,ind=ind.v,object.sym=TRUE,land.pairs=pairs.matrix)\nshape.v<-b.s$symm.shape # componente simétrico da forma\ndimnames(shape.v)=dimnames(tps.v) #manter os nomes dos espécimes\nshape.v\n# Forma média ventral\nref.ventral<-mshape(shape.v)\n\n# Carregar arquivo tps da mandíbula\ntps<-readland.tps(\"dadosmg/mandibula.dig_curso.pls.tps\",specID = \"ID\", readcurves = FALSE)\ngpa<-gpagen(tps)\nshape<-gpa$coords\nsize<-gpa$Csize\nref.mand<-mshape(shape)\nplan<-read.table(\"dadosmg/Planilha_PLS.txt\",h=T)\nplan\nspecies.pls<-plan[,2]\nspecies.plspls<-two.b.pls(shape,shape.v,iter=999)\n#> \n#> Random PLS calculations: 1000 permutations.\n#> \n  |                                                        \n  |                                                  |   0%\n  |                                                        \n  |                                                  |   1%\n  |                                                        \n  |=                                                 |   1%\n  |                                                        \n  |=                                                 |   2%\n  |                                                        \n  |=                                                 |   3%\n  |                                                        \n  |==                                                |   3%\n  |                                                        \n  |==                                                |   4%\n  |                                                        \n  |==                                                |   5%\n  |                                                        \n  |===                                               |   5%\n  |                                                        \n  |===                                               |   6%\n  |                                                        \n  |===                                               |   7%\n  |                                                        \n  |====                                              |   7%\n  |                                                        \n  |====                                              |   8%\n  |                                                        \n  |====                                              |   9%\n  |                                                        \n  |=====                                             |   9%\n  |                                                        \n  |=====                                             |  10%\n  |                                                        \n  |=====                                             |  11%\n  |                                                        \n  |======                                            |  11%\n  |                                                        \n  |======                                            |  12%\n  |                                                        \n  |======                                            |  13%\n  |                                                        \n  |=======                                           |  13%\n  |                                                        \n  |=======                                           |  14%\n  |                                                        \n  |=======                                           |  15%\n  |                                                        \n  |========                                          |  15%\n  |                                                        \n  |========                                          |  16%\n  |                                                        \n  |========                                          |  17%\n  |                                                        \n  |=========                                         |  17%\n  |                                                        \n  |=========                                         |  18%\n  |                                                        \n  |=========                                         |  19%\n  |                                                        \n  |==========                                        |  19%\n  |                                                        \n  |==========                                        |  20%\n  |                                                        \n  |==========                                        |  21%\n  |                                                        \n  |===========                                       |  21%\n  |                                                        \n  |===========                                       |  22%\n  |                                                        \n  |===========                                       |  23%\n  |                                                        \n  |============                                      |  23%\n  |                                                        \n  |============                                      |  24%\n  |                                                        \n  |============                                      |  25%\n  |                                                        \n  |=============                                     |  25%\n  |                                                        \n  |=============                                     |  26%\n  |                                                        \n  |=============                                     |  27%\n  |                                                        \n  |==============                                    |  27%\n  |                                                        \n  |==============                                    |  28%\n  |                                                        \n  |==============                                    |  29%\n  |                                                        \n  |===============                                   |  29%\n  |                                                        \n  |===============                                   |  30%\n  |                                                        \n  |===============                                   |  31%\n  |                                                        \n  |================                                  |  31%\n  |                                                        \n  |================                                  |  32%\n  |                                                        \n  |================                                  |  33%\n  |                                                        \n  |=================                                 |  33%\n  |                                                        \n  |=================                                 |  34%\n  |                                                        \n  |=================                                 |  35%\n  |                                                        \n  |==================                                |  35%\n  |                                                        \n  |==================                                |  36%\n  |                                                        \n  |==================                                |  37%\n  |                                                        \n  |===================                               |  37%\n  |                                                        \n  |===================                               |  38%\n  |                                                        \n  |===================                               |  39%\n  |                                                        \n  |====================                              |  39%\n  |                                                        \n  |====================                              |  40%\n  |                                                        \n  |====================                              |  41%\n  |                                                        \n  |=====================                             |  41%\n  |                                                        \n  |=====================                             |  42%\n  |                                                        \n  |=====================                             |  43%\n  |                                                        \n  |======================                            |  43%\n  |                                                        \n  |======================                            |  44%\n  |                                                        \n  |======================                            |  45%\n  |                                                        \n  |=======================                           |  45%\n  |                                                        \n  |=======================                           |  46%\n  |                                                        \n  |=======================                           |  47%\n  |                                                        \n  |========================                          |  47%\n  |                                                        \n  |========================                          |  48%\n  |                                                        \n  |========================                          |  49%\n  |                                                        \n  |=========================                         |  49%\n  |                                                        \n  |=========================                         |  50%\n  |                                                        \n  |=========================                         |  51%\n  |                                                        \n  |==========================                        |  51%\n  |                                                        \n  |==========================                        |  52%\n  |                                                        \n  |==========================                        |  53%\n  |                                                        \n  |===========================                       |  53%\n  |                                                        \n  |===========================                       |  54%\n  |                                                        \n  |===========================                       |  55%\n  |                                                        \n  |============================                      |  55%\n  |                                                        \n  |============================                      |  56%\n  |                                                        \n  |============================                      |  57%\n  |                                                        \n  |=============================                     |  57%\n  |                                                        \n  |=============================                     |  58%\n  |                                                        \n  |=============================                     |  59%\n  |                                                        \n  |==============================                    |  59%\n  |                                                        \n  |==============================                    |  60%\n  |                                                        \n  |==============================                    |  61%\n  |                                                        \n  |===============================                   |  61%\n  |                                                        \n  |===============================                   |  62%\n  |                                                        \n  |===============================                   |  63%\n  |                                                        \n  |================================                  |  63%\n  |                                                        \n  |================================                  |  64%\n  |                                                        \n  |================================                  |  65%\n  |                                                        \n  |=================================                 |  65%\n  |                                                        \n  |=================================                 |  66%\n  |                                                        \n  |=================================                 |  67%\n  |                                                        \n  |==================================                |  67%\n  |                                                        \n  |==================================                |  68%\n  |                                                        \n  |==================================                |  69%\n  |                                                        \n  |===================================               |  69%\n  |                                                        \n  |===================================               |  70%\n  |                                                        \n  |===================================               |  71%\n  |                                                        \n  |====================================              |  71%\n  |                                                        \n  |====================================              |  72%\n  |                                                        \n  |====================================              |  73%\n  |                                                        \n  |=====================================             |  73%\n  |                                                        \n  |=====================================             |  74%\n  |                                                        \n  |=====================================             |  75%\n  |                                                        \n  |======================================            |  75%\n  |                                                        \n  |======================================            |  76%\n  |                                                        \n  |======================================            |  77%\n  |                                                        \n  |=======================================           |  77%\n  |                                                        \n  |=======================================           |  78%\n  |                                                        \n  |=======================================           |  79%\n  |                                                        \n  |========================================          |  79%\n  |                                                        \n  |========================================          |  80%\n  |                                                        \n  |========================================          |  81%\n  |                                                        \n  |=========================================         |  81%\n  |                                                        \n  |=========================================         |  82%\n  |                                                        \n  |=========================================         |  83%\n  |                                                        \n  |==========================================        |  83%\n  |                                                        \n  |==========================================        |  84%\n  |                                                        \n  |==========================================        |  85%\n  |                                                        \n  |===========================================       |  85%\n  |                                                        \n  |===========================================       |  86%\n  |                                                        \n  |===========================================       |  87%\n  |                                                        \n  |============================================      |  87%\n  |                                                        \n  |============================================      |  88%\n  |                                                        \n  |============================================      |  89%\n  |                                                        \n  |=============================================     |  89%\n  |                                                        \n  |=============================================     |  90%\n  |                                                        \n  |=============================================     |  91%\n  |                                                        \n  |==============================================    |  91%\n  |                                                        \n  |==============================================    |  92%\n  |                                                        \n  |==============================================    |  93%\n  |                                                        \n  |===============================================   |  93%\n  |                                                        \n  |===============================================   |  94%\n  |                                                        \n  |===============================================   |  95%\n  |                                                        \n  |================================================  |  95%\n  |                                                        \n  |================================================  |  96%\n  |                                                        \n  |================================================  |  97%\n  |                                                        \n  |================================================= |  97%\n  |                                                        \n  |================================================= |  98%\n  |                                                        \n  |================================================= |  99%\n  |                                                        \n  |==================================================|  99%\n  |                                                        \n  |==================================================| 100%\npls\n#> \n#> Call:\n#> two.b.pls(A1 = shape, A2 = shape.v, iter = 999) \n#> \n#> \n#> \n#> r-PLS: 0.897\n#> \n#> Effect Size (Z): 4.257\n#> \n#> P-value: 0.001\n#> \n#> Based on 1000 random permutations\n\nplot(pls,label=species.pls)\npls.plot<-plot(pls)\n#picknplot.shape(pls.plot)\npls<-two.b.pls(shape,shape.v,iter=999)\nplot(pls,label=species.pls)\n\n# Valores mínimos e máximos do pls plot\npreds.v<-shape.predictor(shape.v,two.d.array(shape),method=\"PLS\",\n                         Vmin=min(pls$XScores[,1]),\n                         Vmax=max(pls$XScores[,1])) \npreds.v\n\n# Valores mínimos e máximos do pls2\npls2<-two.b.pls(shape.v,shape,iter=999)\nplot(pls2,label=species.pls)\n\npreds.m<-shape.predictor(shape,two.d.array(shape.v),method=\"PLS\",\n                         Mmin=min(pls2$XScores[,1]),\n                         Mmax=max(pls2$XScores[,1])) \npreds.m\n{plot(pls,label=species.pls)\npar(mfrow=c(2,2),mar=c(0.01,0.01,0.01,0.01))\nplotRefToTarget(ref.mand,preds.m$Mmax)\ntext(0,0.4,labels=\"Valores negativos PLS1 Bloco1\",cex=1.3)\nplotRefToTarget(ref.ventral,preds.v$Vmin)\ntext(0,0.25,labels=\"Valores negativos PLS1 Bloco2\",cex=1.3)\nplotRefToTarget(ref.mand,preds.m$Mmin)\ntext(0,0.4,labels=\"Valores positivos PLS1 Bloco1\",cex=1.3)\nplotRefToTarget(ref.ventral,preds.v$Vmax)\ntext(0,0.25,labels=\"Valores positivos PLS1 Bloco2\",cex=1.3)}\npar(mfrow=c(1,1))"},{"path":"modelos-lineares-para-discriminação-de-grupos.html","id":"modelos-lineares-para-discriminação-de-grupos","chapter":"Capítulo 12 Modelos lineares para discriminação de grupos","heading":"Capítulo 12 Modelos lineares para discriminação de grupos","text":"Uma classe ampla de modelos preditivos está abarcada pelo nome de Modelos Lineares Generalizados, incluindo regressão múltipla e análises de variância/covariância. Uma vasta gama de modelos pode ser ajustada com função ‘procD.lm’ e outras pacote geomorph, que usa distância de Procrustes entre espécimes para calcular tamanhos de efeito e randomização para calcular valores de P (de modo equivalente à MANOVA não paramétrica – (goodall1991?; pillar1996?; anderson2001?); assim, o número de variáveis de forma, normalmente muito alto em dados de MG, não é uma restrição ao ajuste de modelos (collyer2015?). Podemos usar esses modelos baseados em distância para responder diversas questões quando variável resposta é composta por variáveis de forma. Aqui, vamos aplicá-los contexto de discriminação de grupos, quando variável preditora é categórica.","code":""},{"path":"modelos-lineares-para-discriminação-de-grupos.html","id":"manova","chapter":"Capítulo 12 Modelos lineares para discriminação de grupos","heading":"12.1 MANOVA","text":"Vamos testar se existem diferenças de forma entre espécies de tuco-tucos.MANOVA.Além da resposta geral, é interessante obter comparações par par.Manova par par “manual”.","code":"\nrequire(geomorph)\n#> Le chargement a nécessité le package : geomorph\n#> Le chargement a nécessité le package : RRPP\n#> Le chargement a nécessité le package : rgl\n#> Le chargement a nécessité le package : Matrix\n# Carregar dados\ntps<-readland.tps(\"dadosmg/Lista tuco dig 2.tps\",specID = \"ID\", readcurves = FALSE)\ndim(tps)\n\n# Gerar matriz com pares de landmarks simétricos\npairs.matrix<-matrix(c(2,3,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,28),nrow=12,ncol=2,byrow=T)\n# Vetor indivíduos\nind<-c(1:dim(tps)[3])\n\n# GPA - Simetria bilateral \nb.s<-bilat.symmetry(tps,ind=ind,object.sym=TRUE,land.pairs=pairs.matrix)\n\n# Matriz de forma\nshape.sym<-b.s$symm.shape\n\n# Carregar classificadores a partir de lista externa\nplan<-read.table(\"dadosmg/Planilha Ctenomys.txt\",h=T)\nplan\nspecies<-plan[,1]\nspecies<-as.factor(species)\nsex<-plan[,2]\nsex<-as.factor(sex)\nsp.sex<-plan[,3]\nsp.sex<-as.factor(sp.sex)\n# MANOVA (Multivariate Analysis of Variance)\nmanova<-procD.lm(shape.sym~species, iter=999, RRPP= TRUE)\nsummary(manova)\n#> \n#> Analysis of Variance, using Residual Randomization\n#> Permutation procedure: Randomization of null model residuals \n#> Number of permutations: 1000 \n#> Estimation method: Ordinary Least Squares \n#> Sums of Squares and Cross-products: Type I \n#> Effect sizes (Z) based on F distributions\n#> \n#>           Df       SS        MS     Rsq      F      Z\n#> species    2 0.019283 0.0096414 0.46942 11.944 4.7202\n#> Residuals 27 0.021795 0.0008072 0.53058              \n#> Total     29 0.041078                                \n#>           Pr(>F)   \n#> species    0.001 **\n#> Residuals          \n#> Total              \n#> ---\n#> Signif. codes:  \n#> 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Call: procD.lm(f1 = shape.sym ~ species, iter = 999, RRPP = TRUE)\n\nmanova.sex<-procD.lm(shape.sym~sex, iter=999, RRPP= TRUE)\nsummary(manova.sex)\n#> \n#> Analysis of Variance, using Residual Randomization\n#> Permutation procedure: Randomization of null model residuals \n#> Number of permutations: 1000 \n#> Estimation method: Ordinary Least Squares \n#> Sums of Squares and Cross-products: Type I \n#> Effect sizes (Z) based on F distributions\n#> \n#>           Df       SS        MS     Rsq      F      Z\n#> sex        1 0.002892 0.0028915 0.07039 2.1202 1.4855\n#> Residuals 28 0.038187 0.0013638 0.92961              \n#> Total     29 0.041078                                \n#>           Pr(>F)  \n#> sex        0.077 .\n#> Residuals         \n#> Total             \n#> ---\n#> Signif. codes:  \n#> 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Call: procD.lm(f1 = shape.sym ~ sex, iter = 999, RRPP = TRUE)\n\nmanova.completa<-procD.lm(shape.sym~species*sex, iter=999, RRPP= TRUE)\nsummary(manova.completa)\n#> \n#> Analysis of Variance, using Residual Randomization\n#> Permutation procedure: Randomization of null model residuals \n#> Number of permutations: 1000 \n#> Estimation method: Ordinary Least Squares \n#> Sums of Squares and Cross-products: Type I \n#> Effect sizes (Z) based on F distributions\n#> \n#>             Df       SS        MS     Rsq       F      Z\n#> species      2 0.019283 0.0096414 0.46942 13.9065 4.9897\n#> sex          1 0.002892 0.0028915 0.07039  4.1707 3.5268\n#> species:sex  2 0.002264 0.0011322 0.05512  1.6331 1.7627\n#> Residuals   24 0.016639 0.0006933 0.40506               \n#> Total       29 0.041078                                 \n#>             Pr(>F)   \n#> species      0.001 **\n#> sex          0.001 **\n#> species:sex  0.036 * \n#> Residuals            \n#> Total                \n#> ---\n#> Signif. codes:  \n#> 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Call: procD.lm(f1 = shape.sym ~ species * sex, iter = 999, RRPP = TRUE)\n\n# MANOVA Wilks's lambda\nPCA<-gm.prcomp(shape.sym)\nmanova.w<-manova(PCA$x[,1:26]~species)\nsummary(manova.w,test=\"Wilks\")\n#>           Df      Wilks approx F num Df den Df  Pr(>F)  \n#> species    2 7.9746e-05    8.537     52      4 0.02414 *\n#> Residuals 27                                            \n#> ---\n#> Signif. codes:  \n#> 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nmanova.w.sex<-manova(PCA$x[,1:26]~sex)\nsummary(manova.w.sex,test=\"Wilks\")\n#>           Df    Wilks approx F num Df den Df  Pr(>F)  \n#> sex        1 0.021083   5.3575     26      3 0.09549 .\n#> Residuals 28                                          \n#> ---\n#> Signif. codes:  \n#> 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n# Pairwise comparisons\nrequire(RRPP)\nmanova.pairwise<-pairwise(manova,groups=species)\nsummary(manova.pairwise)\n#> \n#> Pairwise comparisons\n#> \n#> Groups: C.flamarioni C.minutus C.torquatus \n#> \n#> RRPP: 1000 permutations\n#> \n#> LS means:\n#> Vectors hidden (use show.vectors = TRUE to view)\n#> \n#> Pairwise distances between means, plus statistics\n#>                                   d  UCL (95%)        Z\n#> C.flamarioni:C.minutus   0.03831876 0.02502431 3.065210\n#> C.flamarioni:C.torquatus 0.05438892 0.02542406 4.093932\n#> C.minutus:C.torquatus    0.03685612 0.02512571 2.914480\n#>                          Pr > d\n#> C.flamarioni:C.minutus    0.003\n#> C.flamarioni:C.torquatus  0.001\n#> C.minutus:C.torquatus     0.001\n# Manova par a par\ngdf.1<- geomorph.data.frame(coords=shape.sym[,,which(species==\"C.flamarioni\"|species==\"C.minutus\")],species=species[species==\"C.flamarioni\" | species==\"C.minutus\"])\nmanova.par1<-procD.lm(coords~species, iter=999, data = gdf.1)\nmanova.par1\nsummary(manova.par1)\ngdf.2<-\n  geomorph.data.frame(coords=shape.sym[,,which(species==\"C.flamarioni\"|species==\"C.torquatus\")],species=species[species==\"C.flamarioni\" | species==\"C.torquatus\"])\nmanova.par2<-procD.lm(coords~species, iter=999, data = gdf.2)\nmanova.par2\nsummary(manova.par2)\ngdf.3<-\n  geomorph.data.frame(coords=shape.sym[,,which(species==\"C.minutus\"|species==\"C.torquatus\")],species=species[species==\"C.minutus\" | species==\"C.torquatus\"])\nmanova.par3<-procD.lm(coords~species, iter=999, data = gdf.3)\nmanova.par3\nsummary(manova.par3)"},{"path":"modelos-lineares-para-discriminação-de-grupos.html","id":"fenograma","chapter":"Capítulo 12 Modelos lineares para discriminação de grupos","heading":"12.2 Fenograma","text":"Dependendo da pergunta de estudo, fenogramas podem ser úteis para visualizar os padrões de diferenciação de forma em um formato de árvore de distâncias morfológicas. Aqui, vamos criar um fenograma com distâncias de Procrustes e agrupamento de Neighbot-Joining.","code":"\nobj<-summary(manova.pairwise)\nobj$pairwise.tables$D\nmeans.dist<-obj$pairwise.tables$D\nrequire(ape)\n#> Le chargement a nécessité le package : ape\nfen<-nj(means.dist)\nplot(fen)\nplot(fen,type=\"unrooted\")"},{"path":"alometria.html","id":"alometria","chapter":"Capítulo 13 Alometria","heading":"Capítulo 13 Alometria","text":"De acordo com escola Gould-Mosimann, alometria é covariação entre tamanho e forma. Esse conceito faz sentido em Morfometria Geométrica (MG), já que há uma distinção formal entre tamanho e forma. Assim, podemos testar se existe uma associação entre forma e tamanho, ou seja, alometria, ou se não existe tal associação, ou seja, isometria. Em MG, isso é tradicionalmente feito através de uma regressão multivariada da forma sobre o tamanho centróide.alometria é classicamente dividida em três níveis: estática (dentro de uma amostra homogênea, ex: adultos de uma população), ontogenética (ao longo desenvolvimento, ex: indivíduos de diferentes idades em uma população) e evolutiva (entre várias espécies). forma e magnitude das relações alométricas dentro e entre grupos oferecem oportunidades interessantes para entender processos biológicos. Em alguns casos, pode-se também estar interessado em correção de tamanho/alometria nos dados, casos estes onde é fundamental investigar se há uma tendência alométrica comum aos dados (ou seja, quando relações alométricas não diferem entre grupos).Para textos abrangentes sobre alometria, veja: (zelditch2012?); (klingenberg2016?).","code":""},{"path":"alometria.html","id":"alometria-simples","chapter":"Capítulo 13 Alometria","heading":"13.1 Alometria simples","text":"Vamos investigar se forma e o tamanho crânio de tuco-tucos estão associados.Usaremos um modelo linear multivariado para testar associação entre tamanho e forma. Também podemos visualizar relação entre tamanho e forma em um espaço bivariado. Pra isso, precisamos resumir variação de forma em um único vetor, o que pode ser feito de algumas maneiras. maneira mais interessante é usar regresion scores (Drake & Klingenberg 2008) que retornam uma variável de forma que tem covariação máxima com o tamanho centróide.Finalmente, mas não menos importante, vamos visualizar diferenças de forma entre valores diferentes de tamanho.","code":"\nrequire(geomorph)\n#> Le chargement a nécessité le package : geomorph\n#> Le chargement a nécessité le package : RRPP\n#> Le chargement a nécessité le package : rgl\n#> Le chargement a nécessité le package : Matrix\n# Carregar dados\ntps<-readland.tps(\"dadosmg/Lista tuco dig 2.tps\",specID = \"ID\", readcurves = FALSE)\ndim(tps)\n\n# Gerar matriz com pares de landmarks simétricos\npairs.matrix<-matrix(c(2,3,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,28),nrow=12,ncol=2,byrow=T)\n# Vetor indivíduos\nind<-c(1:dim(tps)[3])\n\n# GPA - Extrair tamanho do centróide\ngpa<-gpagen(tps)\nsize<-gpa$Csize\n\n# GPA - Simetria bilateral \nb.s<-bilat.symmetry(tps,ind=ind,object.sym=TRUE,land.pairs=pairs.matrix)\n\n# Matriz de forma\nshape.sym<-b.s$symm.shape\n\n# Carregar classificadores a partir de lista externa\nplan<-read.table(\"dadosmg/Planilha Ctenomys.txt\",h=T)\nplan\nspecies<-plan[,1]\nspecies<-as.factor(species)\nsex<-plan[,2]\nsex<-as.factor(sex)\nsp.sex<-plan[,3]\nsp.sex<-as.factor(sp.sex)\n# Alometria simples\nalometria<-procD.lm(shape.sym~log(size),iter=999)\nsummary(alometria)\n#> \n#> Analysis of Variance, using Residual Randomization\n#> Permutation procedure: Randomization of null model residuals \n#> Number of permutations: 1000 \n#> Estimation method: Ordinary Least Squares \n#> Sums of Squares and Cross-products: Type I \n#> Effect sizes (Z) based on F distributions\n#> \n#>           Df       SS        MS     Rsq      F      Z\n#> log(size)  1 0.002667 0.0026672 0.06493 1.9443 1.4121\n#> Residuals 28 0.038411 0.0013718 0.93507              \n#> Total     29 0.041078                                \n#>           Pr(>F)  \n#> log(size)  0.082 .\n#> Residuals         \n#> Total             \n#> ---\n#> Signif. codes:  \n#> 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Call: procD.lm(f1 = shape.sym ~ log(size), iter = 999)\nplot(alometria,type=\"regression\",predictor=log(size),\n     reg.type = \"RegScore\", pch=19, xlab=\"Log Size\")\nplot.alometria<-plot(alometria,type=\"regression\",predictor=log(size),\n     reg.type = \"RegScore\", pch=19, xlab=\"Log Size\")\npreds<-shape.predictor(alometria$GM$fitted, x = plot.alometria$RegScore, \n                        predmin = min(plot.alometria$RegScore), \n                        predmax = max(plot.alometria$RegScore))\nref <-mshape(shape.sym)\n# Menores tamanhos\nplotRefToTarget(ref, preds$predmin, mag=2)\n# Maiores tamanhos\nplotRefToTarget(ref, preds$predmax, mag=2)"},{"path":"alometria.html","id":"correção-de-efeitos-alométricos","chapter":"Capítulo 13 Alometria","heading":"13.2 Correção de efeitos alométricos","text":"correção de tamanho/alometria em estudos de MG pode ser feita usando os resíduos da regressão multivariada da forma sobre o tamanho centróide em análises posteriores. Se amostra composta por grupos biológicos, é importante primeiro investigar se há uma tendência alométrica comum entre os grupos.","code":"\nshape.resid<-\n  arrayspecs(alometria$residuals,p=dim(shape.sym)[1],k=dim(shape.sym)[2]) #size adjusted residuals\nadj.shape<-shape.resid+array(gpa$consensus, dim(shape.resid)) # allometry-free shapes--somar a média retorna os números para o espaço de forma original e permite a visualização de mudanças de forma\n\n# PCA of allometry-free shape space\nPCA<-gm.prcomp(adj.shape)\nplot(PCA,axis1=1, axis2=2)"},{"path":"alometria.html","id":"comparação-de-trajetórias-alométricas-entre-grupos","chapter":"Capítulo 13 Alometria","heading":"13.3 Comparação de trajetórias alométricas entre grupos","text":"análise de alometria considerando grupos (e.g., espécies, habitats) pode revelar se relações alométricas (e.g., inclinação, ângulo, e comprimento das retas) são diferentes entre os grupos. Em outras palavras, é possível testar homogeneidade ou heterogeneidade dos slopes/inclinações. Se relações alométricas diferirem, pergunta ser respondida é quais fatores causam diferenças alométricas.Visualizando trajetórias alométricas.Diferenças de magnitude e orientação das retas.","code":"# Teste de Homogeneidade de Slopes\nalometria.HOS<-procD.lm(shape.sym~log(size)*species,iter=999)\nsummary(alometria.HOS)\n#> \n#> Analysis of Variance, using Residual Randomization\n#> Permutation procedure: Randomization of null model residuals \n#> Number of permutations: 1000 \n#> Estimation method: Ordinary Least Squares \n#> Sums of Squares and Cross-products: Type I \n#> Effect sizes (Z) based on F distributions\n#> \n#>                   Df       SS        MS     Rsq       F\n#> log(size)          1 0.002667 0.0026672 0.06493  3.7930\n#> species            2 0.019233 0.0096167 0.46821 13.6760\n#> log(size):species  2 0.002301 0.0011507 0.05602  1.6364\n#> Residuals         24 0.016876 0.0007032 0.41083        \n#> Total             29 0.041078                          \n#>                        Z Pr(>F)   \n#> log(size)         2.4779  0.006 **\n#> species           4.6694  0.001 **\n#> log(size):species 1.7715  0.040 * \n#> Residuals                         \n#> Total                             \n#> ---\n#> Signif. codes:  \n#> 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#> \n#> Call: procD.lm(f1 = shape.sym ~ log(size) * species, iter = 999)\n# Comparando com modelo nulo\nalometria.nulo<-procD.lm(shape.sym~size+species,iter=999)\nanova(alometria.nulo,alometria.HOS) # R2 do modelo full é a diferença entre modelos\n#> \n#> Sums of Squares calculations for 1 model: 1000 permutations.\n#> \n  |                                                        \n  |                                                  |   0%\n  |                                                        \n  |                                                  |   1%\n  |                                                        \n  |=                                                 |   1%\n  |                                                        \n  |=                                                 |   2%\n  |                                                        \n  |=                                                 |   3%\n  |                                                        \n  |==                                                |   3%\n  |                                                        \n  |==                                                |   4%\n  |                                                        \n  |==                                                |   5%\n  |                                                        \n  |===                                               |   5%\n  |                                                        \n  |===                                               |   6%\n  |                                                        \n  |===                                               |   7%\n  |                                                        \n  |====                                              |   7%\n  |                                                        \n  |====                                              |   8%\n  |                                                        \n  |====                                              |   9%\n  |                                                        \n  |=====                                             |   9%\n  |                                                        \n  |=====                                             |  10%\n  |                                                        \n  |=====                                             |  11%\n  |                                                        \n  |======                                            |  11%\n  |                                                        \n  |======                                            |  12%\n  |                                                        \n  |======                                            |  13%\n  |                                                        \n  |=======                                           |  13%\n  |                                                        \n  |=======                                           |  14%\n  |                                                        \n  |=======                                           |  15%\n  |                                                        \n  |========                                          |  15%\n  |                                                        \n  |========                                          |  16%\n  |                                                        \n  |========                                          |  17%\n  |                                                        \n  |=========                                         |  17%\n  |                                                        \n  |=========                                         |  18%\n  |                                                        \n  |=========                                         |  19%\n  |                                                        \n  |==========                                        |  19%\n  |                                                        \n  |==========                                        |  20%\n  |                                                        \n  |==========                                        |  21%\n  |                                                        \n  |===========                                       |  21%\n  |                                                        \n  |===========                                       |  22%\n  |                                                        \n  |===========                                       |  23%\n  |                                                        \n  |============                                      |  23%\n  |                                                        \n  |============                                      |  24%\n  |                                                        \n  |============                                      |  25%\n  |                                                        \n  |=============                                     |  25%\n  |                                                        \n  |=============                                     |  26%\n  |                                                        \n  |=============                                     |  27%\n  |                                                        \n  |==============                                    |  27%\n  |                                                        \n  |==============                                    |  28%\n  |                                                        \n  |==============                                    |  29%\n  |                                                        \n  |===============                                   |  29%\n  |                                                        \n  |===============                                   |  30%\n  |                                                        \n  |===============                                   |  31%\n  |                                                        \n  |================                                  |  31%\n  |                                                        \n  |================                                  |  32%\n  |                                                        \n  |================                                  |  33%\n  |                                                        \n  |=================                                 |  33%\n  |                                                        \n  |=================                                 |  34%\n  |                                                        \n  |=================                                 |  35%\n  |                                                        \n  |==================                                |  35%\n  |                                                        \n  |==================                                |  36%\n  |                                                        \n  |==================                                |  37%\n  |                                                        \n  |===================                               |  37%\n  |                                                        \n  |===================                               |  38%\n  |                                                        \n  |===================                               |  39%\n  |                                                        \n  |====================                              |  39%\n  |                                                        \n  |====================                              |  40%\n  |                                                        \n  |====================                              |  41%\n  |                                                        \n  |=====================                             |  41%\n  |                                                        \n  |=====================                             |  42%\n  |                                                        \n  |=====================                             |  43%\n  |                                                        \n  |======================                            |  43%\n  |                                                        \n  |======================                            |  44%\n  |                                                        \n  |======================                            |  45%\n  |                                                        \n  |=======================                           |  45%\n  |                                                        \n  |=======================                           |  46%\n  |                                                        \n  |=======================                           |  47%\n  |                                                        \n  |========================                          |  47%\n  |                                                        \n  |========================                          |  48%\n  |                                                        \n  |========================                          |  49%\n  |                                                        \n  |=========================                         |  49%\n  |                                                        \n  |=========================                         |  50%\n  |                                                        \n  |=========================                         |  51%\n  |                                                        \n  |==========================                        |  51%\n  |                                                        \n  |==========================                        |  52%\n  |                                                        \n  |==========================                        |  53%\n  |                                                        \n  |===========================                       |  53%\n  |                                                        \n  |===========================                       |  54%\n  |                                                        \n  |===========================                       |  55%\n  |                                                        \n  |============================                      |  55%\n  |                                                        \n  |============================                      |  56%\n  |                                                        \n  |============================                      |  57%\n  |                                                        \n  |=============================                     |  57%\n  |                                                        \n  |=============================                     |  58%\n  |                                                        \n  |=============================                     |  59%\n  |                                                        \n  |==============================                    |  59%\n  |                                                        \n  |==============================                    |  60%\n  |                                                        \n  |==============================                    |  61%\n  |                                                        \n  |===============================                   |  61%\n  |                                                        \n  |===============================                   |  62%\n  |                                                        \n  |===============================                   |  63%\n  |                                                        \n  |================================                  |  63%\n  |                                                        \n  |================================                  |  64%\n  |                                                        \n  |================================                  |  65%\n  |                                                        \n  |=================================                 |  65%\n  |                                                        \n  |=================================                 |  66%\n  |                                                        \n  |=================================                 |  67%\n  |                                                        \n  |==================================                |  67%\n  |                                                        \n  |==================================                |  68%\n  |                                                        \n  |==================================                |  69%\n  |                                                        \n  |===================================               |  69%\n  |                                                        \n  |===================================               |  70%\n  |                                                        \n  |===================================               |  71%\n  |                                                        \n  |====================================              |  71%\n  |                                                        \n  |====================================              |  72%\n  |                                                        \n  |====================================              |  73%\n  |                                                        \n  |=====================================             |  73%\n  |                                                        \n  |=====================================             |  74%\n  |                                                        \n  |=====================================             |  75%\n  |                                                        \n  |======================================            |  75%\n  |                                                        \n  |======================================            |  76%\n  |                                                        \n  |======================================            |  77%\n  |                                                        \n  |=======================================           |  77%\n  |                                                        \n  |=======================================           |  78%\n  |                                                        \n  |=======================================           |  79%\n  |                                                        \n  |========================================          |  79%\n  |                                                        \n  |========================================          |  80%\n  |                                                        \n  |========================================          |  81%\n  |                                                        \n  |=========================================         |  81%\n  |                                                        \n  |=========================================         |  82%\n  |                                                        \n  |=========================================         |  83%\n  |                                                        \n  |==========================================        |  83%\n  |                                                        \n  |==========================================        |  84%\n  |                                                        \n  |==========================================        |  85%\n  |                                                        \n  |===========================================       |  85%\n  |                                                        \n  |===========================================       |  86%\n  |                                                        \n  |===========================================       |  87%\n  |                                                        \n  |============================================      |  87%\n  |                                                        \n  |============================================      |  88%\n  |                                                        \n  |============================================      |  89%\n  |                                                        \n  |=============================================     |  89%\n  |                                                        \n  |=============================================     |  90%\n  |                                                        \n  |=============================================     |  91%\n  |                                                        \n  |==============================================    |  91%\n  |                                                        \n  |==============================================    |  92%\n  |                                                        \n  |==============================================    |  93%\n  |                                                        \n  |===============================================   |  93%\n  |                                                        \n  |===============================================   |  94%\n  |                                                        \n  |===============================================   |  95%\n  |                                                        \n  |================================================  |  95%\n  |                                                        \n  |================================================  |  96%\n  |                                                        \n  |================================================  |  97%\n  |                                                        \n  |================================================= |  97%\n  |                                                        \n  |================================================= |  98%\n  |                                                        \n  |================================================= |  99%\n  |                                                        \n  |==================================================|  99%\n  |                                                        \n  |==================================================| 100%\n#> \n#> Analysis of Variance, using Residual Randomization\n#> Permutation procedure: Randomization of null model residuals \n#> Number of permutations: 1000 \n#> Estimation method: Ordinary Least Squares \n#> Effect sizes (Z) based on F distributions\n#> \n#>                                   ResDf Df      RSS\n#> shape.sym ~ size + species (Null)    26  1 0.019228\n#> shape.sym ~ log(size) * species      24  2 0.016876\n#> Total                                29    0.041078\n#>                                          SS        MS\n#> shape.sym ~ size + species (Null)                    \n#> shape.sym ~ log(size) * species   0.0023522 0.0011761\n#> Total                                                \n#>                                        Rsq      F      Z\n#> shape.sym ~ size + species (Null) 0.000000              \n#> shape.sym ~ log(size) * species   0.057263 1.6726 1.8423\n#> Total                                                   \n#>                                       P Pr(>F)\n#> shape.sym ~ size + species (Null)             \n#> shape.sym ~ log(size) * species   0.034       \n#> Total\n# Definindo cores para grupos\ncol.group<-rainbow(length(levels(species))) # criar vetor de cores para grupos\nnames(col.group)<-levels(species)\ncol.group<-col.group[match(species,names(col.group))]\n\n# Plot RegScore\n{plotAllometry(alometria.HOS,size=size,logsz=TRUE,\n              method=\"RegScore\",pch=19,col=col.group)\nlegend(7.125,-0.007,legend=unique(species),pch=19,col=unique(col.group))}\n\n# Plot fitted values\n{plotAllometry(alometria.HOS,size=size,logsz=TRUE,\n              method=\"PredLine\",pch=19,col=col.group)\nlegend(7.11,0.00,legend=unique(species),pch=19,col=unique(col.group))}\n# Diferenças de magnitude (comprimento das retas)\nallo.mancova<-pairwise(alometria.HOS,groups=species)\nsummary(allo.mancova)\nnames(allo.mancova)\nsummary(allo.mancova, confidence = 0.95, test.type = \"DL\")\n\n# Diferenças de orientação/direção dos vetores (ângulos, vector correlation)\nsummary(allo.mancova,confidence = 0.95,test.type = \"VC\", angle.type = \"deg\")"},{"path":"análise-de-trajetória.html","id":"análise-de-trajetória","chapter":"Capítulo 14 Análise de Trajetória","heading":"Capítulo 14 Análise de Trajetória","text":"Análises de trajetória fenotípica (Phenotypic Trajectory Analysis - PTA) descrevem mudanças de forma ao longo de um gradiente, por exemplo, ecológico. Diferente de análises multivariadas padrão (MANOVAs) que permitem avaliar diferenças de forma média, com PTA é possível também investigar diferenças nas trajetórias: localização, comprimento, orientação e forma das trajetórias.\nAlguns tipos de perguntas biológicas são adequadamente respondidas com análises de trajetória.\nexemplo, vamos testar hipótese de deslocamento de caracteres causada por competição assumida. Duas espécies de tuco-tucos vivem em regiões de alopatria (só uma das espécies é encontrada) e regiões de simpatria (duas são encontradas). Vamos investigar se morfologia de ambas na região de simpatria evoluiu para se tornar mais diferente uma da outra que nas regiões de alopatria.","code":"\n# Carregar arquivo .tps\nrequire(geomorph)\n#> Le chargement a nécessité le package : geomorph\n#> Le chargement a nécessité le package : RRPP\n#> Le chargement a nécessité le package : rgl\n#> Le chargement a nécessité le package : Matrix\ntps<-readland.tps(\"dadosmg/tucodeslocamento.tps\",specID = \"ID\", readcurves = FALSE)\ndim(tps)\n# GPA\n# gerar matriz com os pares de landmarks simétricos\npairs.matrix<-\n  matrix(c(2,3,4,5,6,7,8,9,10,11,12,13,15,16,17,18,19,20,21,22,23,24,25,26,29,30),nrow=13,ncol=2,byrow=T)\npairs.matrix\nind<-c(1:dim(tps)[3]) # vetor indivíduos\n# GPA - Simetria bilateral\ngpa.object<-gpagen(tps)\nsize<-gpa.object$Csize\nb.s<-bilat.symmetry(tps,ind=ind,object.sym=TRUE,land.pairs=pairs.matrix)\nshape.sym<-b.s$symm.shape # componente simétrico da forma\nplotAllSpecimens(shape.sym)\n\n# Carregar classificadores a partir de lista externa\nplan<-read.table(\"dadosmg/tucodeslocamento.txt\",h=T)\nattach(plan)\nSpecies\nLocal\n\n# Deslocamento de Caracteres\n# Análises de Trajetória\nmodelo.traje<-procD.lm(shape.sym~Species*Local)\ntrajetoria<-trajectory.analysis(modelo.traje,groups = Species,traj.pts = Local)\n\n# Diferenças de magnitude (comprimento das trajetórias)\nsummary(trajetoria,attribute=\"MD\")\n\n# Diferenças de ângulo (correlação entre trajetórias)\nsummary(trajetoria, attribute=\"TC\", angle.type = \"deg\")\n\n# Visualização\n# Plot - Símbolos=Espécies; Cores=Local (preto=1, vermelho=2)\n{TP<-plot(trajetoria,pch=as.numeric(as.factor(Species))+20,bg=as.numeric(as.factor(Local)))\nadd.trajectories(TP, traj.pch = c(21, 22),\n                 start.bg = 1, end.bg = 2)\nlegend(\"topright\", levels(as.factor(Species)), pch = c(21, 22))\nlegend(\"bottomleft\", levels(as.factor(Local)), pch = 19,\n       col = c(\"black\",\"red\"))}"},{"path":"integração-morfológica-e-modularidade.html","id":"integração-morfológica-e-modularidade","chapter":"Capítulo 15 Integração morfológica e modularidade","heading":"Capítulo 15 Integração morfológica e modularidade","text":"Integração morfológica e modularidade são conceitos próximos, mas que dão ênfase para aspectos diferentes da morfologia: associação e dissociação entre partes. arquitetura mapa genótipo-fenótipo dá origem aos padrões e magnitudes de integração morfológica. Desenvolvimento e função compartilhadas são também aspectos fundamentais para entendermos origens da integração morfológica e da modularidade.Existem vários métodos para acessar estrutura de integração morfológica em dados de morfometria. Alguns testam hipóteses priori de modularidade, revisados em (zelditch2012?). exemplo, vamos usar um método que compara variância entre módulos com variância dentro de módulos.Para textos abrangentes sobre integração morfológica e modularidade contexto de morfometria geométrica, veja: (zelditch2012?); (klingenberg2014?).Vamos investigar integração morfológica e modularidade sobre uma hipótese de módulos crânianos usando landmarks em crânios de roedores sigmodontíneos.Primeiro, precisamos definir hipótese ser testada. função ‘define.modules’ permite desenharmos hipótese de maneira interativa. Selecione os landmarks de um módulo, pressione esc, selecione os landmarks segundo módulo, etc.Testando hipótese nula de ausência de modularidade.Testando hipótese nula de ausência de integração morfológica.Função interativa para visualização da forma dos módulos.","code":"\nrequire(geomorph)\n#> Le chargement a nécessité le package : geomorph\n#> Le chargement a nécessité le package : RRPP\n#> Le chargement a nécessité le package : rgl\n#> Le chargement a nécessité le package : Matrix\n# Carregar arquivo tps com a vista ventral do crânio \ntps.v<-readland.tps(\"dadosmg/ventral.dig_curso.pls.tps\",specID = \"ID\", readcurves = FALSE)\n\n# Gerar matriz com os pares de landmarks simétricos\npairs.matrix<-matrix(c(2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,24,22,28,23,29,19,25,20,26,21,27,30,31,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,55,56),nrow=26,ncol=2,byrow=T)\nind.v<-c(1:dim(tps.v)[3]) # vetor indivíduos\n# GPA - Simetria bilateral - Extrair componente simetrico da forma\nb.s<-bilat.symmetry(tps.v,ind=ind.v,object.sym=TRUE,land.pairs=pairs.matrix)\nshape.v<-b.s$symm.shape # componente sim?trico da forma\nref.ventral<-mshape(shape.v)\npartition<-define.modules(ref.ventral,2)\npartition<-c(rep(1,36),rep(2,20))\nmod<-modularity.test(shape.v,partition,iter=999) \nmod\nplot(mod)\nint<-integration.test(shape.v,partition.gp=partition,iter=999) \nint\nplot(int)\nplot(int)\nint.plot<-plot(int,shape=TRUE)\n#picknplot.shape(int.plot)"},{"path":"disparidade-e-variação-morfológica.html","id":"disparidade-e-variação-morfológica","chapter":"Capítulo 16 Disparidade e variação morfológica","heading":"Capítulo 16 Disparidade e variação morfológica","text":"Disparidade e variação são conceitos próximos, ambos relacionados à ideia de “variedade” ou “diversidade” morfológica; mesmas métricas podem ser utilizadas para ambos. entanto, uma distinção conceitual é aplicada: () Disparidade tem relação com variedade de um grupo de espécies, e é o resultado processo evolutivo de longo prazo; (ii) Variação tem relação com variedade de indivíduos dentro de uma única população.Vamos investigar disparidade total e dentro/entre espécies de roedores sigmodontíneos.Disparidade morfológica.","code":"\nrequire(geomorph)\n#> Le chargement a nécessité le package : geomorph\n#> Le chargement a nécessité le package : RRPP\n#> Le chargement a nécessité le package : rgl\n#> Le chargement a nécessité le package : Matrix\n# Carregar arquivo tps com a vista ventral do crânio \ntps.v<-readland.tps(\"dadosmg/ventral.dig_curso.pls.tps\",specID = \"ID\", readcurves = FALSE)\n\n# Gerar matriz com os pares de landmarks simétricos\npairs.matrix<-matrix(c(2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,24,22,28,23,29,19,25,20,26,21,27,30,31,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,55,56),nrow=26,ncol=2,byrow=T)\nind.v<-c(1:dim(tps.v)[3]) # vetor indivíduos\n# GPA - Simetria bilateral - Extrair componente simetrico da forma\nb.s<-bilat.symmetry(tps.v,ind=ind.v,object.sym=TRUE,land.pairs=pairs.matrix)\nshape.v<-b.s$symm.shape # componente sim?trico da forma\nref.ventral<-mshape(shape.v)\n\n# Carregar classificadores a partir de lista externa\nplan<-read.table(\"dadosmg/Planilha_PLS.txt\",h=T)\nplan\nspecies<-as.factor(plan[,2])\nspecies# Disparidade Morfológica\ndiv.total<-morphol.disparity(shape.v~1,groups=NULL,iter=999)\n#> \n#> Please be aware that printing progress slows down the analysis (perhaps slightly).\n#> \n#> Preliminary Model Fit...\n#> \n#> Sums of Squares calculations: 3 permutations.\n#> \n  |                                                        \n  |                                                  |   0%\n  |                                                        \n  |=================                                 |  33%\n  |                                                        \n  |=================================                 |  67%\n  |                                                        \n  |==================================================| 100%\n#> \n#> No terms for ANOVA; only RSS calculated in each permutation\n#> No factor in formula or model terms from which to define groups.\n#> Procrustes variance:\n#> 0.002195294\ndiv.total\n#> [1] 0.002195294\ndiv.sp<-morphol.disparity(shape.v~species,groups=~species,iter=999)\n#> \n#> Please be aware that printing progress slows down the analysis (perhaps slightly).\n#> \n#> Preliminary Model Fit...\n#> \n#> Sums of Squares calculations: 3 permutations.\n#> \n  |                                                        \n  |                                                  |   0%\n  |                                                        \n  |=================                                 |  33%\n  |                                                        \n  |=================================                 |  67%\n  |                                                        \n  |==================================================| 100%\n#> \n#> \n#> Performimg pairwise comparisons of disparity\n#> \n  |                                                        \n  |                                                  |   0%\n  |                                                        \n  |                                                  |   1%\n  |                                                        \n  |=                                                 |   1%\n  |                                                        \n  |=                                                 |   2%\n  |                                                        \n  |=                                                 |   3%\n  |                                                        \n  |==                                                |   3%\n  |                                                        \n  |==                                                |   4%\n  |                                                        \n  |==                                                |   5%\n  |                                                        \n  |===                                               |   5%\n  |                                                        \n  |===                                               |   6%\n  |                                                        \n  |===                                               |   7%\n  |                                                        \n  |====                                              |   7%\n  |                                                        \n  |====                                              |   8%\n  |                                                        \n  |====                                              |   9%\n  |                                                        \n  |=====                                             |   9%\n  |                                                        \n  |=====                                             |  10%\n  |                                                        \n  |=====                                             |  11%\n  |                                                        \n  |======                                            |  11%\n  |                                                        \n  |======                                            |  12%\n  |                                                        \n  |======                                            |  13%\n  |                                                        \n  |=======                                           |  13%\n  |                                                        \n  |=======                                           |  14%\n  |                                                        \n  |=======                                           |  15%\n  |                                                        \n  |========                                          |  15%\n  |                                                        \n  |========                                          |  16%\n  |                                                        \n  |========                                          |  17%\n  |                                                        \n  |=========                                         |  17%\n  |                                                        \n  |=========                                         |  18%\n  |                                                        \n  |=========                                         |  19%\n  |                                                        \n  |==========                                        |  19%\n  |                                                        \n  |==========                                        |  20%\n  |                                                        \n  |==========                                        |  21%\n  |                                                        \n  |===========                                       |  21%\n  |                                                        \n  |===========                                       |  22%\n  |                                                        \n  |===========                                       |  23%\n  |                                                        \n  |============                                      |  23%\n  |                                                        \n  |============                                      |  24%\n  |                                                        \n  |============                                      |  25%\n  |                                                        \n  |=============                                     |  25%\n  |                                                        \n  |=============                                     |  26%\n  |                                                        \n  |=============                                     |  27%\n  |                                                        \n  |==============                                    |  27%\n  |                                                        \n  |==============                                    |  28%\n  |                                                        \n  |==============                                    |  29%\n  |                                                        \n  |===============                                   |  29%\n  |                                                        \n  |===============                                   |  30%\n  |                                                        \n  |===============                                   |  31%\n  |                                                        \n  |================                                  |  31%\n  |                                                        \n  |================                                  |  32%\n  |                                                        \n  |================                                  |  33%\n  |                                                        \n  |=================                                 |  33%\n  |                                                        \n  |=================                                 |  34%\n  |                                                        \n  |=================                                 |  35%\n  |                                                        \n  |==================                                |  35%\n  |                                                        \n  |==================                                |  36%\n  |                                                        \n  |==================                                |  37%\n  |                                                        \n  |===================                               |  37%\n  |                                                        \n  |===================                               |  38%\n  |                                                        \n  |===================                               |  39%\n  |                                                        \n  |====================                              |  39%\n  |                                                        \n  |====================                              |  40%\n  |                                                        \n  |====================                              |  41%\n  |                                                        \n  |=====================                             |  41%\n  |                                                        \n  |=====================                             |  42%\n  |                                                        \n  |=====================                             |  43%\n  |                                                        \n  |======================                            |  43%\n  |                                                        \n  |======================                            |  44%\n  |                                                        \n  |======================                            |  45%\n  |                                                        \n  |=======================                           |  45%\n  |                                                        \n  |=======================                           |  46%\n  |                                                        \n  |=======================                           |  47%\n  |                                                        \n  |========================                          |  47%\n  |                                                        \n  |========================                          |  48%\n  |                                                        \n  |========================                          |  49%\n  |                                                        \n  |=========================                         |  49%\n  |                                                        \n  |=========================                         |  50%\n  |                                                        \n  |=========================                         |  51%\n  |                                                        \n  |==========================                        |  51%\n  |                                                        \n  |==========================                        |  52%\n  |                                                        \n  |==========================                        |  53%\n  |                                                        \n  |===========================                       |  53%\n  |                                                        \n  |===========================                       |  54%\n  |                                                        \n  |===========================                       |  55%\n  |                                                        \n  |============================                      |  55%\n  |                                                        \n  |============================                      |  56%\n  |                                                        \n  |============================                      |  57%\n  |                                                        \n  |=============================                     |  57%\n  |                                                        \n  |=============================                     |  58%\n  |                                                        \n  |=============================                     |  59%\n  |                                                        \n  |==============================                    |  59%\n  |                                                        \n  |==============================                    |  60%\n  |                                                        \n  |==============================                    |  61%\n  |                                                        \n  |===============================                   |  61%\n  |                                                        \n  |===============================                   |  62%\n  |                                                        \n  |===============================                   |  63%\n  |                                                        \n  |================================                  |  63%\n  |                                                        \n  |================================                  |  64%\n  |                                                        \n  |================================                  |  65%\n  |                                                        \n  |=================================                 |  65%\n  |                                                        \n  |=================================                 |  66%\n  |                                                        \n  |=================================                 |  67%\n  |                                                        \n  |==================================                |  67%\n  |                                                        \n  |==================================                |  68%\n  |                                                        \n  |==================================                |  69%\n  |                                                        \n  |===================================               |  69%\n  |                                                        \n  |===================================               |  70%\n  |                                                        \n  |===================================               |  71%\n  |                                                        \n  |====================================              |  71%\n  |                                                        \n  |====================================              |  72%\n  |                                                        \n  |====================================              |  73%\n  |                                                        \n  |=====================================             |  73%\n  |                                                        \n  |=====================================             |  74%\n  |                                                        \n  |=====================================             |  75%\n  |                                                        \n  |======================================            |  75%\n  |                                                        \n  |======================================            |  76%\n  |                                                        \n  |======================================            |  77%\n  |                                                        \n  |=======================================           |  77%\n  |                                                        \n  |=======================================           |  78%\n  |                                                        \n  |=======================================           |  79%\n  |                                                        \n  |========================================          |  79%\n  |                                                        \n  |========================================          |  80%\n  |                                                        \n  |========================================          |  81%\n  |                                                        \n  |=========================================         |  81%\n  |                                                        \n  |=========================================         |  82%\n  |                                                        \n  |=========================================         |  83%\n  |                                                        \n  |==========================================        |  83%\n  |                                                        \n  |==========================================        |  84%\n  |                                                        \n  |==========================================        |  85%\n  |                                                        \n  |===========================================       |  85%\n  |                                                        \n  |===========================================       |  86%\n  |                                                        \n  |===========================================       |  87%\n  |                                                        \n  |============================================      |  87%\n  |                                                        \n  |============================================      |  88%\n  |                                                        \n  |============================================      |  89%\n  |                                                        \n  |=============================================     |  89%\n  |                                                        \n  |=============================================     |  90%\n  |                                                        \n  |=============================================     |  91%\n  |                                                        \n  |==============================================    |  91%\n  |                                                        \n  |==============================================    |  92%\n  |                                                        \n  |==============================================    |  93%\n  |                                                        \n  |===============================================   |  93%\n  |                                                        \n  |===============================================   |  94%\n  |                                                        \n  |===============================================   |  95%\n  |                                                        \n  |================================================  |  95%\n  |                                                        \n  |================================================  |  96%\n  |                                                        \n  |================================================  |  97%\n  |                                                        \n  |================================================= |  97%\n  |                                                        \n  |================================================= |  98%\n  |                                                        \n  |================================================= |  99%\n  |                                                        \n  |==================================================|  99%\n  |                                                        \n  |==================================================| 100%\ndiv.sp\n#> \n#> Call:\n#> morphol.disparity(f1 = shape.v ~ species, groups = ~species,  \n#>     iter = 999) \n#> \n#> \n#> \n#> Randomized Residual Permutation Procedure Used\n#> 1000 Permutations\n#> \n#> Procrustes variances for defined groups\n#>         Aded         Aega         Aexa         Aupi \n#> 0.0004630470 0.0002893775 0.0006065943 0.0003949857 \n#>         Elmo         Irta         Jshu         Lomi \n#> 0.0001739802 0.0003795813 0.0004866557 0.0003683766 \n#> \n#> \n#> Pairwise absolute differences between variances\n#>              Aded         Aega         Aexa         Aupi\n#> Aded 0.000000e+00 1.736695e-04 0.0001435473 6.806128e-05\n#> Aega 1.736695e-04 0.000000e+00 0.0003172168 1.056082e-04\n#> Aexa 1.435473e-04 3.172168e-04 0.0000000000 2.116086e-04\n#> Aupi 6.806128e-05 1.056082e-04 0.0002116086 0.000000e+00\n#> Elmo 2.890668e-04 1.153973e-04 0.0004326141 2.210055e-04\n#> Irta 8.346564e-05 9.020385e-05 0.0002270129 1.540436e-05\n#> Jshu 2.360875e-05 1.972782e-04 0.0001199386 9.167002e-05\n#> Lomi 9.467042e-05 7.899906e-05 0.0002382177 2.660915e-05\n#>              Elmo         Irta         Jshu         Lomi\n#> Aded 0.0002890668 8.346564e-05 2.360875e-05 9.467042e-05\n#> Aega 0.0001153973 9.020385e-05 1.972782e-04 7.899906e-05\n#> Aexa 0.0004326141 2.270129e-04 1.199386e-04 2.382177e-04\n#> Aupi 0.0002210055 1.540436e-05 9.167002e-05 2.660915e-05\n#> Elmo 0.0000000000 2.056012e-04 3.126755e-04 1.943964e-04\n#> Irta 0.0002056012 0.000000e+00 1.070744e-04 1.120479e-05\n#> Jshu 0.0003126755 1.070744e-04 0.000000e+00 1.182792e-04\n#> Lomi 0.0001943964 1.120479e-05 1.182792e-04 0.000000e+00\n#> \n#> \n#> P-Values\n#>       Aded  Aega  Aexa  Aupi  Elmo  Irta  Jshu  Lomi\n#> Aded 1.000 0.175 0.247 0.600 0.021 0.520 0.844 0.468\n#> Aega 0.175 1.000 0.009 0.407 0.343 0.477 0.118 0.527\n#> Aexa 0.247 0.009 1.000 0.089 0.001 0.062 0.353 0.058\n#> Aupi 0.600 0.407 0.089 1.000 0.072 0.917 0.469 0.842\n#> Elmo 0.021 0.343 0.001 0.072 1.000 0.097 0.011 0.146\n#> Irta 0.520 0.477 0.062 0.917 0.097 1.000 0.418 0.934\n#> Jshu 0.844 0.118 0.353 0.469 0.011 0.418 1.000 0.361\n#> Lomi 0.468 0.527 0.058 0.842 0.146 0.934 0.361 1.000\n# Comparar com dispersão de pontos nos primeiros eixos da PCA:\ncol.group<-rainbow(length(levels(species))) # criar vetor de cores para grupos\nnames(col.group)<-levels(species)\ncol.group<-col.group[match(species,names(col.group))]\nPCA<-gm.prcomp(shape.v) # rodar a PCA\nplot(PCA$x[,1],PCA$x[,2],pch=21,cex=2,bg=col.group,asp=T)# Disparidade considerando alometria\ngpa.v<-gpagen(tps.v)\n#> \n#> Performing GPA\n#> \n  |                                                        \n  |                                                  |   0%\n  |                                                        \n  |============                                      |  25%\n  |                                                        \n  |=========================                         |  50%\n  |                                                        \n  |==================================================| 100%\n#> \n#> Making projections... Finished!\nsize<-gpa.v$Csize\ndiv.sp<-morphol.disparity(shape.v~log(size)*species,groups=~species,iter=999)\n#> \n#> Please be aware that printing progress slows down the analysis (perhaps slightly).\n#> \n#> Preliminary Model Fit...\n#> \n#> Sums of Squares calculations: 3 permutations.\n#> \n  |                                                        \n  |                                                  |   0%\n  |                                                        \n  |=================                                 |  33%\n  |                                                        \n  |=================================                 |  67%\n  |                                                        \n  |==================================================| 100%\n#> \n#> \n#> Performimg pairwise comparisons of disparity\n#> \n  |                                                        \n  |                                                  |   0%\n  |                                                        \n  |                                                  |   1%\n  |                                                        \n  |=                                                 |   1%\n  |                                                        \n  |=                                                 |   2%\n  |                                                        \n  |=                                                 |   3%\n  |                                                        \n  |==                                                |   3%\n  |                                                        \n  |==                                                |   4%\n  |                                                        \n  |==                                                |   5%\n  |                                                        \n  |===                                               |   5%\n  |                                                        \n  |===                                               |   6%\n  |                                                        \n  |===                                               |   7%\n  |                                                        \n  |====                                              |   7%\n  |                                                        \n  |====                                              |   8%\n  |                                                        \n  |====                                              |   9%\n  |                                                        \n  |=====                                             |   9%\n  |                                                        \n  |=====                                             |  10%\n  |                                                        \n  |=====                                             |  11%\n  |                                                        \n  |======                                            |  11%\n  |                                                        \n  |======                                            |  12%\n  |                                                        \n  |======                                            |  13%\n  |                                                        \n  |=======                                           |  13%\n  |                                                        \n  |=======                                           |  14%\n  |                                                        \n  |=======                                           |  15%\n  |                                                        \n  |========                                          |  15%\n  |                                                        \n  |========                                          |  16%\n  |                                                        \n  |========                                          |  17%\n  |                                                        \n  |=========                                         |  17%\n  |                                                        \n  |=========                                         |  18%\n  |                                                        \n  |=========                                         |  19%\n  |                                                        \n  |==========                                        |  19%\n  |                                                        \n  |==========                                        |  20%\n  |                                                        \n  |==========                                        |  21%\n  |                                                        \n  |===========                                       |  21%\n  |                                                        \n  |===========                                       |  22%\n  |                                                        \n  |===========                                       |  23%\n  |                                                        \n  |============                                      |  23%\n  |                                                        \n  |============                                      |  24%\n  |                                                        \n  |============                                      |  25%\n  |                                                        \n  |=============                                     |  25%\n  |                                                        \n  |=============                                     |  26%\n  |                                                        \n  |=============                                     |  27%\n  |                                                        \n  |==============                                    |  27%\n  |                                                        \n  |==============                                    |  28%\n  |                                                        \n  |==============                                    |  29%\n  |                                                        \n  |===============                                   |  29%\n  |                                                        \n  |===============                                   |  30%\n  |                                                        \n  |===============                                   |  31%\n  |                                                        \n  |================                                  |  31%\n  |                                                        \n  |================                                  |  32%\n  |                                                        \n  |================                                  |  33%\n  |                                                        \n  |=================                                 |  33%\n  |                                                        \n  |=================                                 |  34%\n  |                                                        \n  |=================                                 |  35%\n  |                                                        \n  |==================                                |  35%\n  |                                                        \n  |==================                                |  36%\n  |                                                        \n  |==================                                |  37%\n  |                                                        \n  |===================                               |  37%\n  |                                                        \n  |===================                               |  38%\n  |                                                        \n  |===================                               |  39%\n  |                                                        \n  |====================                              |  39%\n  |                                                        \n  |====================                              |  40%\n  |                                                        \n  |====================                              |  41%\n  |                                                        \n  |=====================                             |  41%\n  |                                                        \n  |=====================                             |  42%\n  |                                                        \n  |=====================                             |  43%\n  |                                                        \n  |======================                            |  43%\n  |                                                        \n  |======================                            |  44%\n  |                                                        \n  |======================                            |  45%\n  |                                                        \n  |=======================                           |  45%\n  |                                                        \n  |=======================                           |  46%\n  |                                                        \n  |=======================                           |  47%\n  |                                                        \n  |========================                          |  47%\n  |                                                        \n  |========================                          |  48%\n  |                                                        \n  |========================                          |  49%\n  |                                                        \n  |=========================                         |  49%\n  |                                                        \n  |=========================                         |  50%\n  |                                                        \n  |=========================                         |  51%\n  |                                                        \n  |==========================                        |  51%\n  |                                                        \n  |==========================                        |  52%\n  |                                                        \n  |==========================                        |  53%\n  |                                                        \n  |===========================                       |  53%\n  |                                                        \n  |===========================                       |  54%\n  |                                                        \n  |===========================                       |  55%\n  |                                                        \n  |============================                      |  55%\n  |                                                        \n  |============================                      |  56%\n  |                                                        \n  |============================                      |  57%\n  |                                                        \n  |=============================                     |  57%\n  |                                                        \n  |=============================                     |  58%\n  |                                                        \n  |=============================                     |  59%\n  |                                                        \n  |==============================                    |  59%\n  |                                                        \n  |==============================                    |  60%\n  |                                                        \n  |==============================                    |  61%\n  |                                                        \n  |===============================                   |  61%\n  |                                                        \n  |===============================                   |  62%\n  |                                                        \n  |===============================                   |  63%\n  |                                                        \n  |================================                  |  63%\n  |                                                        \n  |================================                  |  64%\n  |                                                        \n  |================================                  |  65%\n  |                                                        \n  |=================================                 |  65%\n  |                                                        \n  |=================================                 |  66%\n  |                                                        \n  |=================================                 |  67%\n  |                                                        \n  |==================================                |  67%\n  |                                                        \n  |==================================                |  68%\n  |                                                        \n  |==================================                |  69%\n  |                                                        \n  |===================================               |  69%\n  |                                                        \n  |===================================               |  70%\n  |                                                        \n  |===================================               |  71%\n  |                                                        \n  |====================================              |  71%\n  |                                                        \n  |====================================              |  72%\n  |                                                        \n  |====================================              |  73%\n  |                                                        \n  |=====================================             |  73%\n  |                                                        \n  |=====================================             |  74%\n  |                                                        \n  |=====================================             |  75%\n  |                                                        \n  |======================================            |  75%\n  |                                                        \n  |======================================            |  76%\n  |                                                        \n  |======================================            |  77%\n  |                                                        \n  |=======================================           |  77%\n  |                                                        \n  |=======================================           |  78%\n  |                                                        \n  |=======================================           |  79%\n  |                                                        \n  |========================================          |  79%\n  |                                                        \n  |========================================          |  80%\n  |                                                        \n  |========================================          |  81%\n  |                                                        \n  |=========================================         |  81%\n  |                                                        \n  |=========================================         |  82%\n  |                                                        \n  |=========================================         |  83%\n  |                                                        \n  |==========================================        |  83%\n  |                                                        \n  |==========================================        |  84%\n  |                                                        \n  |==========================================        |  85%\n  |                                                        \n  |===========================================       |  85%\n  |                                                        \n  |===========================================       |  86%\n  |                                                        \n  |===========================================       |  87%\n  |                                                        \n  |============================================      |  87%\n  |                                                        \n  |============================================      |  88%\n  |                                                        \n  |============================================      |  89%\n  |                                                        \n  |=============================================     |  89%\n  |                                                        \n  |=============================================     |  90%\n  |                                                        \n  |=============================================     |  91%\n  |                                                        \n  |==============================================    |  91%\n  |                                                        \n  |==============================================    |  92%\n  |                                                        \n  |==============================================    |  93%\n  |                                                        \n  |===============================================   |  93%\n  |                                                        \n  |===============================================   |  94%\n  |                                                        \n  |===============================================   |  95%\n  |                                                        \n  |================================================  |  95%\n  |                                                        \n  |================================================  |  96%\n  |                                                        \n  |================================================  |  97%\n  |                                                        \n  |================================================= |  97%\n  |                                                        \n  |================================================= |  98%\n  |                                                        \n  |================================================= |  99%\n  |                                                        \n  |==================================================|  99%\n  |                                                        \n  |==================================================| 100%\ndiv.sp\n#> \n#> Call:\n#> morphol.disparity(f1 = shape.v ~ log(size) * species, groups = ~species,  \n#>     iter = 999) \n#> \n#> \n#> \n#> Randomized Residual Permutation Procedure Used\n#> 1000 Permutations\n#> \n#> Procrustes variances for defined groups\n#>         Aded         Aega         Aexa         Aupi \n#> 0.0003260927 0.0001331069 0.0004333711 0.0001910877 \n#>         Elmo         Irta         Jshu         Lomi \n#> 0.0001310704 0.0002895081 0.0003230759 0.0002042844 \n#> \n#> \n#> Pairwise absolute differences between variances\n#>              Aded         Aega         Aexa         Aupi\n#> Aded 0.000000e+00 1.929858e-04 0.0001072784 1.350051e-04\n#> Aega 1.929858e-04 0.000000e+00 0.0003002643 5.798077e-05\n#> Aexa 1.072784e-04 3.002643e-04 0.0000000000 2.422835e-04\n#> Aupi 1.350051e-04 5.798077e-05 0.0002422835 0.000000e+00\n#> Elmo 1.950223e-04 2.036498e-06 0.0003023008 6.001727e-05\n#> Irta 3.658457e-05 1.564013e-04 0.0001438630 9.842049e-05\n#> Jshu 3.016813e-06 1.899690e-04 0.0001102952 1.319882e-04\n#> Lomi 1.218084e-04 7.117747e-05 0.0002290868 1.319670e-05\n#>              Elmo         Irta         Jshu         Lomi\n#> Aded 1.950223e-04 3.658457e-05 3.016813e-06 1.218084e-04\n#> Aega 2.036498e-06 1.564013e-04 1.899690e-04 7.117747e-05\n#> Aexa 3.023008e-04 1.438630e-04 1.102952e-04 2.290868e-04\n#> Aupi 6.001727e-05 9.842049e-05 1.319882e-04 1.319670e-05\n#> Elmo 0.000000e+00 1.584378e-04 1.920055e-04 7.321397e-05\n#> Irta 1.584378e-04 0.000000e+00 3.356776e-05 8.522379e-05\n#> Jshu 1.920055e-04 3.356776e-05 0.000000e+00 1.187915e-04\n#> Lomi 7.321397e-05 8.522379e-05 1.187915e-04 0.000000e+00\n#> \n#> \n#> P-Values\n#>       Aded  Aega  Aexa  Aupi  Elmo  Irta  Jshu  Lomi\n#> Aded 1.000 0.096 0.350 0.241 0.098 0.760 0.980 0.306\n#> Aega 0.096 1.000 0.012 0.614 0.980 0.162 0.104 0.521\n#> Aexa 0.350 0.012 1.000 0.043 0.009 0.252 0.331 0.043\n#> Aupi 0.241 0.614 0.043 1.000 0.581 0.398 0.236 0.915\n#> Elmo 0.098 0.980 0.009 0.581 1.000 0.158 0.092 0.527\n#> Irta 0.760 0.162 0.252 0.398 0.158 1.000 0.760 0.474\n#> Jshu 0.980 0.104 0.331 0.236 0.092 0.760 1.000 0.302\n#> Lomi 0.306 0.521 0.043 0.915 0.527 0.474 0.302 1.000"},{"path":"morfometria-geométrica-e-filogenias.html","id":"morfometria-geométrica-e-filogenias","chapter":"Capítulo 17 Morfometria geométrica e filogenias","heading":"Capítulo 17 Morfometria geométrica e filogenias","text":"Quando morfologias são de espécies diferentes, os dados não são independentes, já que espécies são conectadas por uma árvore filogenética.\nnão-independência filogenética precisa ser levada em consideração em análises de correlação.\nPra além disso, podemos entender muito sobre padrões e processos evolutivos da morfologia quando temos dados morfológicos de diferentes espécies e hipóteses filogenéticas.\nparte deste manual sobre Macroevolução explora muitas perguntas/análises que podem ser feitas em um contexto comparativo.\nAqui, os exemplos vão apresentar algumas análises comparativas contexto de morfometria geométrica.Para textos abrangentes sobre macroevolução e métodos filogenéticos comparativos contexto de morfometria geométrica, veja: (zelditch2012?); (monteiro2013?); (adams&collyer2018?).Para literatura geral, e muitas outras opções analíticas, veja o material e referências na parte sobre Macroevolução deste manual.Vamos carregar dados morfológicos obtidos por morfometria geométrica e uma hipótese filogenética para explorar algumas análises filogenéticas comparativas.Hipótese filogenética.","code":"\nrequire(geomorph)\n#> Le chargement a nécessité le package : geomorph\n#> Le chargement a nécessité le package : RRPP\n#> Le chargement a nécessité le package : rgl\n#> Le chargement a nécessité le package : Matrix\n# Carregar dados de forma média por espécie em formato de matriz\ntps<-readland.tps(\"dadosmg/mandibula.dig_curso.pls.tps\",specID = \"ID\", readcurves = FALSE)\ngpa<-gpagen(tps)\nshape<-gpa$coords\nsize<-gpa$Csize\nref.mand<-mshape(shape)\n\n# Carregar classificadores a partir de lista externa\nplan<-read.table(\"dadosmg/Planilha_PLS.txt\",h=T)\nplan\nspecies<-as.factor(plan[,2])\nspecies\n\n# Calcular forma média por espécie\nshape.2d<-two.d.array(shape)\nshape.2d.means<-rowsum(shape.2d,species)/as.vector(table(species))\nshape.means<-arrayspecs(shape.2d.means,dim(shape)[1],dim(shape)[2])\n\nsize.means<-rowsum(size,species)/as.vector(table(species))\nrequire(ape)\n#> Le chargement a nécessité le package : ape\ntree<-read.nexus(\"dadosmg/nexus.tree.sig.nex\")\n\nplot(tree)\ntree<-compute.brlen(tree,1) # definir comprimento dos ramos = 1"},{"path":"morfometria-geométrica-e-filogenias.html","id":"filomorfoespaço","chapter":"Capítulo 17 Morfometria geométrica e filogenias","heading":"17.1 Filomorfoespaço","text":"Podemos representar de maneira gráfica filogenia espaço de forma criado com uma análise de componentes principais.\nEssa é PCA padrão, inalterada, com projeção da filogenia e estimativa de formas ancestrais.Filomorfoespaço 3D.visualização de formas pode ser feita ao longo dos eixos, como na PCA tradicional, bem como podem ser visualizadas formas ancestrais estimadas, formas médias de espécies atuais, etc.Visualizar tamanho ao longo da filogenia.","code":"\nPCA<-gm.prcomp(shape.means,phy=tree)\nsummary(PCA)\nplot(PCA,phylo=TRUE)\nrequire(phytools)\n#> Le chargement a nécessité le package : phytools\n#> Le chargement a nécessité le package : maps\n#phylomorphospace3d(tree,PCA$x[,1:3])\nref<-mshape(shape.means)\nancestral.shapes<-arrayspecs(PCA$ancestors,13,2)\n# Forma ancestral contra a média\nplotRefToTarget(ref,ancestral.shapes[,,1],method=\"TPS\")\n# Forma ancestral contra espécie atual\nplotRefToTarget(ancestral.shapes[,,1],shape.means[,,\"Aexa\"],method=\"TPS\")\nsize.means1<-as.vector(size.means)\nnames(size.means1)=rownames(size.means)\ntree1<-compute.brlen(tree,method=\"Grafen\") # make ultrametric\n# cores\ncontMap(tree1,size.means1)\n# dots\ndotTree(tree1,size.means1,length=10)\n# barras\nplotTree.barplot(tree1,size.means1)"},{"path":"morfometria-geométrica-e-filogenias.html","id":"pca-filogenética","chapter":"Capítulo 17 Morfometria geométrica e filogenias","heading":"17.2 PCA filogenética","text":"PCA filogenética sensu (revell2009?).","code":"\nphyloPCA<-gm.prcomp(shape.means,phy=tree,GLS=TRUE)\nsummary(phyloPCA)\nplot(phyloPCA,phylo=TRUE)"},{"path":"morfometria-geométrica-e-filogenias.html","id":"sinal-filogenético-multivariado","chapter":"Capítulo 17 Morfometria geométrica e filogenias","heading":"17.3 Sinal filogenético multivariado","text":"Sinal filogenético é um padrão que mostra se espécies mais próximas filogeneticamente têm morfologias mais similares que espécies mais distantes filogeneticamente.\nExistem vários métodos para o cálculo de sinal filogenético, o mais comum é estatística K (Blomberg, Garland JR., Ives 2003; adams2014?).\nK=1 indica que espécies próximas são tão parecidas quanto prevê o modelo Browniano K<1 indica sinal filogenético menor que esperado pelo modelo Browniano K>1 indica sinal filogenético maior que esperado pelo modelo Browniano","code":"\n# Sinal Filogenético para forma do crânio\nsinal.k<-physignal(shape.means,tree,iter=999)\nsinal.k\n#> \n#> Call:\n#> physignal(A = shape.means, phy = tree, iter = 999) \n#> \n#> \n#> \n#> Observed Phylogenetic Signal (K): 0.6146\n#> \n#> P-value: 0.158\n#> \n#> Based on 1000 random permutations\n#> \n#>  Use physignal.z to estimate effect size.\n# Sinal Filogenético para tamanho do crânio\nsinal.k.size<-physignal(size.means,tree,iter=999)\nsinal.k.size\n#> \n#> Call:\n#> physignal(A = size.means, phy = tree, iter = 999) \n#> \n#> \n#> \n#> Observed Phylogenetic Signal (K): 0.5612\n#> \n#> P-value: 0.416\n#> \n#> Based on 1000 random permutations\n#> \n#>  Use physignal.z to estimate effect size."},{"path":"morfometria-geométrica-e-filogenias.html","id":"análise-filogenética-generalizada-por-quadrados-mínimos-pgls-multivariada","chapter":"Capítulo 17 Morfometria geométrica e filogenias","heading":"17.4 Análise filogenética generalizada por quadrados mínimos (PGLS multivariada)","text":"","code":"# Variáveis hipotéticas para usar como exemplo\nnomes<-c(\"Aded\",\"Aega\",\"Aexa\",\"Aupi\",\"Elmo\",\"Irta\",\"Jshu\",\"Lomi\")\ntemp<-c(12.15,22,16.02,10.42,8.21,8.39,25,7.86)\nalt<-c(2951,300,1931,3222,753.96,719.94,700,866.65)\nnames(temp)<-nomes\nnames(alt)<-nomes\n\ngdf<-geomorph.data.frame(shape.means=shape.means,temp=temp,tree=tree)\nfit.pgls<-procD.pgls(shape.means~temp,tree,data=gdf)\n#> \n#> Please be aware that printing progress slows down the analysis (perhaps slightly).\n#> \n#> Preliminary Model Fit...\n#> \n#> Sums of Squares calculations: 1000 permutations.\n#> \n  |                                                        \n  |                                                  |   0%\n  |                                                        \n  |                                                  |   1%\n  |                                                        \n  |=                                                 |   1%\n  |                                                        \n  |=                                                 |   2%\n  |                                                        \n  |=                                                 |   3%\n  |                                                        \n  |==                                                |   3%\n  |                                                        \n  |==                                                |   4%\n  |                                                        \n  |==                                                |   5%\n  |                                                        \n  |===                                               |   5%\n  |                                                        \n  |===                                               |   6%\n  |                                                        \n  |===                                               |   7%\n  |                                                        \n  |====                                              |   7%\n  |                                                        \n  |====                                              |   8%\n  |                                                        \n  |====                                              |   9%\n  |                                                        \n  |=====                                             |   9%\n  |                                                        \n  |=====                                             |  10%\n  |                                                        \n  |=====                                             |  11%\n  |                                                        \n  |======                                            |  11%\n  |                                                        \n  |======                                            |  12%\n  |                                                        \n  |======                                            |  13%\n  |                                                        \n  |=======                                           |  13%\n  |                                                        \n  |=======                                           |  14%\n  |                                                        \n  |=======                                           |  15%\n  |                                                        \n  |========                                          |  15%\n  |                                                        \n  |========                                          |  16%\n  |                                                        \n  |========                                          |  17%\n  |                                                        \n  |=========                                         |  17%\n  |                                                        \n  |=========                                         |  18%\n  |                                                        \n  |=========                                         |  19%\n  |                                                        \n  |==========                                        |  19%\n  |                                                        \n  |==========                                        |  20%\n  |                                                        \n  |==========                                        |  21%\n  |                                                        \n  |===========                                       |  21%\n  |                                                        \n  |===========                                       |  22%\n  |                                                        \n  |===========                                       |  23%\n  |                                                        \n  |============                                      |  23%\n  |                                                        \n  |============                                      |  24%\n  |                                                        \n  |============                                      |  25%\n  |                                                        \n  |=============                                     |  25%\n  |                                                        \n  |=============                                     |  26%\n  |                                                        \n  |=============                                     |  27%\n  |                                                        \n  |==============                                    |  27%\n  |                                                        \n  |==============                                    |  28%\n  |                                                        \n  |==============                                    |  29%\n  |                                                        \n  |===============                                   |  29%\n  |                                                        \n  |===============                                   |  30%\n  |                                                        \n  |===============                                   |  31%\n  |                                                        \n  |================                                  |  31%\n  |                                                        \n  |================                                  |  32%\n  |                                                        \n  |================                                  |  33%\n  |                                                        \n  |=================                                 |  33%\n  |                                                        \n  |=================                                 |  34%\n  |                                                        \n  |=================                                 |  35%\n  |                                                        \n  |==================                                |  35%\n  |                                                        \n  |==================                                |  36%\n  |                                                        \n  |==================                                |  37%\n  |                                                        \n  |===================                               |  37%\n  |                                                        \n  |===================                               |  38%\n  |                                                        \n  |===================                               |  39%\n  |                                                        \n  |====================                              |  39%\n  |                                                        \n  |====================                              |  40%\n  |                                                        \n  |====================                              |  41%\n  |                                                        \n  |=====================                             |  41%\n  |                                                        \n  |=====================                             |  42%\n  |                                                        \n  |=====================                             |  43%\n  |                                                        \n  |======================                            |  43%\n  |                                                        \n  |======================                            |  44%\n  |                                                        \n  |======================                            |  45%\n  |                                                        \n  |=======================                           |  45%\n  |                                                        \n  |=======================                           |  46%\n  |                                                        \n  |=======================                           |  47%\n  |                                                        \n  |========================                          |  47%\n  |                                                        \n  |========================                          |  48%\n  |                                                        \n  |========================                          |  49%\n  |                                                        \n  |=========================                         |  49%\n  |                                                        \n  |=========================                         |  50%\n  |                                                        \n  |=========================                         |  51%\n  |                                                        \n  |==========================                        |  51%\n  |                                                        \n  |==========================                        |  52%\n  |                                                        \n  |==========================                        |  53%\n  |                                                        \n  |===========================                       |  53%\n  |                                                        \n  |===========================                       |  54%\n  |                                                        \n  |===========================                       |  55%\n  |                                                        \n  |============================                      |  55%\n  |                                                        \n  |============================                      |  56%\n  |                                                        \n  |============================                      |  57%\n  |                                                        \n  |=============================                     |  57%\n  |                                                        \n  |=============================                     |  58%\n  |                                                        \n  |=============================                     |  59%\n  |                                                        \n  |==============================                    |  59%\n  |                                                        \n  |==============================                    |  60%\n  |                                                        \n  |==============================                    |  61%\n  |                                                        \n  |===============================                   |  61%\n  |                                                        \n  |===============================                   |  62%\n  |                                                        \n  |===============================                   |  63%\n  |                                                        \n  |================================                  |  63%\n  |                                                        \n  |================================                  |  64%\n  |                                                        \n  |================================                  |  65%\n  |                                                        \n  |=================================                 |  65%\n  |                                                        \n  |=================================                 |  66%\n  |                                                        \n  |=================================                 |  67%\n  |                                                        \n  |==================================                |  67%\n  |                                                        \n  |==================================                |  68%\n  |                                                        \n  |==================================                |  69%\n  |                                                        \n  |===================================               |  69%\n  |                                                        \n  |===================================               |  70%\n  |                                                        \n  |===================================               |  71%\n  |                                                        \n  |====================================              |  71%\n  |                                                        \n  |====================================              |  72%\n  |                                                        \n  |====================================              |  73%\n  |                                                        \n  |=====================================             |  73%\n  |                                                        \n  |=====================================             |  74%\n  |                                                        \n  |=====================================             |  75%\n  |                                                        \n  |======================================            |  75%\n  |                                                        \n  |======================================            |  76%\n  |                                                        \n  |======================================            |  77%\n  |                                                        \n  |=======================================           |  77%\n  |                                                        \n  |=======================================           |  78%\n  |                                                        \n  |=======================================           |  79%\n  |                                                        \n  |========================================          |  79%\n  |                                                        \n  |========================================          |  80%\n  |                                                        \n  |========================================          |  81%\n  |                                                        \n  |=========================================         |  81%\n  |                                                        \n  |=========================================         |  82%\n  |                                                        \n  |=========================================         |  83%\n  |                                                        \n  |==========================================        |  83%\n  |                                                        \n  |==========================================        |  84%\n  |                                                        \n  |==========================================        |  85%\n  |                                                        \n  |===========================================       |  85%\n  |                                                        \n  |===========================================       |  86%\n  |                                                        \n  |===========================================       |  87%\n  |                                                        \n  |============================================      |  87%\n  |                                                        \n  |============================================      |  88%\n  |                                                        \n  |============================================      |  89%\n  |                                                        \n  |=============================================     |  89%\n  |                                                        \n  |=============================================     |  90%\n  |                                                        \n  |=============================================     |  91%\n  |                                                        \n  |==============================================    |  91%\n  |                                                        \n  |==============================================    |  92%\n  |                                                        \n  |==============================================    |  93%\n  |                                                        \n  |===============================================   |  93%\n  |                                                        \n  |===============================================   |  94%\n  |                                                        \n  |===============================================   |  95%\n  |                                                        \n  |================================================  |  95%\n  |                                                        \n  |================================================  |  96%\n  |                                                        \n  |================================================  |  97%\n  |                                                        \n  |================================================= |  97%\n  |                                                        \n  |================================================= |  98%\n  |                                                        \n  |================================================= |  99%\n  |                                                        \n  |==================================================|  99%\n  |                                                        \n  |==================================================| 100%\nsummary(fit.pgls)\n#> \n#> Analysis of Variance, using Residual Randomization\n#> Permutation procedure: Randomization of null model residuals \n#> Number of permutations: 1000 \n#> Estimation method: Generalized Least-Squares (via OLS projection) \n#> Sums of Squares and Cross-products: Type I \n#> Effect sizes (Z) based on F distributions\n#> \n#>           Df       SS       MS     Rsq      F       Z\n#> temp       1 0.072892 0.072892 0.26685 2.1839 0.93768\n#> Residuals  6 0.200262 0.033377 0.73315               \n#> Total      7 0.273153                                \n#>           Pr(>F)\n#> temp       0.202\n#> Residuals       \n#> Total           \n#> \n#> Call: procD.lm(f1 = shape.means ~ temp, iter = iter, seed = seed, RRPP = TRUE,  \n#>     SS.type = SS.type, effect.type = effect.type, int.first = int.first,  \n#>     Cov = Cov, data = data, print.progress = print.progress)"},{"path":"morfometria-geométrica-e-filogenias.html","id":"contrastes-filogenéticos-independentes","chapter":"Capítulo 17 Morfometria geométrica e filogenias","heading":"17.5 Contrastes filogenéticos independentes","text":"","code":"\npic.size<-pic(size.means1,tree)\npic.temp<-pic(temp,tree)\nfit.pic<-lm(pic.size~pic.temp+0) # regressão pela origem, a direção da subtração foi arbitrária no cálculo dos PICs\nsummary.aov(fit.pic) # mesmo resultado da PGLS\nplot(pic.size~pic.temp)"},{"path":"morfometria-geométrica-e-filogenias.html","id":"exercício---morfometria-e-filogenias","chapter":"Capítulo 17 Morfometria geométrica e filogenias","heading":"17.6 Exercício - Morfometria e filogenias","text":"Carregue o arquivo .tps ‘Roedores_Digitalizados.tps’ contendo coordenadas digitalizadas na mandíbula de 143 indivíduos de 19 espécies de roedores.\nCarregue também informação taxonômica de cada indivíduo (‘Roedores_classificador.txt’), e uma hipótese filogenética para 19 espécies (‘Roedores_tree_nexus.nex’).\nExiste um arquivo adicional que informa força da mordida média de cada uma das 19 espécies (‘Roedores_BiteForce.txt’).\nInvestigue força sinal filogenético para o tamanho e forma crânio, e descubra se existe relação entre força da mordida e forma (e tamanho) crânio.","code":""},{"path":"macroevolução.html","id":"macroevolução","chapter":"Capítulo 18 Macroevolução","heading":"Capítulo 18 Macroevolução","text":"Em construção.","code":""},{"path":"lendo-e-manipulando-árvores-filogenéticas-no-r.html","id":"lendo-e-manipulando-árvores-filogenéticas-no-r","chapter":"Capítulo 19 Lendo e manipulando árvores filogenéticas no R","heading":"Capítulo 19 Lendo e manipulando árvores filogenéticas no R","text":"É aconselhável criar um único diretório contendo (s) árvore(s) e os dados fenotípicos, e informar ao R de qual diretório os arquivos devem ser lidos. Árvores filogenéticas podem ser importadas facilmente para dentro ambiente R através de funções como read.tree e read.nexus pacote ape.Neste capítulo, vamos explorar algumas maneiras de representar graficamente árvores filogenéticas e manipulá-las. Para entender mais sobre estrutura da árvore em formato phylo volte ao Capítulo 2 manual.Vamos ler uma árvore filogenética gênero de roedores neotropicais Akodon e representá-la graficamente.","code":"\nrequire(ape)\n#> Le chargement a nécessité le package : ape\nakodon.tree<-read.tree(file=\"dadospcm/akodon.tree\")\nakodon.tree\n#> \n#> Phylogenetic tree with 31 tips and 30 internal nodes.\n#> \n#> Tip labels:\n#>   Castoria_angustidens, Akodon_mimus, Akodon_lindberghi, Akodon_subfuscus, Akodon_lutescens, Akodon_sylvanus, ...\n#> Node labels:\n#>   474, 475, 476, 477, 479, 480, ...\n#> \n#> Rooted; includes branch lengths.\n# Existem muitas formas de plotar a árvore\nplot(akodon.tree)\n# cladograma orientado pra esquerda\nplot(akodon.tree, type = \"c\", use.edge.length = FALSE,direction=\"l\")\n# nomes alinhados à esquerda\nplot(akodon.tree, type = \"c\", use.edge.length = FALSE,direction=\"l\",adj=0)\n# visualizar partes da árvore com zoom\nzoom(akodon.tree, 13:17, subtree = FALSE, cex = 0.8)\npar(mfrow=c(1,1))\n# mudando cores\nplot(akodon.tree, type = \"fan\", edge.color = \"violetred\", tip.color = \"turquoise1\",\n cex = 0.5)\n# com o pacote phytools\nrequire(phytools)\n#> Le chargement a nécessité le package : phytools\n#> Le chargement a nécessité le package : maps\nplotTree(akodon.tree,ftype=\"i\",fsize=0.8,lwd=1)\n# filograma arredondado\nroundPhylogram(akodon.tree)\n# cladograma desenraizado (unrooted)\nplot(unroot(akodon.tree),type=\"unrooted\",cex=0.8,use.edge.length=FALSE,lab4ut=\"axial\")\n# árvore circular (fan tree)\nplotTree(akodon.tree,type=\"fan\",fsize=0.8,lwd=1,ftype=\"i\")\n# Legenda dos comprimento de ramos\n{plotTree(akodon.tree,ftype=\"i\",fsize=0.8,lwd=1,mar=c(3.0,0.1,0.1,0.1))\naxisPhylo()}"},{"path":"lendo-e-manipulando-árvores-filogenéticas-no-r.html","id":"extraindo-subclados-ou-espécies-da-árvore","chapter":"Capítulo 19 Lendo e manipulando árvores filogenéticas no R","heading":"19.1 Extraindo subclados ou espécies da árvore","text":"Podemos remover ou manter apenas determinadas espécies ou subclados da árvore. Pra isso, espécies devem estar identificadas pelos seus nomes (tip labels) ou os subclados pelo nome ou número nó que identifica o ancestral comum mais recente subclado. Abaixo estão exemplificadas duas formas.","code":"\nakodon.tree$tip.label\n# Exemplo: identificar as espécies do gênero com ocorrência no sul do Brasil\nsul.especies<-\nc(\"Akodon_paranaensis\",\"Akodon_azarae\",\"Akodon_reigi\",\"Akodon_montensis\",\"Cast\noria_angustidens\")\n# remover essas espécies da árvore\nakodon.drop<-drop.tip(akodon.tree,sul.especies)\nakodon.drop\nplotTree(akodon.tree,ftype=\"i\",fsize=0.8,lwd=1)\nplotTree(akodon.drop,ftype=\"i\",fsize=0.8,lwd=1)\n# ou manter apenas essas espécies na árvore\nakodon.drop1<-drop.tip(akodon.tree,setdiff(akodon.tree$tip.label,sul.especies))\nakodon.drop1\nplotTree(akodon.drop1,ftype=\"i\",fsize=0.8,lwd=1)\n# extrair um subclado da árvore\n{plotTree(akodon.tree,ftype=\"i\",fsize=0.8,lwd=1)\nnodelabels()}\nclado1<-extract.clade(akodon.tree,node=35)\nplotTree(clado1,ftype=\"i\",fsize=0.8,lwd=1)\n# remover o clado\nakodon.noclado1<-drop.tip(akodon.tree,clado1$tip.label)\nakodon.noclado1\nplotTree(akodon.noclado1,ftype=\"i\",fsize=0.8,lwd=1)\n# função interativa do phytools para remover clados\nakodon.col<-collapseTree(akodon.tree)\nplotTree(akodon.col,ftype=\"i\",fsize=0.8,lwd=1)"},{"path":"lendo-e-manipulando-árvores-filogenéticas-no-r.html","id":"incerteza-filogenética","chapter":"Capítulo 19 Lendo e manipulando árvores filogenéticas no R","heading":"19.2 Incerteza filogenética","text":"Uma árvore filogenética é uma hipótese sobre relações de parentesco entre aquelas espécies. Assim, é recomendável avaliar incerteza resultante uso de hipóteses alternativas. Uma das maneiras de fazer isso é repetindo análises de interesse para um conjunto de árvores (hipóteses).","code":""},{"path":"lendo-e-manipulando-árvores-filogenéticas-no-r.html","id":"politomias","chapter":"Capítulo 19 Lendo e manipulando árvores filogenéticas no R","heading":"19.2.1 Politomias","text":"Uma das fontes de incerteza filogenética são politomias. Algumas das funções implementando métodos comparativos R, que veremos, vão aceitar ávores com politomias, outras funções não vão. Podemos considerar incerteza filogenética ao resolver aleatoriamente politomias um grande número de vezes, e considerar todas hipóteses alternativas nos nossos testes estatísticos. Uma das maneiras mais simples de resolver politomias R é usando função multi2di pacote ape.Lembre-se que ao resolver apenas 1 vez ao acaso não existe avaliação de incerteza filogenética, é preciso repetir o processo um determinado número de vezes, que vai depender de quantas instâncias de politomia estiverem presentes na árvore, e quantas espécies estiverem nas politomias. Existem outros métodos que permitem gerar múltiplas árvores com politomias resolvidas ao acaso. Por exemplo: sunplin- Rangel et al. (2015).","code":"\nex<-read.tree(text=\"((A,B,C),(D,E));\")\nplot(ex)\nis.binary(ex)\n# resolver ao acaso uma única vez\nex1<-multi2di(ex)\nplot(ex1)\nis.binary(ex1)"},{"path":"lendo-e-manipulando-árvores-filogenéticas-no-r.html","id":"multiplas-árvores","chapter":"Capítulo 19 Lendo e manipulando árvores filogenéticas no R","heading":"19.2.2 Multiplas árvores","text":"Múltiplas filogenias são úteis quando queremos incorporar incerteza filogenética, por exemplo, replicando mesmas análises em múltiplas árvores.\nÁrvores múltiplas pertencem ao objeto de classe multiPhylo, que é uma lista de filogenias da classe phylo. Muitas funções podem prontamente ser aplicadas tanto para phylo como para multiPhylo. Algumas vão exigir replicação em cada filogenia separada.\nVamos juntar árvores que criamos até aqui para exemplificar um objeto multiPhylo.Um exemplo para uso de funções em múltiplas árvores, uma por vez, exemplificado com o recorte de uma parte da árvore.","code":"\nakodon.trees<-c(akodon.tree,akodon.drop,akodon.drop1,clado1,akodon.noclado1)\nakodon.trees\nclass(akodon.trees)\nprint(akodon.trees,details=TRUE)\nstr(akodon.trees[1])\n# Extraindo clados de múltiplas árvores\ntrees<-pbtree(n=50,nsim=100)\ntrees\nplot(trees[[1]])\ntree_cortado<- vector(mode = \"list\", length(trees))\nfor(i in 1:length(trees)){\n tree_cortado[[i]]<-keep.tip(trees[[i]], tip=trees[[1]]$tip.label[1:12])\n}\ntree_cortado\nplot(tree_cortado[[1]])"},{"path":"sinal-filogenético.html","id":"sinal-filogenético","chapter":"Capítulo 20 Sinal filogenético","heading":"Capítulo 20 Sinal filogenético","text":"Sinal filogenético é meramente um padrão que mostra se espécies mais próximas filogenéticamente têm fenótipos mais similares que espécies mais distantes filogenéticamente. magnitude sinal filogenético é, portanto, útil para percebermos quão forte é essa tendência de espécies similares fenotipicamente estarem próximas filogenéticamente.Existem vários métodos para calcular sinal filogenético. Vamos explorar aqui estatística K Blomberg, Garland JR., Ives (2003), o lambda de Pagel Pagel (1999), e curva PSR Diniz-Filho et al. (2012a).Vamos investigar magnitude sinal filogenético comprimento crânio de um gênero de roedores sul-americanos.É importante conferir correspondência entre espécies na filogenia e nos dados. Todas espécies precisam estar tanto na árvore como nos dados, e também tem que existir correspondência exata nos nomes. Existem algumas funções, como name.check e treedata, pacote geiger, que fazem essa conferência.É importante visualizar distribuição atributo na filogenia.","code":"\n# Carregar dados fenotípicos\ndados<-read.table(\"dadospcm/akodon.txt\",h=T)\ndados\n# A função attach permite obter cada coluna dos dados\nattach(dados)\n# Vamos (re)atribuir os nomes das espécies\nskull_length<-setNames(skull_length,species)\nskull_length\n\n# Carregar árvore\nrequire(ape)\n#> Le chargement a nécessité le package : ape\ntree<-read.tree(\"dadospcm/akodon.tree\")\n{plot(tree,cex=0.4)\naxisPhylo()}\nrequire(geiger)\n#> Le chargement a nécessité le package : geiger\n#> Le chargement a nécessité le package : phytools\n#> Le chargement a nécessité le package : maps\nname.check(tree,dados,data.names=species)\n#> [1] \"OK\"\nrequire(phytools)\nplotTree.barplot(tree,skull_length,\n args.plotTree=list(fsize=0.5,ftype=\"i\"))"},{"path":"sinal-filogenético.html","id":"estatística-k","chapter":"Capítulo 20 Sinal filogenético","heading":"20.1 Estatística K","text":"K=1 indica que espécies próximas são tão parecidas quanto prevê o modelo Browniano de evolução K<1 indica sinal filogenético menor que esperado pelo modelo Browniano de evolução K>1 indica sinal filogenético maior que esperado pelo modelo Browniano de evolução","code":"\nrequire(phytools)\nphylosig(tree,skull_length,method = \"K\",test = TRUE)\n#> \n#> Phylogenetic signal K : 0.336983 \n#> P-value (based on 1000 randomizations) : 0.669"},{"path":"sinal-filogenético.html","id":"lambda-de-pagel","chapter":"Capítulo 20 Sinal filogenético","heading":"20.2 Lambda de Pagel","text":"λ=0 indica ausência de sinal filogenético (sinal esperado em uma filogenia estrela) λ=1 indica sinal filogenético correspondente ao modelo Browniano","code":"\nphylosig(tree,skull_length,method = \"lambda\",test = TRUE)\n#> \n#> Phylogenetic signal lambda : 7.95528e-05 \n#> logL(lambda) : -42.2205 \n#> LR(lambda=0) : -0.000914493 \n#> P-value (based on LR test) : 1"},{"path":"sinal-filogenético.html","id":"curva-psr","chapter":"Capítulo 20 Sinal filogenético","heading":"20.3 Curva PSR","text":"regressão de autovetores filogenéticos (phylogenetic eigenvector regression - PVR) (Diniz-Filho, de Sant’Ana, Bini 1998) pode ser usada para estimar quantidade de sinal filogenético nos dados, além de permitir partição da variância entre filogenia e demais causas, como veremos capítulo sobre regressão filogenética. PVR funciona com uma regressão fenótipo contra um conjunto de autovetores filogenéticos extraídos por uma análise de coordenadas principais de uma matriz de distâncias filogenéticas. O R² da regressão entre o fenótipo e os autovetores filogenéticos funciona como uma medida de sinal filogenético. entanto, se todos os autovetores forem usados, o R² inevitavelmente alcança 1, e se alguns autovetores forem omitidos, parte da filogenia é ignorada (Rohlf 2001). entanto, Diniz-Filho et al. (2012a) descobriu que se PVRs sucessivas forem feitas, adicionando um autovetor filogenético por vez como preditor, e depois os R²s de cada regressão forem plotados contra os autovalores cumulativos (%), uma relação linear (linha de 45º) é obtida sob um modelo Browniano de evolução. Essa abordagem, chamada de PSR (phylogenetic signal-representation) permite estimar o sinal filogenético e oferece habilidade de visualizar o padrão de acúmulo de variação fenótipo (acelaração e desaceleração de taxas) ao longo tempo, em comparação com o modelo Browniano de evolução (Diniz-Filho et al. 2012b) e outros modelos, como OU (Maestri et al. 2017).O exemplo abaixo calcula e representa graficamente curva PSR.É comum encontrar menções de que regressões ou outras análises foram corrigidas pela filogenia porque um sinal filogenético foi encontrado nas variáveis brutas. entanto, o uso de regressão filogenética deve estar associado aos resíduos modelo de interesse apresentarem sinal filogenético (Revell 2010).","code":"\n#install.packages(\"PVR\")\nrequire(PVR)\n#> Le chargement a nécessité le package : PVR\n#> PVR 0.3 loaded\n# Decomposição de matriz de distância filogenética\npvr_obj<-PVRdecomp(tree)\n# Regressão de autovetores filogenéticos\npvr_reg<-PVR(pvr_obj,tree,skull_length)\n# Sinal Filogenético com Cuva PSR\npsr_obj<-PSR(pvr_obj,trait=skull_length,\nnull.model=TRUE,Brownian.model=TRUE,times=10)\npsr_obj\n#PSRplot(psr_obj,info=\"both\")"},{"path":"sinal-filogenético.html","id":"exercício---árvores-e-sinal-filogenético","chapter":"Capítulo 20 Sinal filogenético","heading":"20.4 Exercício - Árvores e sinal filogenético","text":"Carregue uma árvore filogenética para o seu grupo de estudo e observe estrutura dela. Represente árvore graficamente de diferentes formas. Se você tiver variáveis fenotípicas para o seu grupo de estudo, tente carregar R e testar o sinal filogenético.","code":""},{"path":"modelos-para-evolução-de-fenótipos-contínuos.html","id":"modelos-para-evolução-de-fenótipos-contínuos","chapter":"Capítulo 21 Modelos para evolução de fenótipos contínuos","heading":"Capítulo 21 Modelos para evolução de fenótipos contínuos","text":"Existem vários modelos de evolução de atributos contínuos univariados. Os modelos macroevolutivos mais comuns são o Browniano (BM), o modelo de Ornstein-Uhlenbeck (OU) e o modelo Early-Burst (EB). Sobre ajuste de modelos evolutivos, leia Butler King (2004).exemplo, função fitContinuous pacote geiger vai ser usada para ajustar os modelos. O método é baseado em verossimilhança (likelihood), e os resultados vão retornar o valor de máxima verossimilhança (maximum likelihood) como estimativa para os parâmetros. Diferentes modelos podem ser comparados, desde que sobre os mesmos dados. Vamos carregar vários atributos fenotípicos para 77 espécies de Primatas.Conferir correspondência entre espécies nos dados e na filogenia.","code":"\nrequire(phytools)\n#> Le chargement a nécessité le package : phytools\n#> Le chargement a nécessité le package : ape\n#> Le chargement a nécessité le package : maps\nrequire(geiger)\n#> Le chargement a nécessité le package : geiger\n# Carregar dados\ndados<-read.table(\"dadospcm/primate-data.txt\",h=T,row.names=1)\ndados\n# Carregar filogenia\ntree<-read.tree(\"dadospcm/primate-tree.txt\")\nplot(tree)\nplotTree(tree,fsize=0.4,ftype=\"i\",type=\"fan\",lwd=1)\nmatch.species<-treedata(tree,dados)\nnames(match.species)\ntree<-match.species$phy\nstr(tree)\nplotTree(tree,fsize=0.5,ftype=\"i\",type=\"fan\",lwd=1)\nbodymass<-dados[,1]\nbodymass<-setNames(bodymass,rownames(dados))\nbodymass"},{"path":"modelos-para-evolução-de-fenótipos-contínuos.html","id":"modelos-evolutivos-contínuos","chapter":"Capítulo 21 Modelos para evolução de fenótipos contínuos","heading":"21.1 Modelos evolutivos contínuos","text":"","code":""},{"path":"modelos-para-evolução-de-fenótipos-contínuos.html","id":"modelo-browniano","chapter":"Capítulo 21 Modelos para evolução de fenótipos contínuos","heading":"21.1.1 Modelo Browniano","text":"O modelo Browniano estima taxa de evolução σ2 (sigsq output), e o valor atributo na raiz X(0) (z0 output). Outras estimativas output são o likelihood (lnL) modelo, o AIC/AICc e o número de parâmetros (k na literatura) modelo.","code":"\nBM<-fitContinuous(tree,log(bodymass),model=\"BM\")\nBM"},{"path":"modelos-para-evolução-de-fenótipos-contínuos.html","id":"modelo-de-ornstein-uhlenbeck","chapter":"Capítulo 21 Modelos para evolução de fenótipos contínuos","heading":"21.1.2 Modelo de Ornstein-Uhlenbeck","text":"O modelo OU estima um parâmetro adicional, α ou alpha, que é força de atração para média ótimo, μ ou θ.","code":"\nOU<-fitContinuous(tree,log(bodymass),model=\"OU\")\nOU"},{"path":"modelos-para-evolução-de-fenótipos-contínuos.html","id":"modelo-de-early-burstlate-burst","chapter":"Capítulo 21 Modelos para evolução de fenótipos contínuos","heading":"21.1.3 Modelo de Early-Burst/Late-Burst","text":"modelo EB o parâmetro é taxa de mudança através tempo. O valor de é normalmente menor ou igual 0. Quando é negativo, taxas de evolução decrescem com o tempo. Se é próximo de 0, evolução é aproximadamente Browniana.","code":"\nEB<-fitContinuous(tree,log(bodymass),model=\"EB\")\nEB"},{"path":"modelos-para-evolução-de-fenótipos-contínuos.html","id":"comparação-de-modelos","chapter":"Capítulo 21 Modelos para evolução de fenótipos contínuos","heading":"21.1.4 Comparação de modelos","text":"Nós podemos comparar o ajuste dos modelos usando um critério de informação, como o AIC. Existe debate sobre quão grande deve ser diferença AIC para definir um único “melhor” modelo, variando de 2-10 unidades. É comum usar 4 unidades, então EB não tem um ajuste muito melhor que BM ou OU nos dados exemplo.","code":"\nBM$opt$aicc\nOU$opt$aicc\nEB$opt$aicc\naic.scores<-setNames(c(BM$opt$aicc,OU$opt$aicc,EB$opt$aicc),\n c(\"BM\",\"OU\",\"EB\"))\naic.scores\naicw(aic.scores) # Delta AICc e AICc weights"},{"path":"modelos-para-evolução-de-fenótipos-contínuos.html","id":"reconstrução-ancestral-de-dados-contínuos","chapter":"Capítulo 21 Modelos para evolução de fenótipos contínuos","heading":"21.2 Reconstrução ancestral de dados contínuos","text":"Vamos estimar o tamanho corporal ancestral para primatas, sob um modelo Browniano de evolução.\nfunções ace (ape) e fastAnc (phytools), entre outras, implementam reconstrução ancestral via maximum likelihood (encontrando os estados com verossimilhança máxima de terem surgido sob o modelo escolhido).Uma crítica comum reconstrução ancestral é que incerteza ao redor nós pode ser grande. entanto, se o modelo evolutivo está correto, estimativas são confiáveis (95% de chance de o valor estimado incluir o valor ‘real’). Em teoria, é possível corrigir estimativa se o valor de algum nó é conhecido (e.g., fóssil), como exemplo abaixo.","code":"\nrec<-fastAnc(tree,log(bodymass),vars=TRUE,CI=TRUE)\nrec\nprint(rec,printlen=10)\n{plotTree(tree,fsize=0.5,ftype=\"i\",type=\"fan\",lwd=1)\nnodelabels()}\n# Visualizando a reconstrução\nrec.map<-contMap(tree,log(bodymass))\nrec.map\n# customizando\nrec.map<-setMap(rec.map,invert=TRUE) # inverte cores\nplot(rec.map,type=\"fan\",fsize=0.5)\n# Modo fenograma 'traitgram'\npar(mfrow = c(1, 1),mar=c(4, 4, 2, 2))\nphe<-phenogram(tree,log(bodymass),ftype=\"i\",fsize=0.5)\n# Incerteza (CI 95%) nas estimativas dos nós\nfancyTree(tree,type=\"phenogram95\",x=log(bodymass),ftype=\"i\",fsize=0.5) # pode demorar\n# Adicionando barra de erros com cores\nrec.map<-contMap(tree,log(bodymass),fsize=0.5,ftype=\"i\")\nerrorbar.contMap(rec.map)\n# Reconstrução com valores de nós conhecidos\nrec$ace # estados ancestrais estimados\nanc.states<-rec$ace[as.character(c(78,80,82))]\nanc.states # valores estimados para nós 78 (raiz), 80 e 82\nanc.a<-c(4.2,5.1,5.3) # valores conhecidos\nnames(anc.a)=names(anc.states)\nanc.a\nrec.1<-fastAnc(tree,x=log(bodymass),anc.states=anc.a,vars=TRUE,CI=TRUE)\nprint(rec.1,printlen=10)\n# Comparando com a reconstrução original\nprint(rec,printlen=10)\n# Visualizando reconstrução com nós conhecidos\n# lista contendo valores terminais + estimados com fastAnc\nX<-c(log(bodymass),rec.1$ace)\npar(mfrow = c(1, 1),mar=c(4, 4, 2, 2))\nphenogram(tree,X,ftype=\"i\",fsize=0.5)"},{"path":"modelos-para-evolução-de-fenótipos-contínuos.html","id":"exercício---modelos-contínuos-e-variação-intraespecífica","chapter":"Capítulo 21 Modelos para evolução de fenótipos contínuos","heading":"21.3 Exercício - Modelos contínuos e variação intraespecífica","text":"Carregue os dados:\nprimate-data-erro.txt\nprimate-tree.txt\nEstime o sinal filogenético com estatística K, e ajuste e compare os modelos BM, OU e EB para os dados considerando variação intraespecífica.\nO arquivo de dados contém log de massa corporal para dez indivíduos de cada espécie de primata. Faça uma média de tamanho corporal por espécie e calcule o erro padrão da\nmédia.\nDescubra (leia documentação das funções ?phylosig e ?fitContinuous) como incorporar o erro padrão cálculo de sinal filogenético e ajuste de modelos.\nVocê pode usar função apply para calcular média e o desvio padrão da média (SD). O erro padrão da média (uma medida de quão precisa é estimativa da média) pode ser obtido através da fórmula SD/√N (N=tamanho da amostra) = se<-sd/sqrt(10).","code":""},{"path":"modelos-para-evolução-de-fenótipos-discretos.html","id":"modelos-para-evolução-de-fenótipos-discretos","chapter":"Capítulo 22 Modelos para evolução de fenótipos discretos","heading":"Capítulo 22 Modelos para evolução de fenótipos discretos","text":"Sobre o ajuste de modelos evolutivos para dados discretos leia (Yang 2006; Revell Harmon 2022).Vamos carregar os mesmos dados de primatas que usamos capítulo anterior. Os ajustes de modelos seguem mesma lógica. Aqui, vamos aplicar para fenótipos categóricos/discretos.O conjunto de dados contém atributos binários e categóricos informando o tamanho grupo social em primatas. Primeiro, vamos usar variável binária, que possui dois estados: Solitary vs. Social. Mais de 4 ind = solitary Menos de 4 ind = social","code":"\nrequire(ape)\n#> Le chargement a nécessité le package : ape\nrequire(phytools)\n#> Le chargement a nécessité le package : phytools\n#> Le chargement a nécessité le package : maps\nrequire(geiger)\n#> Le chargement a nécessité le package : geiger\n# Filogenia\ntree<-read.tree(\"dadospcm/primate-tree.txt\")\nplotTree(tree,fsize=0.4,ftype=\"i\",type=\"fan\",lwd=1)\n# Atributos\ndados<-read.table(\"dadospcm/primate-data.txt\",h=T,row.names=1)\nhead(dados)\n# Recortar filogenia\nmatch.species<-treedata(tree,dados)\ntree<-match.species$phy\nplotTree(tree,fsize=0.5,ftype=\"i\",type=\"fan\",lwd=1)\nbinsocial<-dados$BinSocial\nnames(binsocial)=rownames(dados)\nbinsocial<-as.factor(binsocial)\nbinsocial"},{"path":"modelos-para-evolução-de-fenótipos-discretos.html","id":"modelos-evolutivos-discretos","chapter":"Capítulo 22 Modelos para evolução de fenótipos discretos","heading":"22.1 Modelos evolutivos discretos","text":"Vamos usar função fit.Discrete pacote geiger para ajustar modelos que têm diferentes expectativas sobre taxas de transição entre os estados fenotípicos.","code":""},{"path":"modelos-para-evolução-de-fenótipos-discretos.html","id":"modelo-de-taxas-iguais","chapter":"Capítulo 22 Modelos para evolução de fenótipos discretos","heading":"22.1.1 Modelo de taxas iguais","text":"Equal rates (ER) (ou rates equal). Esse modelo tem um único parâmetro, taxa de transição, que é igual entre qualquer par de estados.","code":"\nER<-fitDiscrete(tree,binsocial,model=\"ER\")\nER\nplot(ER,signif=5)"},{"path":"modelos-para-evolução-de-fenótipos-discretos.html","id":"modelo-simétrico","chapter":"Capítulo 22 Modelos para evolução de fenótipos discretos","heading":"22.1.2 Modelo simétrico","text":"modelo simétrico (model=“SYM”), taxa de mudança entre qualquer par de estados é mesma independente da direção (estado 1 pra 2 é o mesmo que 2 pra 1; q12 = q21), mas taxa de mudança difere entre estados (estado 1 pra 2 não é o mesmo que 1 pra 3; q12/q21 ≠ q13/q31 ≠ q23/q32). Note que, para uma variável binária, o modelo simétrico é exatamente igual ao modelo equal rates.","code":""},{"path":"modelos-para-evolução-de-fenótipos-discretos.html","id":"modelos-com-todas-as-taxas-diferentes","chapter":"Capítulo 22 Modelos para evolução de fenótipos discretos","heading":"22.1.3 Modelos com todas as taxas diferentes","text":"rates different (ARD). Todas taxas são diferentes. Para S estados, o número de parâmetros (S²-S) pode aumentar rapidamente dependendo de quantos estados houver.Parece que taxa de mudança de solitário para social (0.010) é maior que taxa de mudança de social para solitário (0.005).","code":"\nARD<-fitDiscrete(tree,binsocial,model=\"ARD\")\nARD\nplot(ARD,signif=5)"},{"path":"modelos-para-evolução-de-fenótipos-discretos.html","id":"modelo-irreversível","chapter":"Capítulo 22 Modelos para evolução de fenótipos discretos","heading":"22.1.4 Modelo irreversível","text":"Nós também podemos ajustar um modelo em que transições de solitário para social são possíveis, mas o reverso não é possível. Para isso, podemos criar uma matriz Q representando transições entre estados.","code":"\nmatriz<-matrix(c(\n 0,0,\n 1,0),2,2,byrow=TRUE)\ncolnames(matriz)=rownames(matriz)=c(\"Social\",\"Solitary\")\nmatriz\nIR<-fitDiscrete(tree,binsocial,model=matriz)\nIR\n# Um warning é emitido quando qualquer parâmetro estiver nos limites (bounds) estabelecidos ou default.\nplot(IR,signif=5)"},{"path":"modelos-para-evolução-de-fenótipos-discretos.html","id":"comparação-de-modelos-1","chapter":"Capítulo 22 Modelos para evolução de fenótipos discretos","heading":"22.1.5 Comparação de modelos","text":"Assim como nos modelos contínuos, podemos comparar os modelos usando AIC.O modelo com taxas iguais de transição recebeu maior suporte, seguido modelo ARD.","code":"\nER$opt$aicc\nARD$opt$aicc\nIR$opt$aicc\naic.scores<-setNames(c(ER$opt$aicc,ARD$opt$aicc,IR$opt$aicc),\n c(\"ER\",\"ARD\",\"IR\"))\naic.scores\naicw(aic.scores) # Delta AICc e AICc weights"},{"path":"modelos-para-evolução-de-fenótipos-discretos.html","id":"exemplo-com-múltiplos-estados","chapter":"Capítulo 22 Modelos para evolução de fenótipos discretos","heading":"22.1.6 Exemplo com múltiplos estados","text":"Modelos com várias categorias com mais de dois estados são implementados com exatamente mesma lógica. Considere variável grupo social construída com várias categorias. Menos de 4 ind = solitary Entre 4 e 10 ind = pequeno Entre 10 e 30 ind = medio Mais de 31 ind = grandeModelo Ordenado. Biologicamente, faz sentido que o tamanho grupo social evolua de forma ordenada (e.g. solitário>pequeno>medio>grande). Podemos modificar matriz Q para permitir transições apenas entre estes estados.Comparando os modelos.Neste caso, o modelo em que tamanho grupo social pode mudar de maneira ordenada (solitário>pequeno>medio>grande & volta) teve muito mais suporte que os outros.","code":"\ncatsocial<-dados$CatSocial\nnames(catsocial)=rownames(dados)\ncatsocial\n# Modelos\n# ER\nER.grupo<-fitDiscrete(tree,catsocial,model=\"ER\")\nER.grupo\nplot(ER.grupo)\n# SYM\nSYM.grupo<-fitDiscrete(tree,catsocial,model=\"SYM\")\nSYM.grupo\nplot(SYM.grupo)\n# ARD\nARD.grupo<-fitDiscrete(tree,catsocial,model=\"ARD\") # Pode demorar\nARD.grupo\nplot(ARD.grupo)\nmatriz<-matrix(c(\n 0,1,0,0,\n 2,0,3,0,\n 0,4,0,5,\n 0,0,6,0),4,4,byrow=TRUE)\ncolnames(matriz)=rownames(matriz)=c(\"Grande\",\"Medio\",\"Pequeno\",\"Solitary\")\nmatriz\nOR.grupo<-fitDiscrete(tree,catsocial,model=matriz)\nOR.grupo\nplot(OR.grupo,show.zeros=FALSE)\naic.scores<-\nsetNames(c(ER.grupo$opt$aicc,SYM.grupo$opt$aicc,ARD.grupo$opt$aicc,OR.grupo$opt$aicc),\n c(\"ER\",\"SYM\",\"ARD\",\"OR\"))\naic.scores\naicw(aic.scores) # Delta AICc e AICc weights\naic.w(aic.scores)"},{"path":"modelos-para-evolução-de-fenótipos-discretos.html","id":"reconstrução-de-estados-ancestrais","chapter":"Capítulo 22 Modelos para evolução de fenótipos discretos","heading":"22.2 Reconstrução de estados ancestrais","text":"Para reconstrução ancestral de estados discretos, o modelo subjacente será o Markoviano (Mk model). função ace pacote ape realizada estimativa para caracteres discretos.linhas correspondem aos nós da árvore, e colunas são probabilidades de que o nó esteja estado 1 ou 2 (social ou solitária). Note que os nós retornados pelo ace estão formatados em sequência numérica começando 1, enquanto o formato phylo começa dar nome aos nós seguindo sequência n+1 (onde n é o número de espécies). É possível formatar os números das linhas para adequar ao formato phylo:Visualização de estados com gráficos de “pizza”.Estimativa de estados ancestrais com o modelo ARD.","code":"\n# Visualização dos atributos\n{plotTree(tree,fsize=0.5,ftype=\"i\")\ncores<-setNames(c(\"blue\",\"red\"),levels(binsocial))\ncores\ntiplabels(pie=to.matrix(binsocial[tree$tip.label],levels(binsocial)),piecol=cores,cex=0.3)\nlegend(\"bottomleft\",legend=c(\"Social\",\"Solitary\"),pch=15,col=cores,bty=\"n\")}\n# Estimativa de estados ancestrais com modelo ER\nERanc<-ace(binsocial,tree,type=\"discrete\",model=\"ER\")\nERanc\n# Estados ancestrais\nERanc$lik.anc\nnode.states<-ERanc$lik.anc\nrownames(node.states) <- seq(1:nrow(node.states)) + length(tree$tip.label)\nnode.states\n{plotTree(tree,fsize=0.5,ftype=\"i\")\nnodelabels(pie = ERanc$lik.anc, piecol = cores, cex = 0.5)\ntiplabels(pie=to.matrix(binsocial[tree$tip.label],levels(binsocial)),piecol=cores,cex=0.3)\nlegend(\"bottomleft\",legend=c(\"Social\",\"Solitary\"),pch=15,col=cores,bty=\"n\")}\nARDanc<-ace(binsocial,tree,type=\"discrete\",model=\"ARD\")\nARDanc\n{plotTree(tree,fsize=0.5,ftype=\"i\")\nnodelabels(pie = ARDanc$lik.anc, piecol = cores, cex = 0.5)\ntiplabels(pie=to.matrix(binsocial[tree$tip.label],levels(binsocial)),piecol=cores,cex=0.3)\nlegend(\"bottomleft\",legend=c(\"Social\",\"Solitary\"),pch=15,col=cores,bty=\"n\")}"},{"path":"modelos-para-evolução-de-fenótipos-discretos.html","id":"mapeamento-estocástico-de-caracteres","chapter":"Capítulo 22 Modelos para evolução de fenótipos discretos","heading":"22.2.1 Mapeamento estocástico de caracteres","text":"Existe outra alternativa às estimativas acima, que usa MCMC (Bayesiano) para amostrar histórias partir de uma distribuição contendo muitos (milhares de) resultados (o que chamamos de distribuição posterior de probabilidades). Assim, os modelos são os mesmos usados anteriormente (ER, ARD), mas final é obtida uma amostra de histórias que são únicas e não ambíguas, ou seja, cada etapa na árvore pode conter apenas um estado, ao invés da probabilidade de todos os estados para cada nó. Pra se aprofundar, leia Huelsenbeck, Nielsen, Bollback (2003), Revell Harmon (2022).Poderíamos comparar probabilidades posteriores stochastic mapping com probabilidades de estados diferentes pelo ace. probabilidades devem se tornar mesmas conforme o número de mapas estocásticos aumenta ao infinito.","code":"\n# Função make.simmap do phytools\nanc.tree<-make.simmap(tree,binsocial,model=\"ER\")\n#> Done.\n{plot(anc.tree,cores,fsize=0.5,ftype=\"i\")\nadd.simmap.legend(colors=cores,prompt=FALSE,x=-2*par()$usr[1],y=-5*par()$usr[3],fsize=0.8)}\nanc.tree<-make.simmap(tree,binsocial,model=\"ER\",nsim=100) # ex: 100\n#> Done.\nanc.tree\n# Resumindo múltiplas árvores\npd<-summary(anc.tree)\npd\n{plot(pd,fsize=0.5,ftype=\"i\",colors=cores)\nadd.simmap.legend(colors=cores,prompt=FALSE,x=1,y=10)}\n# Plotando pizza sobre um mapa ao acaso\n#{plot(sample(anc.tree,1),fsize=0.5,ftype=\"i\",colors=cores)\n#nodelabels(pie=pd$ace,piecol=cores,cex=0.5)\n#add.simmap.legend(colors=cores,prompt=FALSE,x=1,y=10)}"},{"path":"modelos-para-evolução-de-fenótipos-discretos.html","id":"exercício---modelos-discretos","chapter":"Capítulo 22 Modelos para evolução de fenótipos discretos","heading":"22.3 Exercício - Modelos discretos","text":"Carregue os mesmos dados:\nprimate-data.txt\nprimate-tree.txt\nUsando variável categórica com múltiplos grupos sociais (catsocial), ajuste um modelo ordenado direcional onde o tamanho grupo social pode aumentar mas nunca diminuir (.e. Solitary>Pequeno>Medio>Grande mas sem retorno). Compare este modelo com os quatro anteriores e descubra qual recebe maior suporte.","code":""},{"path":"regressão-filogenética.html","id":"regressão-filogenética","chapter":"Capítulo 23 Regressão filogenética","heading":"Capítulo 23 Regressão filogenética","text":"Esse capítulo implementa contrastes filogenéticos independentes (PIC) (Felsenstein 1985), regressão filogenética generalizada por quadrados mínimos (PGLS) (Grafen 1989) e regressão de autovetores filogenéticos (PVR) (Diniz-Filho, de Sant’Ana, Bini 1998).","code":""},{"path":"regressão-filogenética.html","id":"contrastes-filogenéticos-independentes-1","chapter":"Capítulo 23 Regressão filogenética","heading":"23.1 Contrastes filogenéticos independentes","text":"Vamos investigar relação evolutiva entre força da mordida e tamanho crânio em um gênero de roedores. Pra isso, vamos precisar dos dados fenotípicos e pelo menos uma hipótese filogenética.Carregar dados fenotípicos.Antes, vamos ajustar um modelo ordinário (OLS), sem levar filogenia em consideração, apenas como exemplo didático. Na prática, você não deve/precisa fazer isso.Como os dados são de espécies diferentes, o pressuposto de independência dos resíduos modelo é violado. Uma maneira de levar em consideração filogenia é através dos Contrastes Filogenéticos Independentes.Como podemos perceber, para estes dados não existe muita diferença nos resultados levando em consideração filogenia. Isso nem sempre vai ser o caso. Nós podemos simular condições para visualizar como levar em conta filogenia pode ter uma consequência grande.Mesmo os dados tendo sidos simulados independentemente (na ausência de correlação entre x e y) nós podemos ver que existe uma correlação entre os dados induzida pela filogenia (erro tipo ).\nPodemos plotar filogenia espaço de forma para descobrir o motivo:","code":"\ndados<-read.table(\"dadospcm/akodon.txt\",h=T)\ndados\nattach(dados)\n# OLS\nfit.ols<-lm(bite_force~skull_length,data=dados)\nsummary(fit.ols)\n{plot(skull_length,bite_force,\n xlab=\"skull length (log)\",\n ylab=\"bite force (log)\",pch=21,bg=\"grey\",cex=1.5)\nabline(fit.ols,col=\"red\")}\n# PIC\nrequire(ape)\n#> Le chargement a nécessité le package : ape\nakodon.tree<-read.tree(file=\"dadospcm/akodon.tree\")\nplot(akodon.tree)\nakodon.tree\n# Atribuindo nomes para os dados\nskull_length<-setNames(skull_length,species)\nskull_length\nbite_force<-setNames(bite_force,species)\nbite_force\n# Calculando os contrastes\npic.sl<-pic(skull_length,akodon.tree)\npic.bf<-pic(bite_force,akodon.tree)\n# Modelo PIC\nfit.pic<-lm(pic.bf~pic.sl+0)\nfit.pic\nsummary(fit.pic)\nplot(pic.sl,pic.bf,\n xlab=\"PICs for skull length\",\n ylab=\"PICs for bite force\",pch=21,bg=\"grey\",cex=1.5)\nabline(fit.pic,col=\"red\")\n# PIC dados simulados\nrequire(phytools)\n#> Le chargement a nécessité le package : phytools\n#> Le chargement a nécessité le package : maps\n# set seed (starting point na geração de sequência aleatória, assim todos teremos os mesmos resultados)\nset.seed(4)\n# simular uma árvore filogenética\ntree<-rcoal(n=80)\nplotTree(tree,ftype=\"off\")\n# simular 2 atributos (independentemente) evoluindo por movimento Browniano na filogenia\nx<-fastBM(tree)\ny<-fastBM(tree)\npar(mar=c(5,4,2,2))\n# Ajustar OLS\nplot(x,y,pch=21,bg=\"grey\",cex=1.5)\nfit.OLS<-lm(y~x)\n{plot(x,y,pch=21,bg=\"grey\",cex=1.5)\nabline(fit.OLS,col=\"red\")}\nsummary(fit.OLS)\n{phylomorphospace(tree,cbind(x,y),label=\"off\",node.size=c(0,0))\npoints(x,y,pch=21,bg=\"grey\",cex=1.5)\nabline(fit.OLS,col=\"red\",lwd=2)}\n# Ajustando PIC\npic.x<-pic(x,tree)\npic.y<-pic(y,tree)\nfit.pic<-lm(pic.y~pic.x+0)\nsummary(fit.pic)\nsummary.aov(fit.pic)"},{"path":"regressão-filogenética.html","id":"regressão-filogenética-generalisada-por-quadrados-mínimos","chapter":"Capítulo 23 Regressão filogenética","heading":"23.2 Regressão filogenética generalisada por quadrados mínimos","text":"Vários pacotes realizam PGLS R. Vamos usar os mais comuns - ape/nlme + caper. PGLS usa uma matriz de covariância entre espécies de acordo com algum processo evolutivo (BM, Pagel, OU, outros).Vamos carregar alguns dados de borboletas.Conferir correspondência entre espécies nos dados fenotópicos e na árvore filogenética.PGLS com os pacotes ape e nlme.É possível usar outras estruturas de covariância. Um dos modelos mais comuns usa o λ de Pagel. Esse modelo tem um parâmetro adicional (λ) que estima o sinal filogenético nos resíduos; os elementos -diagonal são multiplicados pelo valor de lambda estimado, que varia entre 0 e 1. Quando λ=0 covariância entre espécies é zero, e regressão filogenética = regressão comum. Quando λ=1 covariação é igual ao esperado pelo modelo Browniano (= PIC).PGLS pode ser aplicada em um contexto de regressão múltipla.PGLS com o pacote caper.\nO caper tem um objeto especial ‘comparative data’ para combinar todos os dados.Com o caper é possível plotar gráficos de diagnostico facilmente.O que olhar nesses plots:\ngráfico 1, dados com resíduos maiores que +- 3 podem ser outliers. Os pontos QQ-plot (gráfico 2) devem cair aproximadamente sobre linha. Os gráficos 3 e 4 devem mostrar uma distribuição mais ou menos randômica, sem padrões aparentes.Como qualquer outro modelo linear, também é preciso prestar atenção ao número de preditores e número de termos estimados modelo em relação ao número deobservações (espécies). Uma “regra” simples é usar +- 10 vezes mais espécies que termos estimados (incluindo intercepto, interações, e o parâmetro lambda, por exemplo).","code":"\nrequire(ape)\ndados<-read.table(\"dadospcm/butterfly-data.txt\",h=T,row.names = 1)\ndados\nattach(dados)\nwing_length<-setNames(wing_length,rownames(dados))\ntemp<-setNames(temp,rownames(dados))\neye_width<-setNames(eye_width,rownames(dados))\n# Carregar árvore\ntree<-read.tree(\"dadospcm/butterfly-tree.txt\")\n{plot(tree)\naxisPhylo()}\nrequire(geiger)\n#> Le chargement a nécessité le package : geiger\nobj<-name.check(tree,dados)\nobj\n# 59 espécies na árvore não contêm dados\n# remover espécies da árvore\ntree.pruned<-drop.tip(tree,obj$tree_not_data)\nname.check(tree.pruned,dados)\nplot(tree.pruned)\nrequire(ape)\nrequire(nlme)\n#> Le chargement a nécessité le package : nlme\n# Estrutura de covariação Browniana\nBM<-corBrownian(1,tree.pruned)\nBM\n# Podemos ajustar um modelo PGLS para investigar a relação entre temperatura e \n#comprimento da asa\nmodelo1<-gls(wing_length~temp,data=dados,correlation=BM)\nsummary(modelo1)\n# Plots de diagnóstico\nqqnorm(modelo1$residuals)\n# Comparando com OLS, os resultados são similares\nmodelo.ols<-lm(wing_length~temp)\nsummary(modelo.ols)\n# Plotando os resultados\n{plot(temp,wing_length,pch=21,bg=\"grey\",cex=1.5)\nabline(modelo.ols,col=\"red\",lty=\"dashed\",lwd=2)\nabline(modelo1,col=\"blue\",lty=\"dashed\",lwd=2)}\nmodelo2<-gls(wing_length~temp,data=dados,correlation=corPagel(1,tree.pruned))\nsummary(modelo2)\n{plot(temp,wing_length,pch=21,bg=\"grey\",cex=1.5)\nabline(modelo.ols,col=\"red\",lty=\"dashed\",lwd=2)\nabline(modelo1,col=\"blue\",lty=\"dashed\",lwd=2)\nabline(modelo2,col=\"green\",lty=\"dashed\",lwd=2)}\nmodelo3<-\ngls(wing_length~eye_width+temp,data=dados,correlation=corPagel(1,tree.pruned))\nsummary(modelo3)\nrequire(caper)\n#> Le chargement a nécessité le package : caper\n#> Le chargement a nécessité le package : MASS\n#> Le chargement a nécessité le package : mvtnorm\ndados<-read.table(\"dadospcm/butterfly-data.txt\",header=T)\ncomp.data<-comparative.data(tree.pruned,dados,names.col='species')\n# pgls usando lambda\nmodelo4<-pgls(wing_length~temp,data = comp.data,lambda=\"ML\")\nsummary(modelo4)\npar(mfrow = c(2, 2))\nplot(modelo4)\npar(mfrow = c(1, 1))"},{"path":"regressão-filogenética.html","id":"regressão-de-autovetores-filogenéticos","chapter":"Capítulo 23 Regressão filogenética","heading":"23.3 Regressão de autovetores filogenéticos","text":"Regressão de autovetores filogenéticos e Curva PSR com o pacote PVR. Veja o capítulo sobre Sinal Filogenético pra mais detalhes sobre análises.","code":"\nrequire(PVR)\n#> Le chargement a nécessité le package : PVR\n#> Warning: le package 'PVR' a été compilé avec la version R\n#> 4.3.2\n#> PVR 0.3 loaded\n# Decomposição de matriz de distância filogenética\npvr_obj<-PVRdecomp(tree.pruned)\n# Regressão de autovetores filogenéticos\npvr_reg<-PVR(pvr_obj,tree.pruned,wing_length,temp)\n# Porcentagem de cada componente\npvr_reg@VarPart\n#> $a\n#> [1] 0.3326349\n#> \n#> $b\n#> [1] 0.1093753\n#> \n#> $c\n#> [1] 0.08198286\n#> \n#> $d\n#> [1] 0.4760069\nVarPartplot(pvr_reg)#> [a] - Variation explained by environmental variables\n#> [b] - Shared variation between environmental variables and phylogeny(PVR)\n#> [c] - Variation explained by phylogeny(PVR)\n#> [d]     - Unexplained variation\n# Sinal Filogenético com PSR Curve\npsr_obj<-PSR(pvr_obj,trait=wing_length,\nnull.model=TRUE,Brownian.model=TRUE,times=10)\nPSRplot(psr_obj,info=\"both\")"},{"path":"regressão-filogenética.html","id":"exercício---regressão-filogenética","chapter":"Capítulo 23 Regressão filogenética","heading":"23.4 Exercício - Regressão filogenética","text":"Carregue os dois conjuntos de dados:\npic-dados.txt\npic-arvore.tre\nAjuste uma regressão não-filogenética e uma regressão filogenética aos dados usando contrastes independentes. Quais foram os resultados? Qual interpretação?","code":""},{"path":"correlação-de-fenótipos-discretos.html","id":"correlação-de-fenótipos-discretos","chapter":"Capítulo 24 Correlação de fenótipos discretos","heading":"Capítulo 24 Correlação de fenótipos discretos","text":"Esse capítulo implementa algumas análises que são úteis quando variável resposta é de interesse é categórica/discreta.","code":""},{"path":"correlação-de-fenótipos-discretos.html","id":"correlação-de-fenótipos-binários","chapter":"Capítulo 24 Correlação de fenótipos discretos","heading":"24.1 Correlação de fenótipos binários","text":"Vamos carregar filogenia e fenótipos de espécies de primatas e investigar associação evolutiva entre o tamanho grupo social (solitario vs. social) e o tamanho da área de vida (Pequena < 300m² > Grande).O primeiro passo é visualizar os dados junto com árvore.Agora, vamos implementar o teste de Pagel (1994), que compara um modelo de evolução independente entre os caracteres (ausência de correlação) com um modelo de evolução dependente (presença de correlação).\nO P valor é um indício de que o modelo dependente é melhor (podemos rejeitar o modelo independente com P<alpha).Podemos comparar os modelos dependente e independente com modelos onde taxa de mudança em Grupo Social depende de Área (dep.var=“binsocial”) mas não o contrário, ou onde taxa de mudança em Área depende Grupo Social (dep.var=“area”) mas não o contrário.Comparação de modelos.O maior peso está para o modelo de dependência de Área para Grupo, mas o modelo de dependência mútua também recebeu forte suporte.","code":"\nrequire(ape)\n#> Le chargement a nécessité le package : ape\nrequire(phytools)\n#> Le chargement a nécessité le package : phytools\n#> Le chargement a nécessité le package : maps\nrequire(geiger)\n#> Le chargement a nécessité le package : geiger\n# Filogenia\ntree<-read.tree(\"dadospcm/primate-tree.txt\")\nplotTree(tree,fsize=0.4,ftype=\"i\",type=\"fan\",lwd=1)\n# Atributos\ndados<-read.table(\"dadospcm/primate-data.txt\",h=T,row.names=1)\nhead(dados)\n# Recortar filogenia\nmatch.species<-treedata(tree,dados)\ntree<-match.species$phy\nplotTree(tree,fsize=0.5,ftype=\"i\",type=\"fan\",lwd=1)\n# Grupo Social\nbinsocial<-dados$BinSocial\nnames(binsocial)=rownames(dados)\nbinsocial<-as.factor(binsocial)\nbinsocial\n# Area de Vida\narea<-dados$AreaVida\nnames(area)=rownames(dados)\narea<-as.factor(area)\narea\n# Visualizando os dados binários\npar(mfrow=c(1,2))\n{plot(tree,show.tip.label=FALSE,no.margin=TRUE)\ncores<-setNames(c(\"blue\",\"red\"),levels(binsocial))\ntiplabels(pie=to.matrix(binsocial[tree$tip.label],levels(binsocial)),\n piecol=cores,cex=0.5)\nlegend(\"bottomleft\",legend=c(\"Social\",\"Solitary\"),pch=15,col=cores,bty=\"n\")\nplot(tree,show.tip.label=FALSE,no.margin=TRUE,direction=\"leftwards\")\ncores<-setNames(c(\"blue\",\"red\"),levels(area))\ntiplabels(pie=to.matrix(area[tree$tip.label],levels(area)),\n piecol=cores,cex=0.5)\nlegend(\"bottomright\",legend=c(\"Grande\",\"Pequena\"),pch=15,col=cores,bty=\"n\")}\npar(mfrow=c(1,1))\nfit.AS<-fitPagel(tree,binsocial,area,model=\"ARD\")\nfit.AS\nplot(fit.AS)\nplot(fit.AS,lwd.by.rate=TRUE)\n# Dependente X - Mudança em Grupo Social depende da Area\nfit.GS<-fitPagel(tree,binsocial,area,dep.var=\"x\")\nfit.GS\nplot(fit.GS,lwd.by.rate=TRUE)\n# Dependente Y - Mudança em Area depende de Grupo Social\nfit.AR<-fitPagel(tree,binsocial,area,dep.var=\"y\")\nfit.AR\nplot(fit.AR,lwd.by.rate=TRUE)\naic.scores<-setNames(c(fit.AS$independent.AIC,\n fit.GS$dependent.AIC,\n fit.AR$dependent.AIC,\n fit.AS$dependent.AIC),\n c(\"independente\",\"dependente Grupo\",\n \"dependente Area\",\"dependente Grupo&Area\"))\naic.scores\naicw(aic.scores)"},{"path":"correlação-de-fenótipos-discretos.html","id":"correlação-de-fenótipos-categóricos-multiestado","chapter":"Capítulo 24 Correlação de fenótipos discretos","heading":"24.2 Correlação de fenótipos categóricos multiestado","text":"correlação entre atributos categóricos multiestado pode ser feita com estatística D de Huelsenbeck, Nielsen, Bollback (2003), implementada pacote phytools com função Dtest.","code":""},{"path":"correlação-de-fenótipos-discretos.html","id":"exercício---correlação-de-fenótipos-discretos","chapter":"Capítulo 24 Correlação de fenótipos discretos","heading":"24.3 Exercício - Correlação de fenótipos discretos","text":"Carregue os dados: Árvore: Pagel.tre Dados: Pagel.txt Teste correlação entre os caracteres x1 e y1 usando fitPagel. Quais foram os resultados? Visualize distribuição dos caracteres na árvore. O que isso te informa sobre os resultados?","code":""},{"path":"evolução-multi-taxa-e-multi-regime.html","id":"evolução-multi-taxa-e-multi-regime","chapter":"Capítulo 25 Evolução multi-taxa e multi-regime","heading":"Capítulo 25 Evolução multi-taxa e multi-regime","text":"Modelos mais complexos que permitem que os parâmetros σ2, α, e θ (taxa evolutiva, força de seleção e valor ótimo, respectivamente) variem entre regimes evolutivos/ótimos ambientais podem ser implementados R. É possível criar hipóteses onde os ótimos, taxas ou os alpha variem, em qualquer combinação. entanto, é preciso estar atento ao fato de que modelos mais complexos vão estimar muitos parâmetros e podem gerar -fitting se o número de parâmetros parecido com o\nnúmero de observações (espécies).Neste capítulo, vamos implementar modelos onde variável resposta é univariada com o pacote OUwie, que tem seguinte estrutura para os argumentos/modelos:\n1. BM1 - Modelo Browniano com um único valor de taxa evolutiva (rate) para toda árvore;\n2. BMS - Modelo Browniano com diferentes taxas evolutivas de acordo com os estados na árvore;\n3. OU1 - Modelo Ornstein-Uhlenbeck com um único ótimo para todas espécies;\n4. OUM - Modelo OU com diferentes ótimos de acordo com os estados, mas um único alpha e sigma2 para todos os regimes seletivos;\n4.1. OUMV - Modelo OU com diferentes médias de estados (ótimos), diferentes sigma2, mesmo alpha;\n4.2. OUMA - Modelo OU com diferentes médias de estados (ótimos), diferentes alpha, mesmo sigma2;\n4.3. OUMVA - Modelo OU com múltiplos theta, alpha e sigma2.O OUwie precisa de um dataframe com três colunas: nomes das espécies, o código regime, e o atributo contínuo de interesse.O OUwie requer uma filogenia onde os nós internos estejam rotulados com o regime seletivo ancestral, que foi o que fizemos na reconstrução ancestral de atributos discretos.O ace retorna probabilidade de cada estado em cada nó. Precisamos de uma árvore única com o “melhor” estado para cada nó (alternativamente, podemos usar o make.simmap como fizemos anteriormente, e ajustar um modelo para cada N histórias). Nós podemos encontrar o estado com maior probabilidade em cada nó, e atribuir esse valor aos nós de uma árvore em formato phylo.","code":"\nrequire(ape)\n#> Le chargement a nécessité le package : ape\nrequire(geiger)\n#> Le chargement a nécessité le package : geiger\n#> Le chargement a nécessité le package : phytools\n#> Le chargement a nécessité le package : maps\nrequire(phytools)\nrequire(OUwie)\n#> Le chargement a nécessité le package : OUwie\n#> Le chargement a nécessité le package : corpcor\n#> Le chargement a nécessité le package : nloptr\n#> Le chargement a nécessité le package : RColorBrewer\n# Carregar dados\ndados<-read.table(\"dadospcm/sigmodontinae-atributos.txt\",h=T,row.names=1)\nhead(dados)\ndiet<-as.factor(dados$Diet) # A dieta é um código (Onivoro-1; Herbivoro-2; Insetivoro-3)\nnames(diet)=rownames(dados)\nsize<-dados$Size\nnames(size)=rownames(dados)\n# Carregar filogenia\ntree<-read.nexus(\"dadospcm/sigmodontinae-tree.tre\")\nplotTree(tree,fsize=0.4,ftype=\"i\",type=\"fan\",lwd=1)\nstr(tree)\n# Match Species\nmatch.species<-treedata(tree,dados)\ntree<-match.species$phy\nstr(tree)\nplotTree(tree,fsize=0.5,ftype=\"i\",type=\"fan\",lwd=1)\n# Reconstruir evolução da dieta\ndiet.anc<-ace(diet,tree,type=\"discrete\",model=\"ER\")\ndiet.anc\n# Primeiro, corrigimos a ordem númerica no nome dos nós para n+1\nnode.states<-diet.anc$lik.anc\nrownames(node.states) <- seq(1:nrow(node.states)) + length(tree$tip.label)\nnode.states\n# Extraímos o estado mais provável de cada nó\nbest<-apply(node.states,1,which.max)\nbest\n# Incluimos esses valores na árvore\ntree$node.label<-best\ntree"},{"path":"evolução-multi-taxa-e-multi-regime.html","id":"ajuste-de-modelos-evolutivos","chapter":"Capítulo 25 Evolução multi-taxa e multi-regime","heading":"25.1 Ajuste de modelos evolutivos","text":"","code":""},{"path":"evolução-multi-taxa-e-multi-regime.html","id":"browniano-com-taxa-única","chapter":"Capítulo 25 Evolução multi-taxa e multi-regime","heading":"25.1.1 Browniano com taxa única","text":"Apha=NA pois este é um modelo Browniano. Mesmo valor de sigma.sq = taxa única. Optima é o valor estimado na raiz.","code":"\nBM1<-OUwie(tree,dados,model=\"BM1\")\nBM1"},{"path":"evolução-multi-taxa-e-multi-regime.html","id":"browniano-com-múltiplas-taxas","chapter":"Capítulo 25 Evolução multi-taxa e multi-regime","heading":"25.1.2 Browniano com múltiplas taxas","text":"Taxa de evolução de tamanho para insetívoros é mais rápida que para outros grupos. Mas ainda não sabemos se esse é o modelo evolutivo com maior suporte.","code":"\nBMS<-OUwie(tree,dados,model=\"BMS\")\nBMS"},{"path":"evolução-multi-taxa-e-multi-regime.html","id":"ou-com-um-único-ótimo","chapter":"Capítulo 25 Evolução multi-taxa e multi-regime","heading":"25.1.3 OU com um único ótimo","text":"","code":"\nOU1<-OUwie(tree,dados,model=\"OU1\")\nOU1"},{"path":"evolução-multi-taxa-e-multi-regime.html","id":"ou-com-múltiplos-ótimos","chapter":"Capítulo 25 Evolução multi-taxa e multi-regime","heading":"25.1.4 OU com múltiplos ótimos","text":"Tamanho ‘ótimo’ para cada dieta é estimado, porém o alpha neste caso é muito próximo de zero.","code":"\nOUM<-OUwie(tree,dados,model=\"OUM\")\nOUM"},{"path":"evolução-multi-taxa-e-multi-regime.html","id":"ou-com-múltiplos-ótimos-taxas-e-forças-de-seleção","chapter":"Capítulo 25 Evolução multi-taxa e multi-regime","heading":"25.1.5 OU com múltiplos ótimos, taxas, e forças de seleção","text":"","code":"\n# OU múltiplos otimos, multiplos sigma2\nOUMV<-OUwie(tree,dados,model=\"OUMV\")\nOUMV\n# OU múltiplos otimos, multiplos alpha\nOUMA<-OUwie(tree,dados,model=\"OUMA\")\nOUMA\n# OU multiplos otimos, alpha e sigma2\nOUMVA<-OUwie(tree,dados,model=\"OUMVA\")\nOUMVA"},{"path":"evolução-multi-taxa-e-multi-regime.html","id":"comparação-de-modelos-2","chapter":"Capítulo 25 Evolução multi-taxa e multi-regime","heading":"25.1.6 Comparação de modelos","text":"","code":"\naic.scores<-\nsetNames(c(BM1$AICc,BMS$AICc,OU1$AICc,OUM$AICc,OUMV$AICc,OUMA$AICc,OUMVA$AICc),\n c(\"BM1\",\"BMS\",\"OU1\",\"OUM\",\"OUMV\",\"OUMA\",\"OUMVA\"))\naic.scores\naicw(aic.scores) # Delta AICc e AICc weights"},{"path":"métodos-filogenéticos-multivariados.html","id":"métodos-filogenéticos-multivariados","chapter":"Capítulo 26 Métodos filogenéticos multivariados","heading":"Capítulo 26 Métodos filogenéticos multivariados","text":"evolução morfológica é inerentemente multivariada Capítulo 3. Contudo, variáveis resposta multivariadas representam um desafio analítico, especialmente para dados altamente multidimensionais. Neste capítulo, vamos explorar alguns métodos que permitem responder questões biológicas interessantes quando o nosso fenótipo de interesse é multivariado.Primeiro, vamos carregar uma matriz resposta multivariada e uma filogenia. exemplo, matriz contém 26 colunas com coordenadas de Procrustes que descrevem forma da mandíbula de 176 espécies de roedores sigmodontineos.","code":"\nrequire(ape)\n#> Le chargement a nécessité le package : ape\nrequire(geiger)\n#> Le chargement a nécessité le package : geiger\n#> Le chargement a nécessité le package : phytools\n#> Le chargement a nécessité le package : maps\nrequire(phytools)\nrequire(geomorph)\n#> Le chargement a nécessité le package : geomorph\n#> Le chargement a nécessité le package : RRPP\n#> Le chargement a nécessité le package : rgl\n#> Le chargement a nécessité le package : Matrix\n# Carregar dados\ndados<-read.table(\"dadospcm/sigmodontinae-shape.txt\",h=T,row.names=1)\nhead(dados)\ndiet<-as.factor(dados$Diet) # A dieta é um código (Onivoro-1; Herbivoro-2; Insetivoro-3)\nnames(diet)=rownames(dados)\nforma<-dados[,3:28]\nforma\n# Carregar filogenia\ntree<-read.nexus(\"dadospcm/sigmodontinae-tree.tre\")\nplotTree(tree,fsize=0.4,ftype=\"i\",type=\"fan\",lwd=1)\n# Match Species\nmatch.species<-treedata(tree,dados)\ntree<-match.species$phy\nstr(tree)\nplotTree(tree,fsize=0.5,ftype=\"i\",type=\"fan\",lwd=1)"},{"path":"métodos-filogenéticos-multivariados.html","id":"sinal-filogenético-1","chapter":"Capítulo 26 Métodos filogenéticos multivariados","heading":"26.1 Sinal filogenético","text":"","code":"\nphysignal(as.matrix(forma),tree)"},{"path":"métodos-filogenéticos-multivariados.html","id":"filomorfoespaço-1","chapter":"Capítulo 26 Métodos filogenéticos multivariados","heading":"26.2 Filomorfoespaço","text":"","code":"\n# Phylomorphospace\nPCA<-princomp(forma)\npar(mfrow=c(1,1),mar=c(5,4,2,2))\nphylomorphospace(tree,PCA$scores[,1:2],label=\"off\",control=list())\n# terminais com cores\n{phylomorphospace(tree,PCA$scores[,1:2],label=\"off\",control=list(col.node=NULL))\ncores<-setNames(c(\"blue\",\"red\",\"green\"),levels(diet))\ncol.group<-cores[match(diet,names(cores))]\npoints(PCA$scores[,1],PCA$scores[,2],col=col.group,pch=16,cex=1.7)\nlegend(-0.10,-0.06,legend=c(\"On\",\"Hb\",\"In\"),pch=19,col=c(\"blue\",\"red\",\"green\"))}\n# 3D\n#phylomorphospace3d(tree,PCA$scores[,1:3],control=list(ftype=\"off\"))"},{"path":"métodos-filogenéticos-multivariados.html","id":"pca-filogenética-1","chapter":"Capítulo 26 Métodos filogenéticos multivariados","heading":"26.3 PCA filogenética","text":"","code":"\npPCA<-phyl.pca(tree,forma,method=\"lambda\",opt=\"REML\")\n{phylomorphospace(tree,pPCA$S[,1:2],label=\"off\")\npoints(pPCA$S[,1],pPCA$S[,2],col=col.group,pch=16,cex=1.7)\nlegend(-0.10,-0.05,legend=c(\"On\",\"Hb\",\"In\"),pch=19,col=c(\"blue\",\"red\",\"green\"))}"},{"path":"métodos-filogenéticos-multivariados.html","id":"pgls","chapter":"Capítulo 26 Métodos filogenéticos multivariados","heading":"26.4 PGLS","text":"","code":"\n# PGLS Multivariada\n# Ajuste de formato da matriz para tornar compatível com o geomorph\nforma.array<-arrayspecs(forma,p=13,k=2) # transformação em array\nforma<-two.d.array(forma.array) # transformar de volta em matriz 2D\n# PGLS\nfit.pgls<-procD.pgls(forma~diet,tree)\nsummary(fit.pgls)"},{"path":"métodos-filogenéticos-multivariados.html","id":"comparação-de-taxas-evolutivas","chapter":"Capítulo 26 Métodos filogenéticos multivariados","heading":"26.5 Comparação de taxas evolutivas","text":"","code":"\nforma.array<-arrayspecs(forma,p=13,k=2) # transformação em array\ncompare.evol.rates(forma.array,tree,diet)"},{"path":"métodos-filogenéticos-multivariados.html","id":"modelos-contínuos-multivariados","chapter":"Capítulo 26 Métodos filogenéticos multivariados","heading":"26.6 Modelos contínuos multivariados","text":"O pacote mvMORPH (clavel2015?) permite ajustar modelos evolutivos (e.g. BM,OU,EB) onde variável de interesse é multivariada, e comparar os modelos usando verosimilhança (likelihood) e AIC. De forma mais acentuada que caso univariado, o número de parâmetros estimados pelo modelo pode ser um problema quando variável de interesse é multi-dimensional (highly-dimensional datasets), como caso de dados obtidos por morfometria geométrica. confiabilidade ajuste de modelos para Componentes Principais (PCs) individuais é baixa e pode ser enganosa, levando ao suporte incorreto para EB e OU (uyeda2015?). confiabilidade ajuste de modelos para um conjunto de PCs selecionados sob algum critério ainda é debatida. Atualmente, não existem métodos totalmente adequados (extensões diretas de métodos univariados) para ajustar modelos complexos para dados multidimensionais (adams&collyer2018?), porém veja os modelos com verossimilhança penalizada (clavel2019?), (clavel-morlon2020?).Como exemplo, e para reduzir o tempo computacional, vamos considerar os dois primeiros componentes principais da forma PCA$scores[,1:2]. Vamos trabalhar com modelos que são análogos ao univariados:\n1. BM1 - Browniano taxa única\n2. BMM - Browniano múltiplas taxas\n3. EB - Early Burst (taxas evolutivas desaceleram com o tempo) 4. OU1 - OU com único ótimo adaptativo\n5. OUM - OU com múltiplos ótimosComparando modelos.","code":"\nrequire(mvMORPH)\n#> Le chargement a nécessité le package : mvMORPH\n#> Le chargement a nécessité le package : corpcor\n#> Le chargement a nécessité le package : subplex\n#> ##\n#> ## mvMORPH package (1.1.7)\n#> ## Multivariate evolutionary models\n#> ##\n#> ## See the tutorials: browseVignettes(\"mvMORPH\")\n#> ##\n#> ## To cite package 'mvMORPH': citation(\"mvMORPH\")\n#> ##\n#> \n#> Attachement du package : 'mvMORPH'\n#> L'objet suivant est masqué depuis 'package:geiger':\n#> \n#>     aicw\n# Árvore filogenética com reconstrução em formato SIMMAP\nanc.tree<-make.simmap(tree,diet,model=\"ER\",nsim=1)\n#> Done.\nanc.tree\nplot(anc.tree,cores,fsize=0.5,ftype=\"i\")\n# Ajuste modelos evolutivos multivariados\n# BM taxa única\nmulti.BM1<-mvBM(anc.tree,PCA$scores[,1:2],model=\"BM1\")\nmulti.BM1\n# BM múltiplas taxas\nmulti.BMM<-mvBM(anc.tree,PCA$scores[,1:2],model=\"BMM\")\nmulti.BMM\nmulti.BMM$param$nparam\n# Early-Burst\nmulti.EB<-mvEB(anc.tree,PCA$scores[,1:2])\nmulti.EB\n# OU otimo unico\nmulti.OU1<-mvOU(anc.tree,PCA$scores[,1:2],model=\"OU1\")\nmulti.OU1\n# OU otimos multiplos\nmulti.OUM<-mvOU(anc.tree,PCA$scores[,1:2],model=\"OUM\")\nmulti.OUM\n# Comparando modelos\naic.scores<-\nsetNames(c(multi.BM1$AICc,multi.BMM$AICc,multi.EB$AICc,multi.OU1$AICc,multi.OUM$AICc),\nc(\"BM1\",\"BMM\",\"EB\",\"OU1\",\"OUM\"))\naic.scores\naicw(aic.scores) # Delta AICc e AICc weights\naic.w(aic.scores)"},{"path":"métodos-filogenéticos-multivariados.html","id":"exercício---modelos-multivariados","chapter":"Capítulo 26 Métodos filogenéticos multivariados","heading":"26.7 Exercício - Modelos multivariados","text":"Com os mesmos dados de forma e dieta para roedores sigmodontíneos:\nsigmodontinae-shape.txt\nsigmodontinae-tree.tre\nSimule 10 estimativas de estado ancestral para o caráter dieta. Usando 2 componentes principais da forma da mandíbula, ajuste modelos (com mvMORPH) brownianos com múltiplas taxas (BMM) e OU com múltiplos ótimos (OUM) usando os regimes reconstruídos em cada uma das 10 simulações. Calcule média de AICc para cada simulação e compare o ajuste entre todos os modelos (BM1,BMM,EB,OU1,OUM).\nVocê pode usar, por exemplo:list.AIC<-matrix(NA,length(trees),2)\n(1:length(trees)){\nfit.BMM<-mvBM(trees[[]],PCA\\(scores[,1:2],model=\"BMM\") fit.OUM<-mvOU(trees[[]],PCA\\)scores[,1:2],model=“OUM”)\nlist.AIC[,1]<-fit.BMM\\(AICc list.AIC[,2]<-fit.OUM\\)AICc\n}E função apply para calcular média AICc.","code":""},{"path":"disparidade-fenotípica-ao-longo-do-tempo.html","id":"disparidade-fenotípica-ao-longo-do-tempo","chapter":"Capítulo 27 Disparidade fenotípica ao longo do tempo","heading":"Capítulo 27 Disparidade fenotípica ao longo do tempo","text":"Esse exemplo implementa análise de disparidade morfológica ao longo tempo (Disparity time plots) de Harmon et al. (2003).Carregar dados.Disparity time plots.","code":"\nrequire(ape)\n#> Le chargement a nécessité le package : ape\nrequire(geiger)\n#> Le chargement a nécessité le package : geiger\n#> Le chargement a nécessité le package : phytools\n#> Le chargement a nécessité le package : maps\nrequire(phytools)\n# Filogenia\ntree<-read.nexus(\"dadospcm/sigmodontinae-tree.tre\")\nplotTree(tree,fsize=0.4,ftype=\"i\",type=\"fan\",lwd=1)\n# Dados morfológicos\ndados<-read.table(\"dadospcm/sigmodontinae-atributos.txt\",h=T,row.names=1)\nhead(dados)\nsize<-dados$Size\nnames(size)=rownames(dados)\nsize\n# Tamanho\ndtt.size<-dtt(tree,size,nsim=999,calculateMDIp = TRUE)\ndtt.size$MDI\ndtt.size$MDIpVal\n# DTT multivariado\ndados<-read.table(\"dadospcm/sigmodontinae-shape.txt\",h=T,row.names=1)\nhead(dados)\ndiet<-as.factor(dados$Diet) # A dieta é um código (Onivoro-1; Herbivoro-2; Insetivoro-3)\nnames(diet)=rownames(dados)\nforma<-dados[,3:28]\nforma\ndtt.shape<-dtt(tree,as.matrix(forma),nsim=999,calculateMDIp = TRUE)\ndtt.shape$MDI\ndtt.shape$MDIpVal"},{"path":"diversificação-de-linhagens.html","id":"diversificação-de-linhagens","chapter":"Capítulo 28 Diversificação de linhagens","heading":"Capítulo 28 Diversificação de linhagens","text":"Esse exemplo implementa os gráficos de acúmulo de linhagens ao longo tempo (lineage time plots) e estatística γ. Aqui, estamos assumindo especiação constante ao longo tempo e entre linhagens (pure-birth), e nenhuma extinção.Carregar hipótese filogenética.Lineage time plots.Sob pure-birth (só especiação) o número de linhagens deve crescer exponencialmente com o tempo. Isso se traduz em uma expectativa linear em escala semi-logarítmica: o eixo vertical em log e o horizontal em escala linear.É possível comparar o LTT observado com múltiplas simulações de LTT sob um modelo pure-birth assumindo o mesmo período de tempo e resultando mesmo número de espécies que nossa árvore de interesse.Estatística γ.Como exemplo, vamos simular uma árvore que retorne um gamma positivo.","code":"\nrequire(ape)\n#> Le chargement a nécessité le package : ape\nrequire(geiger)\n#> Le chargement a nécessité le package : geiger\n#> Le chargement a nécessité le package : phytools\n#> Le chargement a nécessité le package : maps\nrequire(phytools)\n# Filogenia\ntree<-read.nexus(\"dadospcm/sigmodontinae-tree.tre\")\nplotTree(tree,fsize=0.4,ftype=\"i\",type=\"fan\",lwd=1)\n# LTT plot\npar(mfrow=c(1,1),mar=c(5,4,2,2))\nobj.ltt<-ltt(tree,log.lineages=FALSE)\nobj.ltt\n# Tree background\nplot(obj.ltt,show.tree=TRUE,log.lineages=FALSE)\n{plot(obj.ltt,log.lineages=FALSE,log=\"y\",ylim=c(2,Ntip(tree)))\n# comparando com o que seria esperado sob pure-birth (linha reta)\nh<-max(nodeHeights(tree)) # idade máxima da arvore\nx<-seq(0,h,by=h/100)\nb<-(log(Ntip(tree))-log(2))/h # birth-rate\nlines(x,2*exp(b*x),col=\"red\",lty=\"dashed\",lwd=2)}\ntrees<-pbtree(n=Ntip(tree),scale=h,nsim=100,quiet=TRUE) # nsim=999\nobj.trees<-ltt(trees,plot=FALSE)\n{plot(obj.trees,col=\"grey\")\nlines(c(0,h),log(c(2,Ntip(tree))),col=\"blue\")\n# arvore original\nltt(tree,add=TRUE,col=\"red\",lty=\"dashed\",lwd=2)}\n# Intervalo de confiança 95%\n{ltt95(trees,log=TRUE)\nplot(obj.ltt,add=TRUE,col=\"red\",lty=\"dashed\",lwd=2,log.lineages=FALSE)}\nobj.ltt<-ltt(tree,log.lineages=FALSE,plot=FALSE)\nobj.ltt\ngammatest(obj.ltt)\n# Exemplo de gamma positivo\ncoal.tree<-rcoal(n=100)\nplotTree(coal.tree,ftype=\"off\")\npar(mfrow=c(1,1),mar=c(5,4,2,2))\nobj<-ltt(coal.tree,log.lineages=FALSE,log=\"y\",col=\"red\",lty=\"dashed\")\nobj\n# comparação com pure-birth\ntrees<-pbtree(n=100,nsim=200,scale=max(nodeHeights(coal.tree)))\n{ltt95(trees,log=TRUE)\nltt(coal.tree,add=TRUE,log.lineages=FALSE,col=\"red\",lwd=2,lty=\"dashed\")}"},{"path":"taxas-de-especiação-e-extinção-constantes-e-variáveis.html","id":"taxas-de-especiação-e-extinção-constantes-e-variáveis","chapter":"Capítulo 29 Taxas de especiação e extinção constantes e variáveis","heading":"Capítulo 29 Taxas de especiação e extinção constantes e variáveis","text":"","code":""},{"path":"taxas-de-especiação-e-extinção-constantes-e-variáveis.html","id":"diversificação-constante","chapter":"Capítulo 29 Taxas de especiação e extinção constantes e variáveis","heading":"29.1 Diversificação constante","text":"Primeiro, vamos carregar alguns dados e calcular uma diversificação\nlíquida simples, esperada sobr um modelo pure-birth (Magallon Sanderson 2001).Agora, vamos estimar extinção constante com um modelo birth-death. pacote ape, função birthdeath estima taxas de extinção e especiação em uma filogenia (método de Nee, May, Harvey (1994)). estimativas são confiáveis se premissas modelo forem reais (especiação e extinção constantes tempo). O método também assume uma filogenia completa. b é taxa de especiação e d é taxa de extinção.árvore contem algumas politomias. Vamos resolver politomias e\ntentar novamente.Por motivos computacionais, função birthdeath estima os parâmetros\nderivados b-d e d/b (diferença entre especiação e extinção (net\ndiversification) e razão entre extinção e especiação (relative\nextinction rate), respectivamente). Para encontrar b e d podemos usar função bd pacote phytools:unidades dos valores dependem da unidade comprimento dos ramos (ln para número de espécies).Só é possível comparar árvores diferentes quando o comprimento dos ramos está na mesma unidade.Pacote diversitree. O pacote diversitree possui múltiplas funções para realizar vários tipos de análises de diversificação com filogenias. Uma das vantagens diversitree é que ele permite levar em consideração incompletude número de espécies amostradas. Na nossa filogenia dos primatas, existem 226 espécies amostradas de um total de aprox. 300 (o número variava de 190 até 350 da última vez que conferi; vamos considerar 300 para exemplo). Isso é cerca de 75% de espécies presentes. O diversitree também permite ajustar modelos pure-birth (Yule) e birth-death (BD) e compará-los.lambda = taxa de especiação; mu = taxa de extinção.Comparar modelos.O modelo que incluí extinção (birth-death) aumentou significativamente o seu ajuste em comparação com o modelo pure-birth. Esse é essencialmente um sinal de que extinção é importante (o parâmetro adicional d se justifica).MCMC.O pacote diversitree também permite rodar analises bayesianas\npara estimar os parâmetros de diversificação usando distribuição\nposterior probabilidades.","code":"\nrequire(ape)\n#> Le chargement a nécessité le package : ape\nrequire(phytools)\n#> Le chargement a nécessité le package : phytools\n#> Le chargement a nécessité le package : maps\n# Filogenia\ntree<-read.tree(\"dadospcm/primate-tree.txt\")\nplotTree(tree,fsize=0.4,ftype=\"i\",type=\"fan\",lwd=1)\n# Número de espécies\nn_sp<-length(tree$tip.label)\n# Stem age\nstem_age<-max(nodeHeights(tree))\n# Diversificação (Magallon & Sanderson 2001)\nr1<-log(n_sp)/stem_age\n# Com essa diversificação obtemos o número de espécies visto na árvore\nr1*stem_age\nlog(n_sp)\n#nee<-birthdeath(tree)\ntree<-multi2di(tree)\nis.binary(tree)\nnee<-birthdeath(tree)\nnee\nbd(nee)\nrequire(diversitree)\n#> Le chargement a nécessité le package : diversitree\n# Yule (pure-birth -- somente especiação)\nmodelo.pb<-make.yule(tree,sampling.f = 226/300)\nparam.pb<-find.mle(modelo.pb,x.init=0.1) # Estimar os valores dos parâmetros por ML # x.init é um valor arbitrário para iniciar o otimização\nparam.pb\n# Modelo birth-death (especiação + extinção)\nmodelo.bd<-make.bd(tree,sampling.f = 226/300)\nparam.bd<-find.mle(modelo.bd,x.init=c(0.1,0.05))\nparam.bd\nanova(param.bd,pure.birth=param.pb)\nbd.amostras <- mcmc(modelo.bd, param.bd$par, nsteps = 1e+05, lower = c(0, 0),\n upper = c(Inf,Inf), w = c(0.1, 0.1), fail.value = -Inf,\n print.every = 10000)\n# visualizar distribuição\npostSamples<-bd.amostras[c(\"lambda\", \"mu\")]\npar(mfrow=c(1,1),mar=c(5,4,2,2))\nprofiles.plot(postSamples,col.line=c(\"red\", \"blue\"),las=1,legend =\"topright\")"},{"path":"taxas-de-especiação-e-extinção-constantes-e-variáveis.html","id":"diversificação-variando-no-tempo-time-dependent","chapter":"Capítulo 29 Taxas de especiação e extinção constantes e variáveis","heading":"29.2 Diversificação variando no tempo (time-dependent)","text":"Carregar dados.O RPANDA (Morlon et al. 2016) é um pacote que permite ajustar modelos com\ntaxas de especiação e/ou extinção variáveis, e comparar os modelos\nusando verossimilhança.Nós vamos ajustar modelos com combinações de lambda e mu constantes e variáveis. Os modelos podem ser consultados help RPANDA.Ajustando os modelos para árvore completa.Comparando os modelos.Resultados um pouco ambíguos, mas sugerem que taxas constantes são\nimprováveis.É possível ajustar os modelos para toda árvore, como acima, ou definir\npartes da árvore priori (clados) e testar diferenças nas taxas entre\nclados. Se não temos uma hipótese priori de quais clados tem\ndiversificação mais rápida, podemos identificar mudanças rápidas olhando\npra árvore, ou usando métodos como o MEDUSA ou o BAMM para detectar\nmudanças na diversificação em hipóteses priori.","code":"\nrequire(ape)\nrequire(phytools)\nrequire(geiger)\n#> Le chargement a nécessité le package : geiger\n# Arvore marsupiais\ntree<-read.tree(\"dadospcm/marsupial-tree.tre\")\n{plot(tree,cex=0.4)\naxisPhylo()}\nrequire(RPANDA)\n#> Le chargement a nécessité le package : RPANDA\n#> Le chargement a nécessité le package : picante\n#> Le chargement a nécessité le package : vegan\n#> Le chargement a nécessité le package : permute\n#> Le chargement a nécessité le package : lattice\n#> This is vegan 2.6-4\n#> \n#> Attachement du package : 'vegan'\n#> L'objet suivant est masqué depuis 'package:phytools':\n#> \n#>     scores\n#> Le chargement a nécessité le package : nlme\nlambda.cst <- function(t,y){y[1]} # lambda constante\nlambda.var <- function(t,y){y[1]*exp(y[2]*t)} # lambda com variação exponencial (em função do tempo t)\nmu.cst <- function(t,y){y[1]}\nmu.var <- function(t,y){y[1]*exp(y[2]*t)}\n# birth-death especiação e extinção constante\nbcdc<-fit_bd(tree,tot_time=max(branching.times(tree)),f.lamb=lambda.cst,f.mu=mu.cst,lamb_par=0.01,mu_par=0.001,cst.lamb=TRUE,cst.mu=TRUE)\nbcdc$model<-\"birth-death taxa de especiação e extinção constantes\"\nbcdc\n# birth-death especiação exponencial e extinção constante\nbvdc<-fit_bd(tree,tot_time=max(branching.times(tree)),f.lamb=lambda.var,f.mu=mu.cst,lamb_par=c(0.05,0.01),mu_par=0.001,expo.lamb=TRUE,cst.mu=TRUE)\nbvdc$model<-\"birth-death taxa de especiação exponencial e extinção constante\"\n# birth-death especiação constante e extinção exponencial\nbcdv<-fit_bd(tree,tot_time=max(branching.times(tree)),f.lamb=lambda.cst,f.mu=mu.var,lamb_par=0.01,mu_par=c(0.005,0.001),cst.lamb=TRUE,expo.mu=TRUE)\nbcdv$model<-\"birth-death taxa de especiação constante e extinção exponencial\"\n# birth-death especiação e extinção exponencial\nbvdv<-fit_bd(tree,tot_time=max(branching.times(tree)),f.lamb=lambda.var,f.mu=mu.var,lamb_par=c(0.05,0.01),mu_par=c(0.005,0.001),expo.lamb=TRUE,expo.mu=TRUE)\nbvdv$model<-\"birth-death taxa de especiação e extinção exponencial\"\naic.scores<-setNames(c(bcdc$aicc,bvdc$aicc,bcdv$aicc,bvdv$aicc),\n c(\"bcdc\",\"bvdc\",\"bcdv\",\"bvdv\"))\naic.scores\naic.w(aic.scores)"},{"path":"taxas-de-especiação-e-extinção-constantes-e-variáveis.html","id":"diversificação-variando-entre-clados-clade-dependent","chapter":"Capítulo 29 Taxas de especiação e extinção constantes e variáveis","heading":"29.3 Diversificação variando entre clados (clade-dependent)","text":"O exemplo implementa o MEDUSA (Alfaro et al. 2009).Pelo menos dois grandes ‘shifts’ de diversificação podem ser percebidos.\nUm clado dos Macropodidae (cangurus e afins - nó 301) e outro \nclado dos Dasyuromorpha (marsupiais carnívoros - nó 355). r= net\ndiversification rate. Agora podemos hipotetizar, como exemplo, que o\nclado dos cangurus e aliados (Macropodidae) parece ter se diversificado\nmais rapidamente.","code":"\nmar<-medusa(tree)\nmar\nplot(mar)\npar(mfrow=c(1,1),mar=c(5,4,2,2))\n{plot(mar)\nnodelabels()}\nmacropodidae.tree <- extract.clade(tree, 301)\nplot(macropodidae.tree)\nresto.tree<-drop.tip(tree,macropodidae.tree$tip.label)\nplot(resto.tree)"},{"path":"taxas-de-especiação-e-extinção-constantes-e-variáveis.html","id":"diversificação-variando-no-tempo-e-entre-clados","chapter":"Capítulo 29 Taxas de especiação e extinção constantes e variáveis","heading":"29.4 Diversificação variando no tempo e entre clados","text":"Vamos usar RPANDA para ajustar modelos com taxas variáveis entre clados.\nPara facilitar, vamos unir os modelos em uma função.Comparando modelos.Novamente os resultados são um pouco inconclusivos. Parece haver maior suporte para modelos com taxas variáveis que constantes. Para o clado Macropodidae uma variação exponencial nas taxas de especiação parece bem provável, enquanto que para o resto da árvore, uma variação em ambas taxas (especiação e extinção) é mais provável.Podemos plotar taxas de especiação, extinção, e diversificação (b-d) ao longo tempo para os modelos mais prováveis de cada clado.","code":"\nfit.multi.rpanda <- function(tree){\n bcdc<-fit_bd(tree,tot_time=max(branching.times(tree)),f.lamb=lambda.cst,f.mu=mu.cst,lamb_par=0.01,mu_par=0.001,cst.lamb=TRUE,cst.mu=TRUE)\n bvdc<-fit_bd(tree,tot_time=max(branching.times(tree)),f.lamb=lambda.var,f.mu=mu.cst,lamb_par=c(0.05,0.01),mu_par=0.001,expo.lamb=TRUE,cst.mu=TRUE)\n bcdv<-fit_bd(tree,tot_time=max(branching.times(tree)),f.lamb=lambda.cst,f.mu=mu.var,lamb_par=0.01,mu_par=c(0.005,0.001),cst.lamb=TRUE,expo.mu=TRUE)\n bvdv<-fit_bd(tree,tot_time=max(branching.times(tree)),f.lamb=lambda.var,f.mu=mu.var,lamb_par=c(0.05,0.01),mu_par=c(0.005,0.001),expo.lamb=TRUE,expo.mu=TRUE)\n return(list(\"bcdc\"=bcdc,\"bvdc\"=bvdc,\"bcdv\"=bcdv,\"bvdv\"=bvdv))\n }\nmacropodidae_panda<-fit.multi.rpanda(macropodidae.tree)\nresto_panda<-fit.multi.rpanda(resto.tree)\n# Extraindo aicc\nmacro_aic<-numeric(4) #vetor vazio\nresto_aic<-numeric(4)\nnames(macro_aic)<-c(\"bcdc\", \"bvdc\", \"bcdv\", \"bvdv\")\nnames(resto_aic)<-names(macro_aic)\nfor(i in 1:4) {\n macro_aic[i]<-macropodidae_panda[[i]]$aicc\n resto_aic[i]<-resto_panda[[i]]$aicc\n}\naic.w(macro_aic)\naic.w(resto_aic)\nplot_fit_bd(macropodidae_panda$bvdc,max(branching.times(macropodidae.tree)))\nplot_fit_bd(resto_panda$bvdv,max(branching.times(resto.tree)))\nplot(macropodidae.tree)\nplot(resto.tree)"},{"path":"taxas-de-especiação-e-extinção-constantes-e-variáveis.html","id":"exercício---diversificação-dependente-de-variável-ambiental","chapter":"Capítulo 29 Taxas de especiação e extinção constantes e variáveis","heading":"29.5 Exercício - Diversificação dependente de variável ambiental","text":"RPANDA pode ser usado para ajustar modelos de diversificação dependente de variável ambiental (fit_env). Como variável adicional, esse modelo requer uma estimativa da variação em uma variável ambiental de interesse ao longo tempo. Zachos et al (2008) fornecem uma estimativa de variação de temperatura ao longo Cenozóico baseada em isótopos de oxigênio.Baseado nos dados:\nÁrvore para roedores sigmodontíneos:\nsigmodontinae-tree.tre\nDados de temperatura, duas colunas com tempo e\ntemperatura:\nCenozoic_Temp.txtAjuste um modelo com variação nas taxas de especiação dependentes da\ntemperatura, sem dependência temporal e sem extinção:lambda.env<-function(t,x,y){y[1]exp(y[2]x)}\ne\nmu.zero<-function(t,x,y){0}Com os parâmetros iniciais:lamb_par_init<-c(0.10,0.01)mu_par_init<-c()O modelo deve ser ajustado com função fit_env pacote RPANDA. Faça um gráfico dos resultados com plot_fit_env e interprete os resultados.","code":""},{"path":"diversificação-dependente-de-estado.html","id":"diversificação-dependente-de-estado","chapter":"Capítulo 30 Diversificação dependente de estado","heading":"Capítulo 30 Diversificação dependente de estado","text":"Esse capítulo exemplifica lógica dos modelos de diversificação dependentes de estado (SSE) usando o modelo mais simples e primeiro ser desenvolvido, o BiSSE. Há uma grande literatura sobre modelos dependentes de estado, em constante atualização, que precisa ser consultada antes de utilizar um modelo SSE. Veja os artigos nas referências recomendadas na disciplina.Carregar dados.Vamos utilizar o BiSSE (binary-state speciation extinction) para testar hipóteses sobre diversificação de primatas e o tamanho grupo social.\nConsidere variável binária, que possui dois estados: Solitary vs. Social.\nMenos de 4 ind = solitary\nMais de 4 ind = socialUma dessas categorias promove maior diversificação em primatas?O BiSSE tem uma função para estimar valores iniciais ‘razoáveis’ dos parâmetros de interesse.Para rodar o BiSSE temos que criar função de verossimilhança (likelihood) para posteriormente otimizar os parâmetros.Agora podemos restringir função geral para criar diferentes modelos.\nPor exemplo, podemos criar um modelo “nulo” onde taxas de especiação e extinção sejam iguais entre estados (b0b1;d0d1) e que existe uma única taxa de transição (q01=q10).Ajustar os modelos.Outros modelos podem ser ajustados entre o mais simples e o mais complexo, dependendo das hipóteses biológicas priori. Em um estudo empírico, especialmente com múltiplos estados (MuSSE e similares), os modelos devem ser identificados priori ao invés de ajustar todos os modelos possíveis para identificar aqueles com melhor ajuste.\nComo exemplo, vamos ajustar um modelo onde somente taxa de especiação varie ente estados, um modelo onde somente taxa de extinção varie, e um modelo com b e d constantes, mas com taxas de transição diferentes entre estados.Agora podemos comparar os modelos ajustados. função genérica anova permite\nobter os valores de AIC para uma lista.Os modelos com especiação variável e com especiação e extinção variável (e taxa de transição única) receberam maior suporte.Parece que tanto taxas de especiação como de extinção são maiores para o estado 0 (social) que para o estado 1 (solitário).\nE taxa de diversificação?Como taxas de extinção estimadas são muito baixas, taxas de diversificação\nsão próximas das de especiação.Assim como vimos modelo bd simples, com o pacote diversitree podemos rodar análises bayesianas com os nossos modelos. Vamos fazer isso para o nosso melhor modelo para estimar os valores dos parâmetros.","code":"\nrequire(ape)\n#> Le chargement a nécessité le package : ape\nrequire(phytools)\n#> Le chargement a nécessité le package : phytools\n#> Le chargement a nécessité le package : maps\nrequire(geiger)\n#> Le chargement a nécessité le package : geiger\nrequire(diversitree)\n#> Le chargement a nécessité le package : diversitree\n# Filogenia\ntree<-read.tree(\"dadospcm/primate-tree.txt\")\nplotTree(tree,fsize=0.4,ftype=\"i\",type=\"fan\",lwd=1)\n# Atributos\ndados<-read.table(\"dadospcm/primate-data.txt\",h=T,row.names=1)\nhead(dados)\n# Recortar filogenia\nmatch.species<-treedata(tree,dados)\ntree<-match.species$phy\nplotTree(tree,fsize=0.5,ftype=\"i\",type=\"fan\",lwd=1)\nbinsocial<-dados$BinSocial\nnames(binsocial)=rownames(dados)\nbinsocial<-as.factor(binsocial)\nbinsocial\n# O diversitree requer que os códigos sejam numéricos.\nlevels(binsocial) # 1-Social, 2-Solitário\nbinsocial<-as.numeric(binsocial)-1 # valores tem que ser 0 e 1\nbinsocial \nnames(binsocial)=rownames(dados)\nbinsocial # 0-Social, 1-Solitário\np<-starting.point.bisse(tree)\np\nlik.bisse<-make.bisse(tree,binsocial)\nlik.bisse\nlik.null<-constrain(lik.bisse,lambda0~lambda1,mu0~mu1,q10~q01)\nlik.null\n# Ajustar modelo nulo\np[argnames(lik.null)] # ajustar número de parâmetros inicial\nfit.null<-find.mle(lik.null,x.init=p[argnames(lik.null)])\nfit.null\n# Ajustar o modelo mais complexo, onde as taxas de especiação e extinção dependem do estado do fenótipo\nfit.full<-find.mle(lik.bisse,x.init=p)\nfit.full\n# especiação variável\nlik.lambda<-constrain(lik.bisse,mu0~mu1,q10~q01)\nlik.lambda\n# ajuste\nfit.lambda<-find.mle(lik.lambda,x.init=p[argnames(lik.lambda)])\nfit.lambda\n# extinção variável\nlik.mu<-constrain(lik.bisse,lambda0~lambda1,q10~q01)\nlik.mu\n# ajuste\nfit.mu<-find.mle(lik.mu,x.init=p[argnames(lik.mu)])\nfit.mu\n# especiação e extinção variável, única taxa de transição entre estados\nlik.lambda.mu<-constrain(lik.bisse,q10~q01)\nlik.lambda.mu\n# ajuste\nfit.lambda.mu<-find.mle(lik.lambda.mu,x.init=p[argnames(lik.lambda.mu)])\nfit.lambda.mu\n# b e d constantes, taxas de transição flexíveis\nlik.q<-constrain(lik.bisse,lambda0~lambda1,mu0~mu1)\nlik.q\n# ajuste\nfit.q<-find.mle(lik.q,x.init=p[argnames(lik.q)])\nfit.q\n# Comparando os modelos\nresultados<-anova(fit.null,\n completo=fit.full,\n lambda.variavel=fit.lambda,\n mu.variavel=fit.mu,\n lambda.mu.variavel=fit.lambda.mu,\n q.variavel=fit.q)\nresultados\naicw(setNames(resultados$AIC,rownames(resultados)))\naic.w(setNames(resultados$AIC,rownames(resultados)))\ncoef(fit.lambda.mu)\nlambda0<-coef(fit.lambda.mu)[[1]]\nmu0<-coef(fit.lambda.mu)[[3]]\nr.0<-lambda0-mu0\nr.0\nlambda1<-coef(fit.lambda.mu)[[2]]\nmu1<-coef(fit.lambda.mu)[[4]]\nr.1<-lambda1-mu1\nr.1\n# MCMC\nmcmc.lambda.mu<-mcmc(lik.lambda.mu,fit.lambda.mu$par, nsteps = 1000, w = 1,print.every=100)\n# visualizar probabilidades\ncolors<-setNames(c(\"red\",\"blue\"),1:2)\npar(mfrow=c(1,1),mar=c(5,4,2,2))\n# especiação\nprofiles.plot(mcmc.lambda.mu[,grep(\"lambda\",colnames(mcmc.lambda.mu))], \n col.line=colors, las=1, legend.pos=\"topright\")\n# extinção\nprofiles.plot(mcmc.lambda.mu[,grep(\"mu\",colnames(mcmc.lambda.mu))],\n col.line=colors, las=1, legend.pos=\"topright\")\n# diversificação líquida\ndiv<-mcmc.lambda.mu[,grep(\"lambda\",colnames(mcmc.lambda.mu))]-\n mcmc.lambda.mu[,grep(\"mu\",colnames(mcmc.lambda.mu))]\ncolnames(div)<-paste(\"lambda-mu(\",0:1,\")\",sep=\"\")\nprofiles.plot(div,\n xlab=\"Net diversification rate\", ylab=\"Probability density\",\n legend.pos=\"topleft\",col.line=setNames(colors,colnames(div)),\n lty=1)"},{"path":"diversificação-baseada-em-terminais-tip-speciation.html","id":"diversificação-baseada-em-terminais-tip-speciation","chapter":"Capítulo 31 Diversificação baseada em terminais (tip-speciation)","heading":"Capítulo 31 Diversificação baseada em terminais (tip-speciation)","text":"Uma das medidas mais comuns de taxa de especiação/diversificação nos terminais (tipDR) é de Jetz et al. (2012), que é o inverso da medida equal splits de Redding Mooers (2006). Veja também uma outra medida de diversificação em terminais ClaDS Maliet, Hartig, Morlon (2019).Carregar dados.DR.O tamanho corporal influencia diversificação?","code":"\nrequire(ape)\n#> Le chargement a nécessité le package : ape\nrequire(phytools)\n#> Le chargement a nécessité le package : phytools\n#> Le chargement a nécessité le package : maps\nrequire(picante)\n#> Le chargement a nécessité le package : picante\n#> Le chargement a nécessité le package : vegan\n#> Le chargement a nécessité le package : permute\n#> Le chargement a nécessité le package : lattice\n#> This is vegan 2.6-4\n#> \n#> Attachement du package : 'vegan'\n#> L'objet suivant est masqué depuis 'package:phytools':\n#> \n#>     scores\n#> Le chargement a nécessité le package : nlme\nrequire(geiger)\n#> Le chargement a nécessité le package : geiger\n# Filogenia\ntree<-read.tree(\"dadospcm/primate-tree.txt\")\nplotTree(tree,fsize=0.4,ftype=\"i\",type=\"fan\",lwd=1)\n# Atributos\ndados<-read.table(\"dadospcm/primate-data.txt\",h=T,row.names=1)\n# Recortar filogenia\nmatch.species<-treedata(tree,dados)\ntree<-match.species$phy\nplotTree(tree,fsize=0.5,ftype=\"i\",type=\"fan\",lwd=1)\nES = evol.distinct(tree, type = \"equal.splits\")$w\nDR = 1/ES\n# Plot\nnames(DR)=tree$tip.label\ncontMap(tree,DR)\n# Massa corporal\nmassa<-dados$AdultBodyMass_g\nnames(massa)=rownames(dados)\ncontMap(tree,log(massa))\n# Correlação\ncor(DR,log(massa))\nplot(log(massa),DR)"},{"path":"co-diversificação.html","id":"co-diversificação","chapter":"Capítulo 32 Co-diversificação","heading":"Capítulo 32 Co-diversificação","text":"Análises cofilogenéticas investigam associação/dependência entre diversificação de dois clados, normalmente um clado de parasitas e um clado de hospedeiros; para uma revisão veja Perez-Lamarque Morlon (2022). Aqui, usaremos um teste baseado em Mantel para testar o sinal filogenético na associação entre dois clados (Perez-Lamarque Morlon 2022). Vamos carregar dados de associação entre coronavirus (parasitas) e mamíferos (hospedeiros) de Maestri et al. (n.d.).Carregar dados.Sinal filogenético na associação, com permutações mantendo constante o número de parceiros.Coronavirus próximos filogenéticamente tendem se associar (infectar) mamíferos proximos filogenéticamente (r=0.377) e vice-versa (r=0.295).Também podemos testar se parasitas proximamente relacionados tendem infectar um número de hospeiros similar.Coronavirus próximos filogenéticamente tendem infectar um número de hospeiros similar, porém, mamíferos proximos filogenéticamente não tendem hospedar um número similar de coronavirus. Isso sugere que especificidade de coronavírus em relação aos seus hospedeiros é conservada evolutivamente, enquanto que suscetibilidade dos hospedeiros aos coronavírus não é.Por fim, podemos testar em que escala filogenética o sinal é mais forte.Em geral, o sinal filogenético é mais forte nos nós mais antigos das duas filogenias.","code":"\n# Carregar árvore de Coronaviridae\nrequire(ape)\n#> Le chargement a nécessité le package : ape\ncov_tree<-read.nexus(\"dadospcm/combined_alignment_cov_trimal_tree_35.tre\")\n# Carregar matriz de associação\nhosts_matrix<-read.table(\"dadospcm/association_matrix.txt\")\n# Carregar árvore de mamíferos hospedeiros\nhostmammaltree<-read.tree(\"dadospcm/hostsMammalTree.tre\")\nrequire(RPANDA)\n#> Le chargement a nécessité le package : RPANDA\n#> Le chargement a nécessité le package : picante\n#> Le chargement a nécessité le package : vegan\n#> Le chargement a nécessité le package : permute\n#> Le chargement a nécessité le package : lattice\n#> This is vegan 2.6-4\n#> Le chargement a nécessité le package : nlme\npsuni_n<-phylosignal_network(hosts_matrix, tree_A = cov_tree, \n tree_B = hostmammaltree, \n method = \"GUniFrac\", \n correlation = \"Pearson\", \n nperm=1000, permutation = \"nbpartners\")\npsuni_n\n# Sinal filogenético no número de parceiros\nnpart_cov<-phylosignal_network(hosts_matrix, \n tree_A = cov_tree, \n method = \"degree\", \n correlation = \"Pearson\", nperm = 1000)\nnpart_mammals<-phylosignal_network(t(hosts_matrix), \n tree_A = hostmammaltree, \n method = \"degree\", \n correlation = \"Pearson\", nperm = 1000)\nnpart_cov\nnpart_mammals\n# Calcular sinal filogenético por subclados\n# Para parasitas\nresults_clade_A <- phylosignal_sub_network(hosts_matrix, \n tree_A = cov_tree, \n tree_B = hostmammaltree, \n method = \"GUniFrac\", \n correlation = \"Pearson\", \n nperm=1000,minimum=10, degree=F,\n permutation = \"shuffle\")\nplot_phylosignal_sub_network(tree_A = cov_tree, results_clade_A,\n network = hosts_matrix)\n# Para hospedeiros\nresults_clade_B <- phylosignal_sub_network(t(hosts_matrix), \n tree_A = hostmammaltree, \n tree_B = cov_tree, \n method = \"GUniFrac\", \n correlation = \"Pearson\", \n nperm=1000, \n minimum=10, degree=F,\n permutation = \"shuffle\")\nplot_phylosignal_sub_network(tree_A = hostmammaltree, results_clade_B,\n network = t(hosts_matrix),\n legend=FALSE,where = \"topleft\")\n# Plot conjunto \nlayout(matrix(c(1,2),1,2),widths=c(0.5,0.5),heights=c(0.1,0.1))\nplot_phylosignal_sub_network(tree_A = cov_tree, results_clade_A,\n network = hosts_matrix)\nplot_phylosignal_sub_network(tree_A = hostmammaltree, results_clade_B,\n network = t(hosts_matrix),\n legend=FALSE,where = \"topleft\")"},{"path":"biogeografia-e-macroecologia.html","id":"biogeografia-e-macroecologia","chapter":"Capítulo 33 Biogeografia e Macroecologia","heading":"Capítulo 33 Biogeografia e Macroecologia","text":"Em construção.","code":""},{"path":"considerações-finais.html","id":"considerações-finais","chapter":"Capítulo 34 Considerações finais","heading":"Capítulo 34 Considerações finais","text":"Em construção.","code":""},{"path":"referências.html","id":"referências","chapter":"Referências","heading":"Referências","text":"","code":""}]
